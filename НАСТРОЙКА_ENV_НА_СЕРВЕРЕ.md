# ðŸ” ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ° .env Ñ„Ð°Ð¹Ð»Ð° Ð½Ð° production ÑÐµÑ€Ð²ÐµÑ€Ðµ

## âš ï¸ Ð’ÐÐ–ÐÐž!

Ð¤Ð°Ð¹Ð» `.env` ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ **ÑÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ** (BOT_TOKEN) Ð¸ **ÐÐ• Ð´Ð¾Ð»Ð¶ÐµÐ½** Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒÑÑ Ð² Git!

---

## ðŸ“ ÐšÐ°Ðº Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¸Ñ‚ÑŒ

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 1: Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ .env Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ (Ñ€ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ)

```bash
# 1. ÐŸÐ¾Ð´ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÐµÑÑŒ Ðº ÑÐµÑ€Ð²ÐµÑ€Ñƒ
ssh Ð²Ð°Ñˆ_Ð¿Ð¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ@Ð²Ð°Ñˆ_ÑÐµÑ€Ð²ÐµÑ€

# 2. ÐŸÐµÑ€ÐµÐ¹Ð´Ð¸Ñ‚Ðµ Ð² Ð´Ð¸Ñ€ÐµÐºÑ‚Ð¾Ñ€Ð¸ÑŽ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°
cd ~/telegram_repair_bot

# 3. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ .env Ñ„Ð°Ð¹Ð» Ñ BOT_TOKEN
cat > .env << 'EOF'
# Ð¡ÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ production
BOT_TOKEN=Ð²Ð°Ñˆ_Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹_Ñ‚Ð¾ÐºÐµÐ½_Ð±Ð¾Ñ‚Ð°_Ð·Ð´ÐµÑÑŒ
EOF

# 4. ÐŸÑ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ Ñ‚Ð¾ÐºÐµÐ½ Ð·Ð°Ð¿Ð¸ÑÐ°Ð»ÑÑ
cat .env

# 5. Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° (Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð²Ð»Ð°Ð´ÐµÐ»ÐµÑ† Ð¼Ð¾Ð¶ÐµÑ‚ Ñ‡Ð¸Ñ‚Ð°Ñ‚ÑŒ)
chmod 600 .env

# 6. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð±Ð¾Ñ‚Ð°
make prod-restart
```

---

### Ð’Ð°Ñ€Ð¸Ð°Ð½Ñ‚ 2: Ð¡ÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð¸ Ð¾Ñ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ

```bash
# ÐÐ° ÑÐµÑ€Ð²ÐµÑ€Ðµ
cd ~/telegram_repair_bot

# Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ .env Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ env.example
cp env.example .env

# ÐžÑ‚Ñ€ÐµÐ´Ð°ÐºÑ‚Ð¸Ñ€ÑƒÐ¹Ñ‚Ðµ .env Ð¸ Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ BOT_TOKEN
nano .env
# Ð¸Ð»Ð¸
vim .env

# Ð£ÑÑ‚Ð°Ð½Ð¾Ð²Ð¸Ñ‚Ðµ Ð¿Ñ€Ð°Ð²Ð° Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð°
chmod 600 .env

# ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð±Ð¾Ñ‚Ð°
make prod-restart
```

---

## ðŸ” ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ°

ÐŸÐ¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ `.env` Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ, Ñ‡Ñ‚Ð¾ Ð±Ð¾Ñ‚ Ð²Ð¸Ð´Ð¸Ñ‚ Ñ‚Ð¾ÐºÐµÐ½:

```bash
# 1. Ð—Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÑƒ
bash scripts/diagnose_server.sh

# 2. Ð˜Ð»Ð¸ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÑŒÑ‚Ðµ Ð½Ð°Ð¿Ñ€ÑÐ¼ÑƒÑŽ (Ñ‚Ð¾ÐºÐµÐ½ Ð±ÑƒÐ´ÐµÑ‚ Ð·Ð°Ð¼Ð°ÑÐºÐ¸Ñ€Ð¾Ð²Ð°Ð½ Ð² Ð²Ñ‹Ð²Ð¾Ð´Ðµ)
docker exec telegram_repair_bot_prod env | grep BOT_TOKEN

# 3. ÐŸÐ¾ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ Ð»Ð¾Ð³Ð¸ Ð±Ð¾Ñ‚Ð°
make prod-logs
```

---

## ðŸ“‚ Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ„Ð°Ð¹Ð»Ð¾Ð²

```
telegram_repair_bot/
â”œâ”€â”€ .env                    # âŒ ÐÐ• Ð² Git (ÑÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ)
â”œâ”€â”€ env.production          # âœ… Ð’ Git (Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ)
â”œâ”€â”€ env.example             # âœ… Ð’ Git (ÑˆÐ°Ð±Ð»Ð¾Ð½)
â””â”€â”€ docker/
    â””â”€â”€ docker-compose.prod.yml  # Ð§Ð¸Ñ‚Ð°ÐµÑ‚ env.production + .env
```

---

## ðŸ” ÐŸÑ€Ð¸Ð¾Ñ€Ð¸Ñ‚ÐµÑ‚ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ñ…

Docker Compose Ñ‡Ð¸Ñ‚Ð°ÐµÑ‚ Ñ„Ð°Ð¹Ð»Ñ‹ Ð² Ñ‚Ð°ÐºÐ¾Ð¼ Ð¿Ð¾Ñ€ÑÐ´ÐºÐµ:

1. `env.production` - Ð±Ð°Ð·Ð¾Ð²Ð°Ñ ÐºÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ
2. `.env` - **Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚** Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ñ Ð¸Ð· env.production
3. `environment:` Ð² docker-compose.yml - **Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿Ð¸ÑÑ‹Ð²Ð°ÐµÑ‚** Ð²ÑÑ‘

**ÐŸÑ€Ð¸Ð¼ÐµÑ€:**

```
env.production:  BOT_TOKEN=       (Ð¿ÑƒÑÑ‚Ð¾)
.env:            BOT_TOKEN=123    (Ñ€ÐµÐ°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ð¾ÐºÐµÐ½)
Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚:       BOT_TOKEN=123    âœ…
```

---

## âš ï¸ Ð‘ÐµÐ·Ð¾Ð¿Ð°ÑÐ½Ð¾ÑÑ‚ÑŒ

### âœ… ÐŸÑ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾:
- Ð¥Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ `BOT_TOKEN` Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð² `.env` Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
- Ð£ÑÑ‚Ð°Ð½Ð°Ð²Ð»Ð¸Ð²Ð°Ñ‚ÑŒ Ð¿Ñ€Ð°Ð²Ð° `chmod 600 .env`
- ÐÐµ ÐºÐ¾Ð¼Ð¼Ð¸Ñ‚Ð¸Ñ‚ÑŒ `.env` Ð² Git

### âŒ ÐÐµÐ¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾:
- Ð¥Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½ Ð² `env.production` Ð² Git
- Ð”ÐµÐ»Ð°Ñ‚ÑŒ `git add .env`
- Ð’Ñ‹ÐºÐ»Ð°Ð´Ñ‹Ð²Ð°Ñ‚ÑŒ Ñ‚Ð¾ÐºÐµÐ½ Ð¿ÑƒÐ±Ð»Ð¸Ñ‡Ð½Ð¾

---

## ðŸš¨ Ð•ÑÐ»Ð¸ Ñ‚Ð¾ÐºÐµÐ½ ÑƒÑ‚Ñ‘Ðº

1. **ÐÐµÐ¼ÐµÐ´Ð»ÐµÐ½Ð½Ð¾ Ð¾Ñ‚Ð·Ð¾Ð²Ð¸Ñ‚Ðµ Ñ‚Ð¾ÐºÐµÐ½** Ñ‡ÐµÑ€ÐµÐ· @BotFather
2. Ð¡Ð¾Ð·Ð´Ð°Ð¹Ñ‚Ðµ Ð½Ð¾Ð²Ñ‹Ð¹ Ñ‚Ð¾ÐºÐµÐ½
3. ÐžÐ±Ð½Ð¾Ð²Ð¸Ñ‚Ðµ `.env` Ð½Ð° ÑÐµÑ€Ð²ÐµÑ€Ðµ
4. ÐŸÐµÑ€ÐµÐ·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ: `make prod-restart`

---

## ðŸ“‹ ÐŸÑ€Ð¸Ð¼ÐµÑ€ .env Ñ„Ð°Ð¹Ð»Ð°

```bash
# Ð¡ÐµÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ð´Ð°Ð½Ð½Ñ‹Ðµ Ð´Ð»Ñ production
BOT_TOKEN=1234567890:ABCdefGHIjklMNOpqrsTUVwxyz

# ÐžÐ¿Ñ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾: Ð¼Ð¾Ð¶Ð½Ð¾ Ð¿ÐµÑ€ÐµÐ·Ð°Ð¿Ð¸ÑÐ°Ñ‚ÑŒ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ
# LOG_LEVEL=DEBUG
# ADMIN_IDS=123456789
```

---

## âœ… ÐŸÑ€Ð¾Ð²ÐµÑ€ÐºÐ° ÐºÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð½Ð¾ÑÑ‚Ð¸

```bash
# Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ .env ÐÐ• Ð² Git
git status | grep .env
# Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð±Ñ‹Ñ‚ÑŒ Ð¿ÑƒÑÑ‚Ð¾ Ð¸Ð»Ð¸ "Untracked files"

# Ð£Ð±ÐµÐ´Ð¸Ñ‚ÐµÑÑŒ, Ñ‡Ñ‚Ð¾ .env Ð² .gitignore
grep "^\.env$" .gitignore
# Ð”Ð¾Ð»Ð¶Ð½Ð¾ Ð²Ñ‹Ð²ÐµÑÑ‚Ð¸: .env
```

---

**ÐŸÐ¾ÑÐ»Ðµ Ð½Ð°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ `.env` Ð±Ð¾Ñ‚ Ð´Ð¾Ð»Ð¶ÐµÐ½ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚ÑŒÑÑ Ð±ÐµÐ· Ð¾ÑˆÐ¸Ð±Ð¾Ðº!** ðŸŽ‰
