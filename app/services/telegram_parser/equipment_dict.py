"""
Словарь сокращений типов оборудования

Маппинг сокращений, которые используют диспетчеры, на полные названия типов техники.
"""

# Словарь сокращений -> полное название
EQUIPMENT_ABBREVIATIONS: dict[str, str] = {
    # Стиральные машины
    "с/м": "Стиральная машина",
    "см": "Стиральная машина",
    "стиралка": "Стиральная машина",
    "стир": "Стиральная машина",
    "стир.маш": "Стиральная машина",
    "стир машина": "Стиральная машина",

    # Посудомоечные машины
    "п/м": "Посудомоечная машина",
    "пм": "Посудомоечная машина",
    "посудомойка": "Посудомоечная машина",
    "посуд": "Посудомоечная машина",
    "посуд.маш": "Посудомоечная машина",

    # Телевизоры
    "тв": "Телевизор",
    "телек": "Телевизор",
    "телик": "Телевизор",
    "телевизор": "Телевизор",

    # Холодильники
    "холод": "Холодильник",
    "холодильник": "Холодильник",
    "холод.": "Холодильник",
    "хол": "Холодильник",

    # Микроволновые печи
    "свч": "Микроволновая печь",
    "микроволновка": "Микроволновая печь",
    "микра": "Микроволновая печь",
    "свч печь": "Микроволновая печь",

    # Варочные панели
    "вар.пан": "Варочная панель",
    "вар панель": "Варочная панель",
    "варочка": "Варочная панель",
    "варочная": "Варочная панель",
    "индукция": "Варочная панель",

    # Духовые шкафы
    "дух.шк": "Духовой шкаф",
    "духовка": "Духовой шкаф",
    "дух шкаф": "Духовой шкаф",
    "духовой": "Духовой шкаф",

    # Вытяжки
    "вытяжка": "Вытяжка",
    "вытяж": "Вытяжка",

    # Кондиционеры
    "кондиционер": "Кондиционер",
    "кондей": "Кондиционер",
    "конд": "Кондиционер",
    "сплит": "Кондиционер",

    # Пылесосы
    "пылесос": "Пылесос",
    "пыл": "Пылесос",

    # Мультиварки
    "мультиварка": "Мультиварка",
    "мульта": "Мультиварка",

    # Кофемашины
    "кофемашина": "Кофемашина",
    "кофеварка": "Кофемашина",
    "кофе машина": "Кофемашина",

    # Утюги
    "утюг": "Утюг",

    # Чайники
    "чайник": "Чайник",

    # Морозильники
    "морозилка": "Морозильник",
    "морозильник": "Морозильник",

    # Прочее
    "прочее": "Прочее",
    "другое": "Прочее",
}


def normalize_equipment_type(equipment_text: str) -> str:
    """
    Нормализует тип оборудования по словарю сокращений.

    Args:
        equipment_text: Текст с типом оборудования (может содержать сокращение)

    Returns:
        Нормализованное полное название типа оборудования или исходный текст

    Examples:
        >>> normalize_equipment_type("С/м")
        "Стиральная машина"

        >>> normalize_equipment_type("тв samsung")
        "Телевизор"

        >>> normalize_equipment_type("Стиральная машина LG")
        "Стиральная машина"
    """
    # Приводим к нижнему регистру для поиска
    equipment_lower = equipment_text.lower().strip()

    # Точное совпадение
    if equipment_lower in EQUIPMENT_ABBREVIATIONS:
        return EQUIPMENT_ABBREVIATIONS[equipment_lower]

    # Поиск сокращения в начале строки (например, "С/м LG" → "Стиральная машина")
    for abbr, full_name in EQUIPMENT_ABBREVIATIONS.items():
        if equipment_lower.startswith(abbr + " ") or equipment_lower.startswith(abbr + ","):
            return full_name

    # Поиск по вхождению слова (например, "стиралка самсунг" → "Стиральная машина")
    words = equipment_lower.split()
    for word in words:
        if word in EQUIPMENT_ABBREVIATIONS:
            return EQUIPMENT_ABBREVIATIONS[word]

    # Если не нашли - возвращаем первое слово с заглавной буквы
    first_word = equipment_text.strip().split()[0] if equipment_text.strip() else equipment_text
    return first_word.capitalize()
