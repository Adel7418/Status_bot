# üìö –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫ - –ö—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞

## ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º–µ

### 1. üóëÔ∏è –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (Soft Delete)
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–í–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è –∑–∞—è–≤–æ–∫, –æ–Ω–∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ —É–¥–∞–ª–µ–Ω–Ω—ã–µ:
- –ü–æ–ª–µ `deleted_at` –≤ —Ç–∞–±–ª–∏—Ü–∞—Ö `orders`, `users`, `masters`
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

```sql
-- –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞—è–≤–∫–∏
SELECT * FROM orders WHERE deleted_at IS NULL;

-- –í—Å–µ –∑–∞—è–≤–∫–∏ (–≤–∫–ª—é—á–∞—è —É–¥–∞–ª–µ–Ω–Ω—ã–µ)
SELECT * FROM orders;

-- –¢–æ–ª—å–∫–æ —É–¥–∞–ª–µ–Ω–Ω—ã–µ
SELECT * FROM orders WHERE deleted_at IS NOT NULL;
```

### 2. üìä –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

–¢–∞–±–ª–∏—Ü–∞ `order_status_history` —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:
- –°—Ç–∞—Ä—ã–π –∏ –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å
- –ö—Ç–æ –∏–∑–º–µ–Ω–∏–ª (Telegram ID)
- –ö–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### 3. üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–µ–π
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–¢–∞–±–ª–∏—Ü–∞ `entity_history` –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç:
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö –ø–æ–ª–µ–π
- –°—Ç–∞—Ä–æ–µ –∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ö—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª

### 4. üìù –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç

–¢–∞–±–ª–∏—Ü–∞ `audit_log` –ª–æ–≥–∏—Ä—É–µ—Ç:
- –í—Å–µ –≤–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –î–µ—Ç–∞–ª–∏ –æ–ø–µ—Ä–∞—Ü–∏–π
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

---

## üéØ –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–∞—à–∏ –≤–æ–ø—Ä–æ—Å—ã

### ‚ùì –ú–æ–∂–µ—Ç –ª–∏ –∫–∞–∂–¥–∞—è –∑–∞—è–≤–∫–∞ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –≤ –±–∞–∑–µ –Ω–∞–≤—Å–µ–≥–¥–∞?

**‚úÖ –î–ê!** –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –≤—Å—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

1. **Soft Delete** - –∑–∞—è–≤–∫–∏ –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è —Ñ–∏–∑–∏—á–µ—Å–∫–∏
2. **–ò—Å—Ç–æ—Ä–∏—è** - –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
3. **–ê—É–¥–∏—Ç** - –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
4. **–ò–Ω–¥–µ–∫—Å—ã** - –±—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –ø–æ –ª—é–±—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º

### ‚ùì –ú–æ–∂–Ω–æ –ª–∏ –≤ –ª—é–±–æ–π –º–æ–º–µ–Ω—Ç –Ω–∞–π—Ç–∏ –∑–∞—è–≤–∫—É?

**‚úÖ –î–ê!** –ù–µ—Å–∫–æ–ª—å–∫–æ —Å–ø–æ—Å–æ–±–æ–≤:

1. **–ü–æ ID:**
```sql
SELECT * FROM orders WHERE id = 123;
```

2. **–ü–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É –∫–ª–∏–µ–Ω—Ç–∞:**
```sql
SELECT * FROM orders WHERE client_phone LIKE '%79991234567%';
```

3. **–ü–æ –¥–∞—Ç–µ:**
```sql
SELECT * FROM orders
WHERE created_at BETWEEN '2025-01-01' AND '2025-12-31';
```

4. **–ü–æ –º–∞—Å—Ç–µ—Ä—É:**
```sql
SELECT * FROM orders WHERE assigned_master_id = 5;
```

5. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫** (—Å –Ω–æ–≤—ã–º —Å–µ—Ä–≤–∏—Å–æ–º):
```python
orders = await search_service.search(
    query="—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫",
    filters={
        "status": "COMPLETED",
        "date_from": datetime(2025, 1, 1)
    }
)
```

### ‚ùì –ú–æ–∂–Ω–æ –ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é –∑–∞—è–≤–∫–∏?

**‚úÖ –î–ê!** –î–æ—Å—Ç—É–ø–Ω–∞ –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è:

```python
history = await order_repo.get_full_history(order_id=123)

# –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
# - status_history: –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
# - field_history: –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–µ–π
# - audit_logs: –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —Å –∑–∞—è–≤–∫–æ–π
```

### ‚ùì –ö–∞–∫ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ?

**–Ø —Å–æ–∑–¥–∞–ª –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ:**

1. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞:**
```bash
pip install cryptography==43.0.3
```

2. **–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞:**
```bash
python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"
```

3. **–î–æ–±–∞–≤–∏—Ç—å –≤ .env:**
```bash
ENCRYPTION_KEY=–≤–∞—à_—Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π_–∫–ª—é—á
ENCRYPT_DATA=true
```

4. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```python
from app.utils.encryption import encrypt, decrypt

# –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
encrypted = encrypt("79991234567")

# –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
original = decrypt(encrypted)
```

---

## üöÄ –ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è

–Ø —Å–æ–∑–¥–∞–ª –¥–ª—è –≤–∞—Å:

### 1. üì¶ –ú–æ–¥—É–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
**–§–∞–π–ª:** `app/utils/encryption.py`

–ì–æ—Ç–æ–≤—ã–π –º–æ–¥—É–ª—å –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è/–¥–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### 2. üìö –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
**–§–∞–π–ª:** `app/repositories/order_repository_extended.py`

–ù–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
- `soft_delete()` - –º—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
- `restore()` - –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- `search_orders()` - —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫
- `get_full_history()` - –ø–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
- `get_deleted_orders()` - —Å–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö

### 3. üîç –°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞
**–§–∞–π–ª:** `app/services/search_service.py`

–£–¥–æ–±–Ω—ã–π –ø–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫:
- –ü–æ —Ç–µ–∫—Å—Ç—É
- –ü–æ —Ñ–∏–ª—å—Ç—Ä–∞–º
- –ü–æ –∫–ª–∏–µ–Ω—Ç—É
- –ü–æ –¥–∞—Ç–∞–º
- –° –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π

### 4. üîß –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
**–§–∞–π–ª:** `scripts/migrate_encryption.py`

–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.

---

## üìñ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–Ø —Å–æ–∑–¥–∞–ª –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:

1. **PERMANENT_STORAGE_GUIDE.md** - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (218 —Å—Ç—Ä–æ–∫)
   - –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞
   - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–µ—à–µ–Ω–∏—è
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
   - –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

2. **PERMANENT_STORAGE_EXAMPLES.md** - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
   - –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ handlers
   - –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
   - –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏

3. **QUICKSTART_PERMANENT_STORAGE.md** - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
   - –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞ 5 –º–∏–Ω—É—Ç
   - –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã
   - FAQ

---

## üéØ –ö–∞–∫–∏–º–∏ –ø—É—Ç—è–º–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

### –ü—É—Ç—å 1: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**‚úÖ –ü–ª—é—Å—ã:** –£–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–∏—á–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –º–µ–Ω—è—Ç—å
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** –ü—Ä–æ—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–∞–±–ª–∏—Ü—ã

```python
# –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!)
history = await order_repo.get_status_history(order_id=123)

# –ü–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫ (–¥–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä)
SELECT * FROM orders WHERE deleted_at IS NULL
```

### –ü—É—Ç—å 2: –í–Ω–µ–¥—Ä–∏—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**‚úÖ –ü–ª—é—Å—ã:** –ë–æ–ª—å—à–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π, —É–¥–æ–±–Ω–µ–µ —Ä–∞–±–æ—Ç–∞—Ç—å
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏

```python
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
from app.repositories.order_repository_extended import OrderRepositoryExtended
order_repo = OrderRepositoryExtended(db.connection)

# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞
from app.services.search_service import SearchService
search_service = SearchService(order_repo)
```

### –ü—É—Ç—å 3: –î–æ–±–∞–≤–∏—Ç—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**‚úÖ –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ:** Production, –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
**–ß—Ç–æ –¥–µ–ª–∞—Ç—å:** –°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º –≤ QUICKSTART

---

## üìä –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

### –£–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:

‚úÖ **–ò–Ω–¥–µ–∫—Å—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞:
- `idx_orders_deleted_at` - –ø–æ–∏—Å–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö/—É–¥–∞–ª–µ–Ω–Ω—ã—Ö
- `idx_orders_status` - —Ñ–∏–ª—å—Ç—Ä –ø–æ —Å—Ç–∞—Ç—É—Å—É
- `idx_orders_assigned_master_id` - –∑–∞—è–≤–∫–∏ –º–∞—Å—Ç–µ—Ä–∞
- `idx_orders_status_created` - —Å–ª–æ–∂–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã
- –ò –¥—Ä—É–≥–∏–µ...

‚úÖ **–ß–∞—Å—Ç–∏—á–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã** (—Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏):
```sql
CREATE INDEX idx_orders_active ON orders(deleted_at)
WHERE deleted_at IS NULL;
```

‚úÖ **–í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

1. **–í—Å–µ–≥–¥–∞ —Ñ–∏–ª—å—Ç—Ä—É–π—Ç–µ deleted:**
```sql
WHERE deleted_at IS NULL
```

2. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ LIMIT:**
```sql
SELECT * FROM orders LIMIT 50
```

3. **–ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø–æ–∏—Å–∫–∞:**
```sql
WHERE status = 'NEW' AND created_at > '2025-01-01'
-- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç idx_orders_status_created
```

---

## üîê –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ: –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –ß—Ç–æ —à–∏—Ñ—Ä–æ–≤–∞—Ç—å:

‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ:**
- –ù–æ–º–µ—Ä–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤ –∫–ª–∏–µ–Ω—Ç–æ–≤
- –ê–¥—Ä–µ—Å–∞
- –§–ò–û –∫–ª–∏–µ–Ω—Ç–æ–≤

‚ùå **–ù–µ –Ω—É–∂–Ω–æ:**
- ID –∑–∞–ø–∏—Å–µ–π
- –°—Ç–∞—Ç—É—Å—ã
- –î–∞—Ç—ã
- –°–ª—É–∂–µ–±–Ω—ã–µ –ø–æ–ª—è

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ 1000 –∑–∞–ø–∏—Å–µ–π: ~0.1 —Å–µ–∫
- –î–µ—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏: –Ω–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ
- Cryptography –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:

‚ö†Ô∏è **–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û:**
1. –ù–ï –ø—É–±–ª–∏–∫—É–π—Ç–µ –∫–ª—é—á –≤ git
2. –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
3. –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –∫–ª—é—á–∞
4. –ë–µ–∑ –∫–ª—é—á–∞ –¥–∞–Ω–Ω—ã–µ –ù–ï–í–û–ó–ú–û–ñ–ù–û –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

---

## üìà –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ–∫—É—â–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ (SQLite):

- –î–æ 100,000 –∑–∞—è–≤–æ–∫ - –æ—Ç–ª–∏—á–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç
- –î–æ 1,000,000 –∑–∞—è–≤–æ–∫ - –ø—Ä–∏–µ–º–ª–µ–º–æ
- –ë–æ–ª—å—à–µ - –Ω—É–∂–µ–Ω PostgreSQL

### –ü—Ä–∏ —Ä–æ—Å—Ç–µ —Å–∏—Å—Ç–µ–º—ã:

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL** (—É–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–∞)
2. **–ü–∞—Ä—Ç–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ** –ø–æ –≥–æ–¥–∞–º
3. **–ê—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ** —Å—Ç–∞—Ä—ã—Ö –∑–∞—è–≤–æ–∫ (>2 –ª–µ—Ç)
4. **Full-text search** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
5. **Read replicas** –¥–ª—è –æ—Ç—á–µ—Ç–æ–≤

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ú–∏–Ω–∏–º—É–º (—É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):

1. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ soft delete –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
2. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä `WHERE deleted_at IS NULL` –≤–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã
3. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤

### –û–ø—Ç–∏–º–∞–ª—å–Ω–æ (–≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏):

1. ‚úÖ –í–Ω–µ–¥—Ä–∏—Ç–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
2. ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞
3. ‚úÖ –î–æ–±–∞–≤—å—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è production

### –ú–∞–∫—Å–∏–º—É–º (–¥–ª—è –±—É–¥—É—â–µ–≥–æ):

1. ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL
2. ‚úÖ Full-text search
3. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∞—Ä—Ö–∏–≤–∏—Ä–æ–≤–∞–Ω–∏–µ
4. ‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

---

## üìû –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ:** `QUICKSTART_PERMANENT_STORAGE.md` (5 –º–∏–Ω—É—Ç)
2. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:** `pip install cryptography`
3. **–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –∫–ª—é—á:** –î–æ–±–∞–≤—å—Ç–µ –≤ `.env`
4. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã
5. **–í–Ω–µ–¥—Ä–∏—Ç–µ:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏

---

## üìö –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

```
docs/
‚îú‚îÄ‚îÄ –ü–û–°–¢–û–Ø–ù–ù–û–ï_–•–†–ê–ù–ï–ù–ò–ï_–ó–ê–Ø–í–û–ö.md     ‚Üê –í–´ –ó–î–ï–°–¨ (–∫—Ä–∞—Ç–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞)
‚îú‚îÄ‚îÄ QUICKSTART_PERMANENT_STORAGE.md   ‚Üê –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç (5 –º–∏–Ω)
‚îú‚îÄ‚îÄ PERMANENT_STORAGE_GUIDE.md        ‚Üê –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ (–ø–æ–¥—Ä–æ–±–Ω–æ)
‚îî‚îÄ‚îÄ PERMANENT_STORAGE_EXAMPLES.md     ‚Üê –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞ (–≥–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è)

app/
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ encryption.py                  ‚Üê –ú–æ–¥—É–ª—å —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–≥–æ—Ç–æ–≤)
‚îú‚îÄ‚îÄ repositories/
‚îÇ   ‚îî‚îÄ‚îÄ order_repository_extended.py   ‚Üê –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (–≥–æ—Ç–æ–≤)
‚îî‚îÄ‚îÄ services/
    ‚îî‚îÄ‚îÄ search_service.py              ‚Üê –°–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞ (–≥–æ—Ç–æ–≤)

scripts/
‚îî‚îÄ‚îÄ migrate_encryption.py              ‚Üê –°–∫—Ä–∏–ø—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ (–≥–æ—Ç–æ–≤)
```

---

## ‚ùì –û—Å—Ç–∞–ª–∏—Å—å –≤–æ–ø—Ä–æ—Å—ã?

–ß–∏—Ç–∞–π—Ç–µ –ø–æ–¥—Ä–æ–±–Ω—ã–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞:
- üìñ [PERMANENT_STORAGE_GUIDE.md](./PERMANENT_STORAGE_GUIDE.md)
- üìù [PERMANENT_STORAGE_EXAMPLES.md](./PERMANENT_STORAGE_EXAMPLES.md)
- ‚ö° [QUICKSTART_PERMANENT_STORAGE.md](./QUICKSTART_PERMANENT_STORAGE.md)

---

**‚úÖ –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º—É —Ö—Ä–∞–Ω–µ–Ω–∏—é –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫!**

- ‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 20.10.2025
**–ê–≤—Ç–æ—Ä:** AI Assistant
