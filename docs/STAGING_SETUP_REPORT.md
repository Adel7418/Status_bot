# üìã –û—Ç—á–µ—Ç: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Staging Workflow

**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω–æ

---

## üéØ –¶–µ–ª—å –ø—Ä–æ–µ–∫—Ç–∞

–°–æ–∑–¥–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω—É—é —Å–∏—Å—Ç–µ–º—É —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –¥–µ–ø–ª–æ—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —Ç—Ä–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π:
- **Local (DEV)** - —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ Cursor –±–µ–∑ Docker
- **Staging** - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º
- **Production** - —Ä–µ–∞–ª—å–Ω—ã–π –±–æ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏

**–û—Å–Ω–æ–≤–Ω–æ–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–µ:** –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –¥–µ–ª–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞ –±–µ–∑ —Ä–∏—Å–∫–∞ –¥–ª—è production –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

#### Makefile
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –ø—É—Ç–∏ –∫ docker-compose —Ñ–∞–π–ª–∞–º (–¥–æ–±–∞–≤–ª–µ–Ω `cd docker`)
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫–æ–º–∞–Ω–¥—ã –º–∏–≥—Ä–∞—Ü–∏–π (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ compose —Ñ–∞–π–ª–∞)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è staging –∏ production –¥–µ–ø–ª–æ—è:
  - `make staging-deploy` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –≤ staging
  - `make staging-logs` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ staging
  - `make prod-deploy` - –¥–µ–ø–ª–æ–π –≤ production —Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º
  - `make prod-logs` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ production
  - `make prod-status` - —Å—Ç–∞—Ç—É—Å production –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

#### –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–µ–∫—Ç–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç–æ–≤—ã–µ —Ñ–∞–π–ª—ã –∏–∑ –∫–æ—Ä–Ω—è:
  - `force_sla_check.py`
  - `check_tables.py`
  - `test_filter.py`
  - `test_sla.py`
  - `DATABASE_PATH=bot_database.db`

---

### 2. –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π –¥–ª—è staging

#### docker-compose.staging.yml
- ‚úÖ –°–æ–∑–¥–∞–Ω –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–π compose —Ñ–∞–π–ª –¥–ª—è staging
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ volumes: `bot_data_staging`, `bot_logs_staging`, `bot_backups_staging`, `redis_data_staging`
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ –∏–º–µ–Ω–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: `telegram_repair_bot_staging`, `telegram_bot_redis_staging`
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω–∞—è —Å–µ—Ç—å: `bot_network_staging`
- ‚úÖ DEBUG —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –æ—Ç–ª–∞–¥–∫–∏
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `.env.staging` —Ñ–∞–π–ª–∞

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `docker/docker-compose.staging.yml`

#### env.staging.example
- ‚úÖ –°–æ–∑–¥–∞–Ω —à–∞–±–ª–æ–Ω –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è staging –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥—Ä–æ–±–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¢–ï–°–¢–û–í–û–ì–û —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- ‚úÖ DEBUG —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `env.staging.example`

---

### 3. –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è

#### deploy_staging.sh
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
- –ü–µ—Ä–µ—Ö–æ–¥ –≤ staging –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
- Git pull –∏–∑ main –≤–µ—Ç–∫–∏
- –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Ç–µ–∫—É—â–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –Ω–æ–≤—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π –ë–î
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥ –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
export SSH_SERVER=root@your-server-ip
make staging-deploy
```

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/deploy_staging.sh`

#### deploy_prod.sh
**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ó–∞–ø—Ä–æ—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (–≤–≤–æ–¥ 'yes')
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—É—â–µ–≥–æ git commit –¥–ª—è –æ—Ç–∫–∞—Ç–∞
- –°–æ–∑–¥–∞–Ω–∏–µ backup –ë–î –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
- Git pull –∏–∑ main –≤–µ—Ç–∫–∏
- –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ç–∫–∞—Ç—É –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
export SSH_SERVER=root@your-server-ip
make prod-deploy
```

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/deploy_prod.sh`

#### –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
- ‚úÖ `staging_logs.sh` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ staging
- ‚úÖ `prod_logs.sh` - –ø—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ production
- ‚úÖ `prod_status.sh` - —Å—Ç–∞—Ç—É—Å production (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã, —Ä–µ—Å—É—Ä—Å—ã, –ª–æ–≥–∏)

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/`

---

### 4. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

#### STAGING_WORKFLOW.md
**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ workflow DEV ‚Üí STAGING ‚Üí PROD
- –ü–æ—à–∞–≥–æ–≤—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –≤—Å–µ—Ö –æ–∫—Ä—É–∂–µ–Ω–∏–π
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é –≤ staging –∏ production
- –ë—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- Troubleshooting —Ç–∏–ø–∏—á–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `docs/STAGING_WORKFLOW.md`

#### README.md
**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ —Å–µ–∫—Ü–∏—è "Workflow —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏: DEV ‚Üí STAGING ‚Üí PROD"
- ‚úÖ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–æ—Ç–∞
- ‚úÖ –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è" —Å —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ –Ω–æ–≤—ã–π workflow
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "–ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã" —Å staging/prod –∫–æ–º–∞–Ω–¥–∞–º–∏

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `README.md`

#### scripts/README.md
**–û–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –æ–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–µ–ø–ª–æ—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω —Ä–∞–∑–¥–µ–ª "Staging ‚Üí Production Workflow"
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –±—ã—Å—Ç—Ä–∞—è —Å–ø—Ä–∞–≤–∫–∞ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º
- ‚úÖ –°—Å—ã–ª–∫–∞ –Ω–∞ –¥–µ—Ç–∞–ª—å–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é STAGING_WORKFLOW.md

**–ú–µ—Å—Ç–æ–ø–æ–ª–æ–∂–µ–Ω–∏–µ:** `scripts/README.md`

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤ –ø—Ä–æ–µ–∫—Ç–∞

```
telegram_repair_bot/
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml           # Dev (bind mounts)
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.dev.yml       # Dev —Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –æ–ø—Ü–∏—è–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.staging.yml   # ‚ú® NEW: Staging
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.prod.yml      # Production
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.migrate.yml   # –ú–∏–≥—Ä–∞—Ü–∏–∏
‚îÇ   ‚îî‚îÄ‚îÄ Dockerfile
‚îÇ
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy_staging.sh            # ‚ú® NEW: –î–µ–ø–ª–æ–π –≤ staging
‚îÇ   ‚îú‚îÄ‚îÄ deploy_prod.sh               # ‚ú® NEW: –î–µ–ø–ª–æ–π –≤ production
‚îÇ   ‚îú‚îÄ‚îÄ staging_logs.sh              # ‚ú® NEW: –õ–æ–≥–∏ staging
‚îÇ   ‚îú‚îÄ‚îÄ prod_logs.sh                 # ‚ú® NEW: –õ–æ–≥–∏ production
‚îÇ   ‚îú‚îÄ‚îÄ prod_status.sh               # ‚ú® NEW: –°—Ç–∞—Ç—É—Å production
‚îÇ   ‚îî‚îÄ‚îÄ README.md                    # üìù UPDATED
‚îÇ
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îú‚îÄ‚îÄ STAGING_WORKFLOW.md          # ‚ú® NEW: –î–µ—Ç–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ STAGING_SETUP_REPORT.md      # ‚ú® NEW: –≠—Ç–æ—Ç –æ—Ç—á–µ—Ç
‚îÇ
‚îú‚îÄ‚îÄ env.example                       # –®–∞–±–ª–æ–Ω –¥–ª—è production/dev
‚îú‚îÄ‚îÄ env.staging.example               # ‚ú® NEW: –®–∞–±–ª–æ–Ω –¥–ª—è staging
‚îú‚îÄ‚îÄ Makefile                          # üìù UPDATED: –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
‚îî‚îÄ‚îÄ README.md                         # üìù UPDATED: –ù–æ–≤–∞—è —Å–µ–∫—Ü–∏—è workflow
```

---

## üöÄ –ü—Ä–æ—Ü–µ—Å—Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ (–æ–¥–∏–Ω —Ä–∞–∑)

#### 1. –õ–æ–∫–∞–ª—å–Ω–æ (Cursor)
```bash
# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
python -m venv venv
.\venv\Scripts\Activate.ps1
pip install -r requirements-dev.txt

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –¥–µ–ø–ª–æ—è
$env:SSH_SERVER="root@your-server-ip"
```

#### 2. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ (—Å–æ–∑–¥–∞–Ω–∏–µ staging –æ–∫—Ä—É–∂–µ–Ω–∏—è)
```bash
ssh root@your-server-ip

# Production (—É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç)
cd ~/telegram_repair_bot

# –°–æ–∑–¥–∞–Ω–∏–µ staging
cd ~
git clone <repository-url> telegram_repair_bot_staging
cd telegram_repair_bot_staging
cp env.staging.example .env.staging
nano .env.staging  # –£–∫–∞–∑–∞—Ç—å –¢–ï–°–¢–û–í–´–ô —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
```

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π workflow

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. –†–ê–ó–†–ê–ë–û–¢–ö–ê (Cursor)                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚Ä¢ –í–Ω–µ—Å—Ç–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥                                    ‚îÇ
‚îÇ ‚Ä¢ make test && make lint                                    ‚îÇ
‚îÇ ‚Ä¢ git commit && git push                                    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. STAGING (–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)                                   ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚Ä¢ make staging-deploy                                       ‚îÇ
‚îÇ ‚Ä¢ make staging-logs (–ø—Ä–æ–≤–µ—Ä–∫–∞)                             ‚îÇ
‚îÇ ‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                           ‚îÇ
                           ‚ñº (–µ—Å–ª–∏ –≤—Å—ë –û–ö)
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. PRODUCTION (–î–µ–ø–ª–æ–π)                                      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ ‚Ä¢ make prod-deploy (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º!)                     ‚îÇ
‚îÇ ‚Ä¢ make prod-logs (–ø—Ä–æ–≤–µ—Ä–∫–∞)                                ‚îÇ
‚îÇ ‚Ä¢ make prod-status (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥)                            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ß—Ç–æ –∑–∞—â–∏—â–∞–µ—Ç production:

1. **–ò–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**
   - Staging –∏ production –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω—ã
   - –†–∞–∑–Ω—ã–µ volumes Docker
   - –†–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –±–æ—Ç–æ–≤
   - –†–∞–∑–Ω—ã–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

2. **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**
   - Production –¥–µ–ø–ª–æ–π —Ç—Ä–µ–±—É–µ—Ç —è–≤–Ω–æ–≥–æ –≤–≤–æ–¥–∞ 'yes'
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –ë–î –ø–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ git commit –¥–ª—è –æ—Ç–∫–∞—Ç–∞

3. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º**
   - –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ö–æ–¥—è—Ç —á–µ—Ä–µ–∑ staging
   - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –±–æ—Ç–µ
   - –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –ø–µ—Ä–µ–¥ production –¥–µ–ø–ª–æ–µ–º

4. **–û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π**
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ git commit hash
   - –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –æ—Ç–∫–∞—Ç—É –≤ –≤—ã–≤–æ–¥–µ —Å–∫—Ä–∏–ø—Ç–∞
   - Backup –ë–î –ø–µ—Ä–µ–¥ –∫–∞–∂–¥—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º

---

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ workflow

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞:
- ‚úÖ –ë—ã—Å—Ç—Ä–∞—è –ª–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ Docker
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π
- ‚úÖ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á—Ç–æ production –Ω–µ —Å–ª–æ–º–∞–µ—Ç—Å—è
- ‚úÖ –ü—Ä–æ—Å—Ç–∞—è –æ—Ç–ª–∞–¥–∫–∞ –≤ staging —Å DEBUG –ª–æ–≥–∞–º–∏

### –î–ª—è –ø—Ä–æ–µ–∫—Ç–∞:
- ‚úÖ –ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è downtime production
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å–ª–æ–∂–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
- ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å

### –î–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- ‚úÖ –ò–∑–æ–ª—è—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏–π
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–µ—Ä–µ–¥ production –¥–µ–ø–ª–æ–µ–º
- ‚úÖ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –±—ã—Å—Ç—Ä–æ–≥–æ –æ—Ç–∫–∞—Ç–∞
- ‚úÖ –û—Ç–¥–µ–ª—å–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –∏ –ë–î

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –î–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã:

1. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   ```bash
   # Windows PowerShell
   $env:SSH_SERVER="root@your-server-ip"
   
   # –ò–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ .env (–Ω–µ –∫–æ–º–º–∏—Ç—å—Ç–µ!)
   echo "SSH_SERVER=root@your-server-ip" >> .env
   ```

2. **–°–æ–∑–¥–∞–π—Ç–µ staging –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:**
   ```bash
   ssh root@your-server-ip
   cd ~
   git clone <repository-url> telegram_repair_bot_staging
   cd telegram_repair_bot_staging
   cp env.staging.example .env.staging
   # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env.staging —Å –¢–ï–°–¢–û–í–´–ú —Ç–æ–∫–µ–Ω–æ–º
   ```

3. **–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–≤—ã–π –¥–µ–ø–ª–æ–π:**
   ```bash
   # –õ–æ–∫–∞–ª—å–Ω–æ
   make staging-deploy
   make staging-logs
   ```

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:

- üìñ –ü—Ä–æ—á–∏—Ç–∞–π—Ç–µ [docs/STAGING_WORKFLOW.md](STAGING_WORKFLOW.md) –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø–æ–Ω–∏–º–∞–Ω–∏—è
- üîë –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±–æ—Ç–∞ —É @BotFather –¥–ª—è staging
- üíæ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –±—ç–∫–∞–ø—ã production –ë–î
- üîç –î–æ–±–∞–≤—å—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: Prometheus + Grafana –∏–∑ docker-compose.prod.yml)

---

## ‚ùì FAQ

### –í: –ö–∞–∫ –æ—Ç–∫–∞—Ç–∏—Ç—å production –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫?

**–û:** –°–∫—Ä–∏–ø—Ç `deploy_prod.sh` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç commit hash –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ:
```bash
ssh root@your-server-ip
cd ~/telegram_repair_bot
git reset --hard <commit-hash>
cd docker
docker compose -f docker-compose.prod.yml up -d --build
```

### –í: –ú–æ–∂–Ω–æ –ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å staging –ª–æ–∫–∞–ª—å–Ω–æ?

**–û:** –î–∞! –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `docker-compose.staging.yml` –ª–æ–∫–∞–ª—å–Ω–æ:
```bash
cd docker
docker compose -f docker-compose.staging.yml up -d
```

### –í: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ staging –∏ production –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç?

**–û:** –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –≤ `.env.staging` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **–¥—Ä—É–≥–æ–π —Ç–æ–∫–µ–Ω –±–æ—Ç–∞**. –î–≤–∞ –±–æ—Ç–∞ –Ω–µ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ.

### –í: –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º?

**–û:** –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ GitHub Actions. –ü—Ä–∏–º–µ—Ä —É–∂–µ –µ—Å—Ç—å –≤ `.github/workflows/`.

---

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ staging workflow —É—Å–ø–µ—à–Ω–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–û—Å–Ω–æ–≤–Ω—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –±–µ–∑ —Ä–∏—Å–∫–∞ –¥–ª—è production
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–µ–ø–ª–æ–π –≤ staging –∏ production
- ‚úÖ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞
- ‚úÖ –ü—Ä–æ—Å—Ç—ã–µ –∫–æ–º–∞–Ω–¥—ã `make staging-deploy` –∏ `make prod-deploy`

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –æ–∫—Ä—É–∂–µ–Ω–∏–π:**
```
Local (Cursor) ‚Üí Staging (Test Bot) ‚Üí Production (Real Bot)
     ‚Üì                 ‚Üì                      ‚Üì
   –ë—ã—Å—Ç—Ä–æ          –ë–µ–∑–æ–ø–∞—Å–Ω–æ             –°—Ç–∞–±–∏–ª—å–Ω–æ
```

---

**–ê–≤—Ç–æ—Ä:** AI Assistant  
**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–ü—Ä–æ–µ–∫—Ç:** telegram_repair_bot  
**–í–µ—Ä—Å–∏—è workflow:** 1.0

