# üìö –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π –∏—Å—Ç–æ—Ä–∏–∏ –∏ –ø–æ–∏—Å–∫–∞

## üéØ –û–±–∑–æ—Ä –Ω–æ–≤—ã—Ö –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π

–ü–æ—Å–ª–µ –¥–æ—Ä–∞–±–æ—Ç–∫–∏ —Å–∏—Å—Ç–µ–º—ã –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∑–∞—è–≤–æ–∫, –ø–æ–∏—Å–∫–æ–º –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ–º —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π.

---

## üîê –î–æ—Å—Ç—É–ø

### –ö—Ç–æ –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

- **ADMIN** - –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫–æ –≤—Å–µ–º —Ñ—É–Ω–∫—Ü–∏—è–º
- **DISPATCHER** - –¥–æ—Å—Ç—É–ø –∫ –∏—Å—Ç–æ—Ä–∏–∏ –∏ –ø–æ–∏—Å–∫—É (–±–µ–∑ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è)
- **MASTER** - –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Å–≤–æ–∏–º –∑–∞—è–≤–∫–∞–º

---

## üìã –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

### 1. `/history <–Ω–æ–º–µ—Ä>` - –ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞—è–≤–∫–∏

**–î–æ—Å—Ç—É–ø–Ω–æ:** ADMIN, DISPATCHER

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/history 123
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–µ–π
- –ê—É–¥–∏—Ç –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
- –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–∫–∏

**–ü—Ä–∏–º–µ—Ä:**
```
/history 15

üìã –ò—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–∫–∏ #15

üîß –¢–∏–ø: –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫
üìä –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å: COMPLETED
üë§ –ö–ª–∏–µ–Ω—Ç: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤

[–ö–Ω–æ–ø–∫–∏]
üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
üìù –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
üìã –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
```

---

### 2. `/deleted` - –°–ø–∏—Å–æ–∫ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫

**–î–æ—Å—Ç—É–ø–Ω–æ:** ADMIN

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/deleted
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫
- –î–∞—Ç–∞ —É–¥–∞–ª–µ–Ω–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```
/deleted

üóë –£–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏

–í—Å–µ–≥–æ –Ω–∞–π–¥–µ–Ω–æ: 3

üìã #10 - –°—Ç–∏—Ä–∞–ª—å–Ω–∞—è –º–∞—à–∏–Ω–∞
   üë§ –ü–µ—Ç—Ä–æ–≤ –ü.–ü.
   üìä CLOSED
   üóë 19.10.2025 15:30
   /restore_10

üìã #25 - –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫
   üë§ –ò–≤–∞–Ω–æ–≤ –ò.–ò.
   üìä REFUSED
   üóë 18.10.2025 10:15
   /restore_25
```

---

### 3. `/search <–∑–∞–ø—Ä–æ—Å>` - –ü–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫

**–î–æ—Å—Ç—É–ø–Ω–æ:** ADMIN, DISPATCHER

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/search —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫
/search –ò–≤–∞–Ω–æ–≤
/search 79991234567
```

**–ì–¥–µ –∏—â–µ—Ç:**
- –¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏
- –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã
- –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞
- –ê–¥—Ä–µ—Å –∫–ª–∏–µ–Ω—Ç–∞
- –¢–µ–ª–µ—Ñ–æ–Ω –∫–ª–∏–µ–Ω—Ç–∞

**–ü—Ä–∏–º–µ—Ä:**
```
/search —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫

üîç –ù–∞–π–¥–µ–Ω–æ –∑–∞—è–≤–æ–∫: 3

üìã –ó–∞—è–≤–∫–∞ #15
üìä –°—Ç–∞—Ç—É—Å: COMPLETED
üîß –¢–∏–ø: –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ Samsung
üë§ –ö–ª–∏–µ–Ω—Ç: –ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤
üë®‚Äçüîß –ú–∞—Å—Ç–µ—Ä: –ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤

üìã –ó–∞—è–≤–∫–∞ #28
üìä –°—Ç–∞—Ç—É—Å: IN_PROGRESS
üîß –¢–∏–ø: –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ LG
üë§ –ö–ª–∏–µ–Ω—Ç: –ú–∞—Ä–∏—è –°–∏–¥–æ—Ä–æ–≤–∞

üìã –ó–∞—è–≤–∫–∞ #42
üìä –°—Ç–∞—Ç—É—Å: NEW
üîß –¢–∏–ø: –•–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫ Indesit
üë§ –ö–ª–∏–µ–Ω—Ç: –ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤
```

---

### 4. `/restore_<–Ω–æ–º–µ—Ä>` - –ë—ã—Å—Ç—Ä–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

**–î–æ—Å—Ç—É–ø–Ω–æ:** ADMIN

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```
/restore_123
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—É—é –∑–∞—è–≤–∫—É
- –õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–µ –≤ –∞—É–¥–∏—Ç
- –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ

**–ü—Ä–∏–º–µ—Ä:**
```
/restore_10

‚úÖ –ó–∞—è–≤–∫–∞ #10 —É—Å–ø–µ—à–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!
```

---

## üñ±Ô∏è –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–Ω–æ–ø–∫–∏

### –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–∞ –∑–∞—è–≤–∫–∏:

```
üìä –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–∫–∏ #15

üïê 2025-10-20 14:30
   NEW ‚Üí ASSIGNED
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @dispatcher

üïê 2025-10-20 15:45
   ASSIGNED ‚Üí IN_PROGRESS
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @master

üïê 2025-10-21 10:15
   IN_PROGRESS ‚Üí COMPLETED
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @master
   üìù –†–∞–±–æ—Ç–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
```

### –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø–æ–ª–µ–π:

```
üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –∑–∞—è–≤–∫–∏ #15

üïê 2025-10-20 16:00
   –ü–æ–ª–µ: client_phone
   –ë—ã–ª–æ: 79991111111
   –°—Ç–∞–ª–æ: 79992222222
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @dispatcher

üïê 2025-10-20 17:30
   –ü–æ–ª–µ: notes
   –ë—ã–ª–æ: (–ø—É—Å—Ç–æ)
   –°—Ç–∞–ª–æ: –¢—Ä–µ–±—É—é—Ç—Å—è –∑–∞–ø—á–∞—Å—Ç–∏
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @master
```

### –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π

–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:

```
üìù –ê—É–¥–∏—Ç –∑–∞—è–≤–∫–∏ #15

üïê 2025-10-20 14:30
   –î–µ–π—Å—Ç–≤–∏–µ: ORDER_CREATED
   Order #15 created by dispatcher
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @dispatcher

üïê 2025-10-20 15:45
   –î–µ–π—Å—Ç–≤–∏–µ: ORDER_ASSIGNED
   Master assigned to order #15
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @dispatcher

üïê 2025-10-21 10:15
   –î–µ–π—Å—Ç–≤–∏–µ: ORDER_COMPLETED
   Order #15 marked as completed
   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: @master
```

---

## üîç –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ (–ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π)

### –í –∫–æ–¥–µ –±–æ—Ç–∞

```python
from app.database.db import Database
from app.repositories.order_repository_extended import OrderRepositoryExtended
from app.services.search_service import SearchService

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
db = Database()
await db.connect()
order_repo = OrderRepositoryExtended(db.connection)
search_service = SearchService(order_repo)

# –ü—Ä–æ—Å—Ç–æ–π –ø–æ–∏—Å–∫
orders = await search_service.search(query="—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫")

# –ü–æ–∏—Å–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞–º–∏
orders = await search_service.search(
    query="—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫",
    filters={
        "status": "COMPLETED",
        "date_from": datetime(2025, 10, 1),
        "date_to": datetime(2025, 10, 31)
    }
)

# –ü–æ–∏—Å–∫ –ø–æ —Ç–µ–ª–µ—Ñ–æ–Ω—É
orders = await search_service.search_by_client_phone("79991234567")

# –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏
orders = await search_service.search_by_client_name("–ò–≤–∞–Ω–æ–≤")

# –ü–æ–∏—Å–∫ –∑–∞ –ø–µ—Ä–∏–æ–¥
orders = await search_service.search_by_date_range(
    date_from=datetime(2025, 10, 1),
    date_to=datetime(2025, 10, 31),
    status="COMPLETED"
)

# –£–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏
deleted = await search_service.search_deleted_orders(limit=50)

# –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è
history = await search_service.get_full_order_history(order_id=15)

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
stats = await search_service.get_statistics(include_deleted=True)
```

---

## üìä –†–∞–±–æ—Ç–∞ —Å –∏—Å—Ç–æ—Ä–∏–µ–π (–ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π)

### –ü–æ–ª—É—á–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

```python
order_repo = OrderRepositoryExtended(db.connection)

# –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
status_history = await order_repo.get_status_history(order_id=15)

for h in status_history:
    print(f"{h['changed_at']}: {h['old_status']} ‚Üí {h['new_status']}")
    print(f"–ò–∑–º–µ–Ω–∏–ª: {h['username']}")
    if h['notes']:
        print(f"–ó–∞–º–µ—Ç–∫–∞: {h['notes']}")
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏

```python
# –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–∫–∏
full_history = await order_repo.get_full_history(order_id=15)

print(f"–°—Ç–∞—Ç—É—Å–æ–≤: {len(full_history['status_history'])}")
print(f"–ò–∑–º–µ–Ω–µ–Ω–∏–π: {len(full_history['field_history'])}")
print(f"–ê—É–¥–∏—Ç: {len(full_history['audit_logs'])}")
```

### Soft Delete

```python
# –ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ
await order_repo.soft_delete(
    order_id=15,
    deleted_by=user_id,
    reason="–î—É–±–ª–∏–∫–∞—Ç –∑–∞—è–≤–∫–∏"
)

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
await order_repo.restore(
    order_id=15,
    restored_by=user_id
)
```

---

## üéØ –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞

```python
async def find_client_orders(client_phone: str):
    """–ù–∞–π—Ç–∏ –≤—Å–µ –∑–∞—è–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞"""
    search_service = SearchService(order_repo)
    orders = await search_service.search_by_client_phone(client_phone)

    print(f"–ù–∞–π–¥–µ–Ω–æ –∑–∞—è–≤–æ–∫: {len(orders)}")
    for order in orders:
        print(f"#{order.id} - {order.status} - {order.equipment_type}")
```

### –ü—Ä–∏–º–µ—Ä 2: –≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –≤ —Ç–µ–∫—Å—Ç

```python
async def export_order_history(order_id: int) -> str:
    """–≠–∫—Å–ø–æ—Ä—Ç –∏—Å—Ç–æ—Ä–∏–∏ –∑–∞—è–≤–∫–∏ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç"""
    search_service = SearchService(order_repo)
    history = await search_service.get_full_order_history(order_id)

    text = f"–ò—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–∫–∏ #{order_id}\n"
    text += "=" * 50 + "\n\n"

    text += "–°–¢–ê–¢–£–°–´:\n"
    for h in history['status_history']:
        text += f"{h['changed_at']}: {h['old_status']} ‚Üí {h['new_status']}\n"

    text += "\n–ò–ó–ú–ï–ù–ï–ù–ò–Ø:\n"
    for h in history['field_history']:
        text += f"{h['changed_at']}: {h['field_name']}\n"

    return text
```

### –ü—Ä–∏–º–µ—Ä 3: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —É–¥–∞–ª–µ–Ω–Ω—ã–º –∑–∞—è–≤–∫–∞–º

```python
async def get_deletion_statistics():
    """–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫"""
    order_repo = OrderRepositoryExtended(db.connection)

    # –í—Å–µ –∑–∞—è–≤–∫–∏
    all_stats = await order_repo.get_statistics(include_deleted=True)

    # –¢–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–µ
    active_stats = await order_repo.get_statistics(include_deleted=False)

    deleted_count = all_stats['total'] - active_stats['total']

    print(f"–í—Å–µ–≥–æ –∑–∞—è–≤–æ–∫: {all_stats['total']}")
    print(f"–ê–∫—Ç–∏–≤–Ω—ã—Ö: {active_stats['total']}")
    print(f"–£–¥–∞–ª—ë–Ω–Ω—ã—Ö: {deleted_count}")
    print(f"% —É–¥–∞–ª–µ–Ω–Ω—ã—Ö: {deleted_count / all_stats['total'] * 100:.1f}%")
```

---

## üõ†Ô∏è –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ handlers

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –∫ –ø—Ä–æ—Å–º–æ—Ç—Ä—É –∑–∞—è–≤–∫–∏

```python
from app.handlers.admin_history import get_history_keyboard

@router.callback_query(F.data.startswith("view_order:"))
async def view_order(callback: CallbackQuery):
    order_id = int(callback.data.split(":")[1])

    # ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∑–∞—è–≤–∫–∏ ...

    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É "–ò—Å—Ç–æ—Ä–∏—è"
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="üìã –ò—Å—Ç–æ—Ä–∏—è", callback_data=f"history_menu:{order_id}")],
        # ... –¥—Ä—É–≥–∏–µ –∫–Ω–æ–ø–∫–∏ ...
    ])

    await callback.message.edit_text(text, reply_markup=keyboard)
```

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –≤ –º–µ–Ω—é –¥–∏—Å–ø–µ—Ç—á–µ—Ä–∞

```python
@router.message(F.text == "üîç –ü–æ–∏—Å–∫")
async def show_search_menu(message: Message):
    await message.answer(
        "üîç <b>–ü–æ–∏—Å–∫ –∑–∞—è–≤–æ–∫</b>\n\n"
        "–û—Ç–ø—Ä–∞–≤—å—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞:\n"
        "‚Ä¢ –¢–∏–ø —Ç–µ—Ö–Ω–∏–∫–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: —Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫)\n"
        "‚Ä¢ –ò–º—è –∫–ª–∏–µ–Ω—Ç–∞\n"
        "‚Ä¢ –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞\n\n"
        "–ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É:\n"
        "/search <–∑–∞–ø—Ä–æ—Å>",
        parse_mode="HTML"
    )
```

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –ø–æ–∏—Å–∫–∞

–í –∫–æ–¥–µ –º–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–∏–º–∏—Ç—ã:

```python
# –í search_service.py
DEFAULT_SEARCH_LIMIT = 50  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
MAX_SEARCH_LIMIT = 200     # –ú–∞–∫—Å–∏–º—É–º

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
orders = await search_service.search(query="...", limit=100)
```

### –ü–∞–≥–∏–Ω–∞—Ü–∏—è —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –∑–∞—è–≤–æ–∫

```python
# –°—Ç—Ä–∞–Ω–∏—Ü–∞ 0 (–ø–µ—Ä–≤—ã–µ 10)
page_1 = await order_repo.get_deleted_orders(limit=10, offset=0)

# –°—Ç—Ä–∞–Ω–∏—Ü–∞ 1 (—Å–ª–µ–¥—É—é—â–∏–µ 10)
page_2 = await order_repo.get_deleted_orders(limit=10, offset=10)

# –°—Ç—Ä–∞–Ω–∏—Ü–∞ 2 (—Å–ª–µ–¥—É—é—â–∏–µ 10)
page_3 = await order_repo.get_deleted_orders(limit=10, offset=20)
```

---

## üì± –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–æ–∏—Å–∫ —Å—Ç–∞—Ä–æ–π –∑–∞—è–≤–∫–∏ –∫–ª–∏–µ–Ω—Ç–∞

1. –ö–ª–∏–µ–Ω—Ç –∑–≤–æ–Ω–∏—Ç –∏ –≥–æ–≤–æ—Ä–∏—Ç –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
2. –î–∏—Å–ø–µ—Ç—á–µ—Ä: `/search 79991234567`
3. –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ –∑–∞—è–≤–∫–∏ —ç—Ç–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞
4. –î–∏—Å–ø–µ—Ç—á–µ—Ä –≤—ã–±–∏—Ä–∞–µ—Ç –Ω—É–∂–Ω—É—é –∏ —Å–º–æ—Ç—Ä–∏—Ç –∏—Å—Ç–æ—Ä–∏—é: `/history 123`

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ —É–¥–∞–ª–µ–Ω–Ω–æ–π –∑–∞—è–≤–∫–∏

1. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: `/deleted`
2. –ù–∞—Ö–æ–¥–∏—Ç –Ω—É–∂–Ω—É—é –∑–∞—è–≤–∫—É –≤ —Å–ø–∏—Å–∫–µ
3. –ù–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "‚úÖ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å" –∏–ª–∏ `/restore_123`
4. –ó–∞—è–≤–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ê–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∑–∞—è–≤–∫–µ

1. –ú–∞—Å—Ç–µ—Ä –≥–æ–≤–æ—Ä–∏—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ–≤–µ—Ä–Ω—ã–µ
2. –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: `/history 456`
3. –í—ã–±–∏—Ä–∞–µ—Ç "üîÑ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π"
4. –í–∏–¥–∏—Ç, –∫—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª –¥–∞–Ω–Ω—ã–µ
5. –°–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–º

---

## üéì –õ—É—á—à–∏–µ –ø—Ä–∞–∫—Ç–∏–∫–∏

### ‚úÖ –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫** –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π –∑–∞—è–≤–∫–∏
2. **–ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –∏—Å—Ç–æ—Ä–∏—é** –ø—Ä–∏ —Å–ø–æ—Ä–Ω—ã—Ö —Å–∏—Ç—É–∞—Ü–∏—è—Ö
3. **–í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ**, –∞ –Ω–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –∑–∞–Ω–æ–≤–æ
4. **–ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–π—Ç–µ –∞—É–¥–∏—Ç** –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–µ–π—Å—Ç–≤–∏–π

### ‚ùå –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è

1. ‚ùå –ù–µ —É–¥–∞–ª—è–π—Ç–µ –∑–∞—è–≤–∫–∏ –±–µ–∑ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏
2. ‚ùå –ù–µ —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –¥—É–±–ª–∏–∫–∞—Ç—ã (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø–æ–∏—Å–∫!)
3. ‚ùå –ù–µ –∏–∑–º–µ–Ω—è–π—Ç–µ –≤–∞–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –∑–∞–ø–∏—Å–∏ –≤ –∑–∞–º–µ—Ç–∫–∞—Ö

---

## üìö –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [PERMANENT_STORAGE_GUIDE.md](./PERMANENT_STORAGE_GUIDE.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- [PERMANENT_STORAGE_EXAMPLES.md](./PERMANENT_STORAGE_EXAMPLES.md) - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
- [QUICKSTART_PERMANENT_STORAGE.md](./QUICKSTART_PERMANENT_STORAGE.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

---

## ‚ùì FAQ

**Q: –ö–∞–∫ –Ω–∞–π—Ç–∏ –∑–∞—è–≤–∫—É, –µ—Å–ª–∏ –ø–æ–º–Ω—é —Ç–æ–ª—å–∫–æ –∏–º—è –∫–ª–∏–µ–Ω—Ç–∞?**
A: `/search –ò–≤–∞–Ω–æ–≤` - –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏

**Q: –ú–æ–∂–Ω–æ –ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞—è–≤–∫—É, —É–¥–∞–ª–µ–Ω–Ω—É—é –º–µ—Å—è—Ü –Ω–∞–∑–∞–¥?**
A: –î–∞! –í—Å–µ —É–¥–∞–ª–µ–Ω–Ω—ã–µ –∑–∞—è–≤–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤–µ—á–Ω–æ. `/deleted` ‚Üí –Ω–∞–π—Ç–∏ ‚Üí –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å

**Q: –ö—Ç–æ –º–æ–∂–µ—Ç –≤–∏–¥–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π?**
A: ADMIN –∏ DISPATCHER –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é

**Q: –°–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–∏ –∏—Å—Ç–æ—Ä–∏—è –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è?**
A: –î–∞! –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é

**Q: –ö–∞–∫ –Ω–∞–π—Ç–∏ –≤—Å–µ –∑–∞—è–≤–∫–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–ª–∏–µ–Ω—Ç–∞?**
A: `/search <—Ç–µ–ª–µ—Ñ–æ–Ω>` –∏–ª–∏ `/search <–∏–º—è>`

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 20.10.2025
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
