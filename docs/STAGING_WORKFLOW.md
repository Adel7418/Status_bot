# üöÄ Staging Workflow: –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –∏ –¥–µ–ø–ª–æ–π

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä workflow](#–æ–±–∑–æ—Ä-workflow)
2. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏–π](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏–π)
3. [–õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞](#–ª–æ–∫–∞–ª—å–Ω–∞—è-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞)
4. [–î–µ–ø–ª–æ–π –≤ Staging](#–¥–µ–ø–ª–æ–π-–≤-staging)
5. [–î–µ–ø–ª–æ–π –≤ Production](#–¥–µ–ø–ª–æ–π-–≤-production)
6. [–ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã](#–±—ã—Å—Ç—Ä—ã–µ-–∫–æ–º–∞–Ω–¥—ã)
7. [Troubleshooting](#troubleshooting)

---

## –û–±–∑–æ—Ä workflow

### –°—Ö–µ–º–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  Local Development  ‚îÇ  ‚Üê –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ –≤ Cursor (–±–µ–∑ Docker)
‚îÇ    (Cursor IDE)     ‚îÇ     - –¢–µ—Å—Ç—ã: make test
‚îÇ                     ‚îÇ     - –õ–∏–Ω—Ç–∏–Ω–≥: make lint
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ git push origin main
           ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   GitHub Repository ‚îÇ  ‚Üê –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
           ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
           ‚îÇ                  ‚îÇ                  ‚îÇ
           ‚îÇ git pull         ‚îÇ git pull         ‚îÇ
           ‚ñº                  ‚ñº                  ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     STAGING     ‚îÇ  ‚îÇ   PRODUCTION    ‚îÇ  ‚îÇ   –î—Ä—É–≥–∏–µ envs   ‚îÇ
‚îÇ  (test token)   ‚îÇ  ‚îÇ  (real token)   ‚îÇ  ‚îÇ                 ‚îÇ
‚îÇ  Test database  ‚îÇ  ‚îÇ  Real database  ‚îÇ  ‚îÇ                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### –ü—Ä–∏–Ω—Ü–∏–ø—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ workflow

‚úÖ **DO (–î–µ–ª–∞—Ç—å):**
- –†–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ –≤ Cursor (–±—ã—Å—Ç—Ä–æ, –±–µ–∑ Docker)
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ staging –ø–µ—Ä–µ–¥ production
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¢–ï–°–¢–û–í–´–ô —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –¥–ª—è staging
- –î–µ–ª–∞—Ç—å –∫–æ–º–º–∏—Ç—ã —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

‚ùå **DON'T (–ù–µ –¥–µ–ª–∞—Ç—å):**
- –ù–ï –¥–µ–ø–ª–æ–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é –≤ production –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–∫–∏
- –ù–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω –¥–ª—è staging –∏ production
- –ù–ï –ø—Ä–æ–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã –ø–µ—Ä–µ–¥ push
- –ù–ï –∑–∞–±—ã–≤–∞—Ç—å –ø—Ä–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

---

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏–π

### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ (Cursor)

```bash
# 1. –°–æ–∑–¥–∞—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
python -m venv venv

# 2. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å (Windows PowerShell)
.\venv\Scripts\Activate.ps1

# 3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements-dev.txt

# 4. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env (—Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –∏–∑ env.example)
cp env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å .env —Å –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ .env –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:**
```env
BOT_TOKEN=your_test_bot_token
ADMIN_IDS=your_telegram_id
DATABASE_PATH=bot_database.db  # –õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î
LOG_LEVEL=DEBUG
ENVIRONMENT=development
```

### 2. Staging –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ staging (–æ–¥–∏–Ω —Ä–∞–∑):**

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip

# –°–æ–∑–¥–∞—Ç—å –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è staging
mkdir -p ~/telegram_repair_bot_staging
cd ~/telegram_repair_bot_staging

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
git clone https://github.com/your-username/telegram_repair_bot.git .

# –°–æ–∑–¥–∞—Ç—å .env.staging (–í–ê–ñ–ù–û: —Å —Ç–µ—Å—Ç–æ–≤—ã–º —Ç–æ–∫–µ–Ω–æ–º!)
cp env.staging.example .env.staging
nano .env.staging  # –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å —Å –¢–ï–°–¢–û–í–´–ú —Ç–æ–∫–µ–Ω–æ–º
```

**–ü—Ä–∏–º–µ—Ä .env.staging:**
```env
BOT_TOKEN=YOUR_TEST_BOT_TOKEN_HERE  # ‚Üê –¢–ï–°–¢–û–í–´–ô —Ç–æ–∫–µ–Ω!
ADMIN_IDS=123456789
DATABASE_PATH=/app/data/bot_database.db
LOG_LEVEL=DEBUG
ENVIRONMENT=staging
REDIS_URL=redis://redis:6379/0
```

**–ó–∞–ø—É—Å–∫ staging:**
```bash
cd docker
docker compose -f docker-compose.staging.yml up -d --build
```

### 3. Production –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

Production —É–∂–µ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–∞–∫–∞—è:

```
/root/telegram_repair_bot/              ‚Üê PRODUCTION
/root/telegram_repair_bot_staging/      ‚Üê STAGING
```

### 4. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ SSH –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö (–ª–æ–∫–∞–ª—å–Ω–æ)

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è —Å–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

```env
# –î–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ –¥–µ–ø–ª–æ—è
SSH_SERVER=root@your-server-ip
STAGING_DIR=~/telegram_repair_bot_staging
PROD_DIR=~/telegram_repair_bot
```

–ò–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –≤ PowerShell:
```powershell
$env:SSH_SERVER="root@your-server-ip"
```

---

## –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π workflow

```bash
# 1. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å –æ–∫—Ä—É–∂–µ–Ω–∏–µ (–µ—Å–ª–∏ –µ—â–µ –Ω–µ –∞–∫—Ç–∏–≤–Ω–æ)
.\venv\Scripts\Activate.ps1

# 2. –ü–æ–ª—É—á–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# 3. –°–¥–µ–ª–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ...

# 4. –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make test

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–∏–Ω—Ç–∏–Ω–≥
make lint

# 6. –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
make run

# 7. –ó–∞—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git add .
git commit -m "feat: –¥–æ–±–∞–≤–ª–µ–Ω–∞ –Ω–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è X"

# 8. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ GitHub
git push origin main
```

### –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

```bash
make help              # –ü–æ–∫–∞–∑–∞—Ç—å –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
make test              # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
make test-cov          # –¢–µ—Å—Ç—ã —Å coverage
make lint              # –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ –ª–∏–Ω—Ç–µ—Ä–∞–º–∏
make format            # –û—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥
make run               # –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
make migrate           # –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
make migrate-create MSG="–æ–ø–∏—Å–∞–Ω–∏–µ"  # –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é
```

---

## –î–µ–ø–ª–æ–π –≤ Staging

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –û–¥–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –¥–µ–ø–ª–æ—è –≤ staging
make staging-deploy
```

–≠—Ç–∞ –∫–æ–º–∞–Ω–¥–∞:
1. ‚úÖ –ü–æ–¥–∫–ª—é—á–∏—Ç—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É –ø–æ SSH
2. ‚úÖ –ü–µ—Ä–µ–π–¥–µ—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é staging
3. ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç `git pull`
4. ‚úÖ –ü–µ—Ä–µ—Å–æ–±–µ—Ä–µ—Ç Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
5. ‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏
6. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç —Å—Ç–∞—Ç—É—Å

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip

# –ü–µ—Ä–µ–π—Ç–∏ –≤ staging –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~/telegram_repair_bot_staging

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
cd docker
docker compose -f docker-compose.staging.yml down
docker compose -f docker-compose.staging.yml up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose -f docker-compose.migrate.yml run --rm migrate

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose -f docker-compose.staging.yml logs -f bot
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ staging

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ staging
make staging-logs

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
ssh root@your-server-ip
cd ~/telegram_repair_bot_staging/docker
docker compose -f docker-compose.staging.yml logs -f bot
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ staging:**
- ‚úÖ –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –í—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å —É—Å–ø–µ—à–Ω–æ
- ‚úÖ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å —Ç–µ—Å—Ç–æ–≤—ã–º –±–æ—Ç–æ–º —Ä–∞–±–æ—Ç–∞–µ—Ç

---

## –î–µ–ø–ª–æ–π –≤ Production

### ‚ö†Ô∏è –í–ê–ñ–ù–û: –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –≤ production

- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ staging
- [ ] –ù–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö staging
- [ ] –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã –≤ staging
- [ ] –°–¥–µ–ª–∞–Ω backup production –ë–î (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ —Å–∫—Ä–∏–ø—Ç–µ)
- [ ] –ï—Å—Ç—å –ø–ª–∞–Ω –æ—Ç–∫–∞—Ç–∞ (git commit hash)

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π

```bash
# –î–µ–ø–ª–æ–π –≤ production (—Å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º!)
make prod-deploy
```

–°–∫—Ä–∏–ø—Ç –ø–æ–ø—Ä–æ—Å–∏—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:
```
‚ö†Ô∏è  –í—ã —Å–æ–±–∏—Ä–∞–µ—Ç–µ—Å—å –æ–±–Ω–æ–≤–∏—Ç—å PRODUCTION –±–æ—Ç–∞!
–í—ã —É–≤–µ—Ä–µ–Ω—ã? –í–≤–µ–¥–∏—Ç–µ 'yes' –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è:
```

–í–≤–µ–¥–∏—Ç–µ `yes` –¥–ª—è –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏—è.

### –†—É—á–Ω–æ–π –¥–µ–ø–ª–æ–π

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip

# –ü–µ—Ä–µ–π—Ç–∏ –≤ production –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~/telegram_repair_bot

# –°–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–º–º–∏—Ç (–¥–ª—è –æ—Ç–∫–∞—Ç–∞)
CURRENT_COMMIT=$(git rev-parse HEAD)
echo "–¢–µ–∫—É—â–∏–π –∫–æ–º–º–∏—Ç: $CURRENT_COMMIT"

# –ü–æ–ª—É—á–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è
git pull origin main

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å
cd docker
docker compose -f docker-compose.prod.yml down
docker compose -f docker-compose.prod.yml up -d --build

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
docker compose -f docker-compose.migrate.yml run --rm migrate

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose -f docker-compose.prod.yml logs -f bot
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ production

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤
make prod-logs

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
make prod-status
```

### –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip
cd ~/telegram_repair_bot

# –û—Ç–∫–∞—Ç–∏—Ç—å—Å—è –Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∫–æ–º–º–∏—Ç
git log --oneline -5  # –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∫–æ–º–º–∏—Ç—ã
git reset --hard <commit-hash>

# –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å
cd docker
docker compose -f docker-compose.prod.yml up -d --build
```

---

## –ë—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã

### –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞
```bash
make test              # –¢–µ—Å—Ç—ã
make lint              # –õ–∏–Ω—Ç–∏–Ω–≥
make format            # –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
make run               # –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
```

### Staging
```bash
make staging-deploy    # –î–µ–ø–ª–æ–π –≤ staging
make staging-logs      # –õ–æ–≥–∏ staging
```

### Production
```bash
make prod-deploy       # –î–µ–ø–ª–æ–π –≤ production
make prod-logs         # –õ–æ–≥–∏ production
make prod-status       # –°—Ç–∞—Ç—É—Å production
```

### Docker (–ª–æ–∫–∞–ª—å–Ω–æ)
```bash
make docker-up         # –ó–∞–ø—É—Å–∫ –ª–æ–∫–∞–ª—å–Ω–æ –≤ Docker
make docker-up-dev     # –ó–∞–ø—É—Å–∫ –≤ dev —Ä–µ–∂–∏–º–µ
make docker-down       # –û—Å—Ç–∞–Ω–æ–≤–∫–∞
make docker-logs       # –õ–æ–≥–∏
make docker-clean      # –û—á–∏—Å—Ç–∫–∞
```

---

## Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: SSH —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
ssh root@your-server-ip "echo 'OK'"

# –ï—Å–ª–∏ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–ª—é—á
ssh-copy-id root@your-server-ip

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –æ–∫—Ä—É–∂–µ–Ω–∏—è
echo $env:SSH_SERVER  # PowerShell
```

### –ü—Ä–æ–±–ª–µ–º–∞: Git pull –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ staging/prod

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# SSH –Ω–∞ —Å–µ—Ä–≤–µ—Ä
ssh root@your-server-ip
cd ~/telegram_repair_bot_staging

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å git
git status

# –ï—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –æ—Ç–∫–∞—Ç–∏—Ç—å –∏—Ö
git reset --hard origin/main

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞
git pull origin main
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω–µ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏
docker compose -f docker-compose.staging.yml logs bot

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å .env —Ñ–∞–π–ª
cat .env.staging

# –ü–µ—Ä–µ—Å–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker compose -f docker-compose.staging.yml down -v
docker compose -f docker-compose.staging.yml up -d --build
```

### –ü—Ä–æ–±–ª–µ–º–∞: –ú–∏–≥—Ä–∞—Ü–∏–∏ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â—É—é –≤–µ—Ä—Å–∏—é –ë–î
docker compose -f docker-compose.migrate.yml run --rm migrate alembic current

# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å—Ç–æ—Ä–∏—é –º–∏–≥—Ä–∞—Ü–∏–π
docker compose -f docker-compose.migrate.yml run --rm migrate alembic history

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Ä—É—á–Ω—É—é
docker compose -f docker-compose.migrate.yml run --rm migrate alembic upgrade head
```

### –ü—Ä–æ–±–ª–µ–º–∞: –î–≤–∞ –±–æ—Ç–∞ –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—Ç (staging –∏ prod)

**–ü—Ä–∏—á–∏–Ω–∞:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–¥–∏–Ω —Ç–æ–∫–µ–Ω –¥–ª—è staging –∏ production.

**–†–µ—à–µ–Ω–∏–µ:** –°–æ–∑–¥–∞–π—Ç–µ –æ—Ç–¥–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –±–æ—Ç–∞ —É @BotFather –∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ —Ç–æ–∫–µ–Ω –≤ `.env.staging`.

---

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [README.md](../README.md) - –û—Å–Ω–æ–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø—Ä–æ–µ–∫—Ç–∞
- [DEPLOYMENT_INSTRUCTIONS.md](deployment/DEPLOYMENT_INSTRUCTIONS.md) - –î–µ—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –¥–µ–ø–ª–æ—é
- [TROUBLESHOOTING.md](TROUBLESHOOTING.md) - –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º
- [DOCKER_USAGE.md](DOCKER_USAGE.md) - –†–∞–±–æ—Ç–∞ —Å Docker

---

## –í–æ–ø—Ä–æ—Å—ã –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–∑–¥–µ–ª [Troubleshooting](#troubleshooting)
2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏: `make staging-logs` –∏–ª–∏ `make prod-logs`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ GitHub Issues –ø—Ä–æ–µ–∫—Ç–∞
4. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π Issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-10-13

