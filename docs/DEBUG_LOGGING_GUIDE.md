# üîç –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ DEBUG –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—é

## üìã –í–∫–ª—é—á–µ–Ω–∏–µ DEBUG —Ä–µ–∂–∏–º–∞

### –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ö–æ—Å—Ç–∞:

1. **–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:**
```bash
DEV_MODE=true
LOG_LEVEL=DEBUG
BOT_TOKEN=your_actual_bot_token
ADMIN_IDS=your_admin_ids
DISPATCHER_IDS=your_dispatcher_ids
```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞:**
```bash
python bot.py
```

### –î–ª—è production (—Å–µ—Ä–≤–µ—Ä–∞):

**–ù–ï –≤–∫–ª—é—á–∞–π—Ç–µ DEBUG —Ä–µ–∂–∏–º!** –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫.

```bash
DEV_MODE=false
LOG_LEVEL=INFO
SENTRY_DSN=your_sentry_dsn_here
```

## üìä –ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤ DEBUG —Ä–µ–∂–∏–º–µ:

### ‚úÖ –û–±—â–∏–µ –æ—à–∏–±–∫–∏:
- User ID –∏ username
- –¢–∏–ø –æ—à–∏–±–∫–∏
- –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∏–ª–∏ callback_data
- –ü–æ–ª–Ω—ã–π traceback
- –ö–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç (DR):
- `[DR] Starting DR process` - –Ω–∞—á–∞–ª–æ –ø—Ä–æ—Ü–µ—Å—Å–∞
- `[DR] Order found` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∑–∞—è–≤–∫–∏
- `[DR] Input text` - –≤–≤–µ–¥–µ–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç
- `[DR] Found prepayment pattern` - –Ω–∞–π–¥–µ–Ω–Ω–∞—è –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞
- `[DR] Parsed - completion_date` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç –ø–∞—Ä—Å–∏–Ω–≥–∞
- `[DR] Updating order` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ë–î
- `[DR] Order updated successfully` - —É—Å–ø–µ—Ö
- `[DR] Sending notification` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- `[DR] ‚úÖ Success` –∏–ª–∏ `[DR] ‚ùå Error` - –∏—Ç–æ–≥

### ‚úÖ –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–æ–≤:
- –ü–æ–ø—ã—Ç–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ (–≥—Ä—É–ø–ø–∞/–ª–∏—á–∫–∞)
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –µ—Å–ª–∏ work_chat_id –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω

## üéØ –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ DR —Ñ—É–Ω–∫—Ü–∏–∏:

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤ DEBUG —Ä–µ–∂–∏–º–µ
2. –°–æ–∑–¥–∞–π—Ç–µ –∑–∞—è–≤–∫—É
3. –ù–∞–∑–Ω–∞—á—å—Ç–µ –º–∞—Å—Ç–µ—Ä–∞
4. –ü—Ä–∏–º–∏—Ç–µ –∑–∞—è–≤–∫—É
5. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç–∞—Ç—É—Å "–ù–∞ –æ–±—ä–µ–∫—Ç–µ"
6. –ù–∞–∂–º–∏—Ç–µ "‚è≥ –î–ª–∏—Ç–µ–ª—å–Ω—ã–π —Ä–µ–º–æ–Ω—Ç"
7. –í–≤–µ–¥–∏—Ç–µ: `20.10.2025 –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 2000`

### –ß—Ç–æ —É–≤–∏–¥–∏—Ç–µ –≤ –ª–æ–≥–∞—Ö:

```
[DR] Starting DR process for order #X by user Y
[DR] Order found: True, Master found: True
[DR] Transitioning to LongRepairStates.enter_completion_date_and_prepayment
[DR] Processing DR info from user Y
[DR] Order ID from state: X, FSM data: {'order_id': X}
[DR] Input text: '20.10.2025 –ø—Ä–µ–¥–æ–ø–ª–∞—Ç–∞ 2000'
[DR] Found prepayment pattern: r'–ø—Ä–µ–¥–æ–ø–ª–∞—Ç[–∞—ã]?\s+(\d+(?:[.,]\d+)?)', value: 2000
[DR] Parsed - completion_date: '20.10.2025', prepayment: 2000.0
[DR] Updating order #X: completion_date='20.10.2025', prepayment=2000.0
[DR] Order #X updated to DR status successfully
[DR] Sending notification to dispatcher Z
[DR] Dispatcher notification sent successfully
[DR] ‚úÖ Order #X successfully marked as DR
[DR] State cleared and DB disconnected for order #X
```

## üìù –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤:

```bash
# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
tail -50 logs/bot.log

# –¢–æ–ª—å–∫–æ DEBUG –ª–æ–≥–∏
grep "DEBUG" logs/bot.log | tail -20

# –¢–æ–ª—å–∫–æ DR –ª–æ–≥–∏
grep "\[DR\]" logs/bot.log | tail -20

# –¢–æ–ª—å–∫–æ –æ—à–∏–±–∫–∏
grep "ERROR\|‚ùå" logs/bot.log | tail -20

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
tail -f logs/bot.log
```

## ‚ö†Ô∏è –í–∞–∂–Ω–æ:

- ‚úÖ DEBUG —Ä–µ–∂–∏–º **–¢–û–õ–¨–ö–û** –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
- ‚ùå **–ù–ï –≤–∫–ª—é—á–∞–π—Ç–µ** DEV_MODE=true –Ω–∞ production —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- ‚úÖ –õ–æ–≥–∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (–º–∞–∫—Å 10MB, 5 —Ñ–∞–π–ª–æ–≤)

## üéâ –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:

- üîç –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞
- üêõ –ë—ã—Å—Ç—Ä–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫
- üìä –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç–µ–∫—Å—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
- üéØ –õ–µ–≥–∫–∞—è –æ—Ç–ª–∞–¥–∫–∞ —Å–ª–æ–∂–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤

