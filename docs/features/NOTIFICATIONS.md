# Система уведомлений

## Обзор

Бот отправляет уведомления различным ролям пользователей при наступлении определенных событий.

## Уведомления о закрытии заявки

Когда мастер завершает заявку (отмечает как выполненную и подтверждает финансовые детали), система рассылает уведомления.

### Получатели

Уведомление о закрытии заявки отправляется:

1. **Всем администраторам** (пользователи с ролью `ADMIN`).
2. **Назначенному диспетчеру** (если он указан в заявке).
3. **Всем диспетчерам** (пользователи с ролью `DISPATCHER`).

### Содержание уведомления

Уведомление содержит:

- Номер заявки.
- Имя мастера.
- Финансовый отчет (общая сумма, материалы, прибыль).
- Распределение прибыли (мастер/компания).
- Наличие отзыва и выезда за город.

### Техническая реализация

Логика отправки находится в `app/handlers/master.py` в функции `process_out_of_city_confirmation_callback`.
Используется метод `db.get_admins_and_dispatchers()` для получения списка получателей.
