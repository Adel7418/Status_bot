# –≠–¢–ê–ü 1: –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã (–ó–ê–í–ï–†–®–Å–ù)

**–î–∞—Ç–∞:** 27 —è–Ω–≤–∞—Ä—è 2025
**–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:** ~1-2 —á–∞—Å–∞
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ó–ê–í–ï–†–®–Å–ù

## –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å Telethon
- **–§–∞–π–ª:** `requirements.txt`
- **–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –î–æ–±–∞–≤–ª–µ–Ω `telethon==1.34.0`
- **–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** Telegram MTProto –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –≥—Ä—É–ø–ø—ã

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è (app/core/config.py)

–î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è Telethon:

```python
# Telethon Parser Configuration
TELETHON_API_ID: int | None              # API ID –æ—Ç my.telegram.org
TELETHON_API_HASH: str                   # API Hash –æ—Ç my.telegram.org
TELETHON_PHONE: str                      # –ù–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
TELETHON_SESSION_NAME: str               # –ò–º—è session —Ñ–∞–π–ª–∞ (default: "parser_session")
PARSER_ENABLED: bool                     # –í–∫–ª—é—á–µ–Ω–∏–µ/–æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–∞—Ä—Å–µ—Ä–∞ (default: false)
```

**–í–∞–ª–∏–¥–∞—Ü–∏—è:** –ï—Å–ª–∏ `PARSER_ENABLED=true`, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö Telethon –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.

### 3. –°–æ–∑–¥–∞–Ω–∞ –º–æ–¥–µ–ª—å ParserConfig

- **–§–∞–π–ª:** `app/database/orm_models.py`
- **–¢–∞–±–ª–∏—Ü–∞:** `parser_config`

**–ü–æ–ª—è:**
- `id` (PK, autoincrement)
- `group_id` (nullable) ‚Äî ID Telegram-–≥—Ä—É–ø–ø—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
- `enabled` (boolean) ‚Äî –≤–∫–ª—é—á–µ–Ω –ª–∏ –ø–∞—Ä—Å–µ—Ä
- `created_at` (timestamp)
- `updated_at` (timestamp, auto-update)

**–ò–Ω–¥–µ–∫—Å:** `idx_parser_config_enabled` –Ω–∞ –ø–æ–ª–µ `enabled`

### 4. –°–æ–∑–¥–∞–Ω–∞ Alembic –º–∏–≥—Ä–∞—Ü–∏—è

- **–§–∞–π–ª:** `migrations/versions/add_parser_config_table.py`
- **Revision ID:** `add_parser_config`
- **–ó–∞–≤–∏—Å–∏—Ç –æ—Ç:** `f9ec1face4e2` (–ø—Ä–µ–¥—ã–¥—É—â–∞—è –º–∏–≥—Ä–∞—Ü–∏—è)

**–î–µ–π—Å—Ç–≤–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:**
- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã `parser_config`
- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ `idx_parser_config_enabled`
- –í—Å—Ç–∞–≤–∫–∞ –¥–µ—Ñ–æ–ª—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ (group_id=NULL, enabled=0)

### 5. –û–±–Ω–æ–≤–ª–µ–Ω .gitignore

–î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–∞–≤–∏–ª–∞ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è Telethon session —Ñ–∞–π–ª–æ–≤:
```gitignore
# Telethon session files (—Å–æ–¥–µ—Ä–∂–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é Telegram)
*.session
*.session-journal
```

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤

```
telegram_repair_bot/
‚îú‚îÄ‚îÄ requirements.txt                               # + telethon==1.34.0
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ config.py                             # + Telethon –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ       ‚îî‚îÄ‚îÄ orm_models.py                         # + ParserConfig –º–æ–¥–µ–ª—å
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îî‚îÄ‚îÄ versions/
‚îÇ       ‚îî‚îÄ‚îÄ add_parser_config_table.py            # NEW –º–∏–≥—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ docs/
‚îÇ   ‚îî‚îÄ‚îÄ implementation/
‚îÇ       ‚îî‚îÄ‚îÄ stage1_infrastructure.md               # NEW —ç—Ç–æ—Ç –æ—Ç—á–µ—Ç
‚îî‚îÄ‚îÄ .gitignore                                     # + *.session –ø—Ä–∞–≤–∏–ª–∞
```

## –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (.env)

–î–ª—è —Ä–∞–±–æ—Ç—ã –ø–∞—Ä—Å–µ—Ä–∞ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `.env`:

```env
# Telethon Parser (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
PARSER_ENABLED=false                # –í–∫–ª—é—á–∏—Ç—å –ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è API credentials
TELETHON_API_ID=12345678            # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞ my.telegram.org
TELETHON_API_HASH=abcdef...         # –ü–æ–ª—É—á–∏—Ç—å –Ω–∞ my.telegram.org
TELETHON_PHONE=+79001234567         # –ù–æ–º–µ—Ä –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
TELETHON_SESSION_NAME=parser_session # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```

**–í–∞–∂–Ω–æ:** –ü–æ–∫–∞ `PARSER_ENABLED=false`, –ø–∞—Ä—Å–µ—Ä –Ω–µ –±—É–¥–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å—Å—è.

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

**–≠–¢–ê–ü 2:** –°–æ–∑–¥–∞–Ω–∏–µ —Å–ª–æ–≤–∞—Ä—è —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π –∏ regex –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
- `app/services/telegram_parser/equipment_dict.py`
- `app/services/telegram_parser/patterns.py`

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –Ω–∞—á–∞–ª—É üü¢

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. ‚ö†Ô∏è **Session —Ñ–∞–π–ª—ã** ‚Äî —Å–æ–¥–µ—Ä–∂–∞—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–æ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ Telegram, –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.gitignore` (‚úÖ —Å–¥–µ–ª–∞–Ω–æ)
2. ‚ö†Ô∏è **API credentials** ‚Äî —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–ª—É—á–∏—Ç—å –Ω–∞ https://my.telegram.org –ø–µ—Ä–µ–¥ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º
3. ‚ö†Ô∏è **–ú–∏–≥—Ä–∞—Ü–∏—è –ë–î** ‚Äî –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–∏–º–µ–Ω–∏—Ç—å: `alembic upgrade head`
4. ‚úÖ **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** ‚Äî –µ—Å–ª–∏ –ø–∞—Ä—Å–µ—Ä –æ—Ç–∫–ª—é—á–µ–Ω (`PARSER_ENABLED=false`), –±–æ—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

- [x] Telethon –¥–æ–±–∞–≤–ª–µ–Ω –≤ requirements.txt
- [x] –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞ (app/core/config.py)
- [x] –ú–æ–¥–µ–ª—å ParserConfig —Å–æ–∑–¥–∞–Ω–∞ (orm_models.py)
- [x] –ú–∏–≥—Ä–∞—Ü–∏—è Alembic —Å–æ–∑–¥–∞–Ω–∞
- [x] .gitignore –æ–±–Ω–æ–≤–ª–µ–Ω
- [x] –û—Ç—á—ë—Ç —Å–æ–∑–¥–∞–Ω

---

**–ê–≤—Ç–æ—Ä:** Claude Code Sonnet
**–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:** ~1.5 —á–∞—Å–∞
**–°–ª–µ–¥—É—é—â–∏–π —ç—Ç–∞–ø:** –≠–¢–ê–ü 2 (—Å–ª–æ–≤–∞—Ä—å —Å–æ–∫—Ä–∞—â–µ–Ω–∏–π + regex –ø–∞—Ç—Ç–µ—Ä–Ω—ã)
