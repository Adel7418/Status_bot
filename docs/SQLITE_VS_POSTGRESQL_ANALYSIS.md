# SQLite vs PostgreSQL - –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–π –∞–Ω–∞–ª–∏–∑

**–í–æ–ø—Ä–æ—Å:** –ù–∞—Å–∫–æ–ª—å–∫–æ –∫—Ä–∏—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ SQLite? –ö–æ–≥–¥–∞ –±—É–¥—É—Ç –ø—Ä–æ–±–ª–µ–º—ã?

**–ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç:** –ó–∞–≤–∏—Å–∏—Ç –æ—Ç **–Ω–∞–≥—Ä—É–∑–∫–∏** –∏ **—Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏**. –î–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞ SQLite –º–æ–∂–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –≥–æ–¥–∞–º–∏, –¥–ª—è –∫—Ä—É–ø–Ω–æ–≥–æ - –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞—á–Ω—É—Ç—Å—è —á–µ—Ä–µ–∑ –Ω–µ–¥–µ–ª—é.

---

## üìä –ö–æ–≥–¥–∞ SQLite –î–û–°–¢–ê–¢–û–ß–ù–û

### ‚úÖ –í–∞—à —Å–ª—É—á–∞–π –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è SQLite –µ—Å–ª–∏:

**–ù–∞–≥—Ä—É–∑–∫–∞:**
- ‚â§ 5 –º–∞—Å—Ç–µ—Ä–æ–≤
- ‚â§ 20-30 –∑–∞—è–≤–æ–∫ –≤ –¥–µ–Ω—å
- ‚â§ 3-5 –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ –±–æ—Ç–µ
- –ü–∏–∫–æ–≤–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞: ‚â§ 10 –æ–ø–µ—Ä–∞—Ü–∏–π/—Å–µ–∫—É–Ω–¥—É

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- Downtime 30-60 –º–∏–Ω—É—Ç –≤ –º–µ—Å—è—Ü - –ø—Ä–∏–µ–º–ª–µ–º
- –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ 1 —á–∞—Å (RPO) - –ø—Ä–∏–µ–º–ª–µ–º–∞
- Backup —Ä–∞–∑ –≤ –¥–µ–Ω—å - –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ
- –û–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä (–Ω–µ—Ç –≥–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–æ–π —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏)

**–ï—Å–ª–∏ –î–ê –Ω–∞ –≤—Å—ë** ‚Üí SQLite –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å **–≥–æ–¥–∞–º–∏ –±–µ–∑ –ø—Ä–æ–±–ª–µ–º** ‚úÖ

---

## ‚ö†Ô∏è –ö–æ–≥–¥–∞ –Ω–∞—á–Ω—É—Ç—Å—è –ü–†–û–ë–õ–ï–ú–´ —Å–æ SQLite

### –ü—Ä–æ–±–ª–µ–º–∞ 1: Lock Contention (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏)

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: > 5-7
–°–∏–º–ø—Ç–æ–º—ã:
- "database is locked" –æ—à–∏–±–∫–∏
- –ó–∞–¥–µ—Ä–∂–∫–∏ 1-5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–ø—Ä–æ—Å–∞—Ö
- Timeout –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –∑–∞—è–≤–æ–∫
```

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞:**
- **1-3 –º–∞—Å—Ç–µ—Ä–∞:** –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—Ä–æ—è–≤–∏—Ç—Å—è
- **5-10 –º–∞—Å—Ç–µ—Ä–æ–≤:** –†–µ–¥–∫–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (1-2 —Ä–∞–∑–∞ –≤ –Ω–µ–¥–µ–ª—é)
- **15+ –º–∞—Å—Ç–µ—Ä–æ–≤:** –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (–∫–∞–∂–¥—ã–π —á–∞—Å)

**–ü—Ä–∏–º–µ—Ä —Å—Ü–µ–Ω–∞—Ä–∏—è:**
```
10:00 - –î–∏—Å–ø–µ—Ç—á–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –∑–∞—è–≤–∫—É (WRITE lock)
10:00 - –ú–∞—Å—Ç–µ—Ä 1 –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—Ç–∞—Ç—É—Å (–∂–¥—ë—Ç lock)
10:00 - –ú–∞—Å—Ç–µ—Ä 2 —á–∏—Ç–∞–µ—Ç –∑–∞—è–≤–∫–∏ (–∂–¥—ë—Ç lock)
10:01 - Scheduler –ø—Ä–æ–≤–µ—Ä—è–µ—Ç SLA (–∂–¥—ë—Ç lock)
‚Üí –û—á–µ—Ä–µ–¥—å, –∑–∞–¥–µ—Ä–∂–∫–∏, timeout
```

**–í–∞—à–∞ –∑–∞—â–∏—Ç–∞:**
- ‚úÖ WAL mode –≤–∫–ª—é—á—ë–Ω (–ø–æ–º–æ–≥–∞–µ—Ç –¥–ª—è —á—Ç–µ–Ω–∏—è)
- ‚ö†Ô∏è –ù–æ –Ω–µ —Å–ø–∞—Å–∞–µ—Ç –ø—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å—è—Ö

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏/failover

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–°–æ–±—ã—Ç–∏–µ: –°–±–æ–π –¥–∏—Å–∫–∞, corrupted DB —Ñ–∞–π–ª
–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:
- –ë–æ—Ç –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω
- –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä—è–Ω—ã (–µ—Å–ª–∏ –Ω–µ—Ç backup)
- Recovery time: 1-4 —á–∞—Å–∞ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup)
```

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:**
- **SSD –¥–∏—Å–∫, RAID:** 1 —Ä–∞–∑ –≤ 2-3 –≥–æ–¥–∞
- **HDD –¥–∏—Å–∫, –±–µ–∑ RAID:** 1 —Ä–∞–∑ –≤ 6-12 –º–µ—Å—è—Ü–µ–≤
- **VPS (–¥–µ—à—ë–≤—ã–π):** 1 —Ä–∞–∑ –≤ 3-6 –º–µ—Å—è—Ü–µ–≤

**–í–∞—à–∞ –∑–∞—â–∏—Ç–∞:**
- ‚úÖ –ï—Å—Ç—å —Å–∫—Ä–∏–ø—Ç backup (`scripts/backup_db.py`)
- ‚ùå –ù–æ –Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö backups –ø–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—é
- ‚ùå –ù–µ—Ç real-time —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏

**–°—Ü–µ–Ω–∞—Ä–∏–π –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ—ã:**
```
15:00 - –ü–æ—Å–ª–µ–¥–Ω–∏–π backup (—É—Ç—Ä–æ)
16:00 - 50 –Ω–æ–≤—ã—Ö –∑–∞—è–≤–æ–∫ –∑–∞ –¥–µ–Ω—å
17:00 - –î–∏—Å–∫ —Å–ª–æ–º–∞–ª—Å—è
‚Üí –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ 2 —á–∞—Å–∞ (50 –∑–∞—è–≤–æ–∫)
‚Üí –ù–µ–¥–æ–≤–æ–ª—å–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã, —Ä–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏
```

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ù–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö > 1 GB:
- –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (scan –≤–º–µ—Å—Ç–æ index seek)
- –ü–∞–º—è—Ç—å: SQLite –∑–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å—ë –≤ RAM

–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö > 5 GB:
- –û—á–µ–Ω—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (> 1 —Å–µ–∫)
- OOM (Out of Memory) –≤–æ–∑–º–æ–∂–µ–Ω
```

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –ø–æ —Ä–∞–∑–º–µ—Ä—É –ë–î:**

| –ó–∞—è–≤–æ–∫ | –†–∞–∑–º–µ—Ä –ë–î | –ü—Ä–æ–±–ª–µ–º—ã |
|--------|-----------|----------|
| 1,000 | ~10 MB | –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º ‚úÖ |
| 10,000 | ~100 MB | –í—Å—ë —Ö–æ—Ä–æ—à–æ ‚úÖ |
| 50,000 | ~500 MB | –ú–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã ‚ö†Ô∏è |
| 100,000 | ~1 GB | –°–µ—Ä—å—ë–∑–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã ‚ùå |
| 500,000+ | ~5 GB+ | –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã ‚ùå‚ùå |

**–°–∫–æ—Ä–æ—Å—Ç—å —Ä–æ—Å—Ç–∞:**
- 10 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å ‚Üí 1,000 –∑–∞—è–≤–æ–∫ –∑–∞ ~3 –º–µ—Å—è—Ü–∞
- 50 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å ‚Üí 10,000 –∑–∞—è–≤–æ–∫ –∑–∞ ~6 –º–µ—Å—è—Ü–µ–≤
- 100 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å ‚Üí 50,000 –∑–∞—è–≤–æ–∫ –∑–∞ ~1.5 –≥–æ–¥–∞

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ù–µ—Ç concurrent writers

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ WRITE –æ–ø–µ—Ä–∞—Ü–∏–∏:
- –¢–æ–ª—å–∫–æ 1 writer –∑–∞ —Ä–∞–∑
- –î—Ä—É–≥–∏–µ –∂–¥—É—Ç –≤ –æ—á–µ—Ä–µ–¥–∏

–ö—Ä–∏—Ç–∏—á–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π:
- 5 –º–∞—Å—Ç–µ—Ä–æ–≤ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—é—Ç –∑–∞—è–≤–∫–∏
- Scheduler –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ—Ç—á—ë—Ç (—Ç—è–∂—ë–ª—ã–π write)
- –î–∏—Å–ø–µ—Ç—á–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É
‚Üí –í—Å–µ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è, timeout 30 —Å–µ–∫—É–Ω–¥
```

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:**
- **< 5 –º–∞—Å—Ç–µ—Ä–æ–≤:** –ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞
- **10-15 –º–∞—Å—Ç–µ—Ä–æ–≤:** 1-2 —Ä–∞–∑–∞ –≤ –¥–µ–Ω—å (–ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã)
- **20+ –º–∞—Å—Ç–µ—Ä–æ–≤:** –ü–æ—Å—Ç–æ—è–Ω–Ω–æ (–∫–∞–∂–¥—ã–µ 10 –º–∏–Ω—É—Ç)

---

## üìà –†–ï–ê–õ–ò–°–¢–ò–ß–ù–ê–Ø –≤—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞ –ø—Ä–æ–±–ª–µ–º

### –ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å (2-5 –º–∞—Å—Ç–µ—Ä–æ–≤, 10-20 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           TIMELINE –î–õ–Ø –ú–ê–õ–û–ì–û –ë–ò–ó–ù–ï–°–ê               ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ú–µ—Å—è—Ü 1-6:   ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º                    ‚îÇ
‚îÇ –ú–µ—Å—è—Ü 6-12:  ‚úÖ –í—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç —Å—Ç–∞–±–∏–ª—å–Ω–æ             ‚îÇ
‚îÇ –ì–æ–¥ 1-2:     ‚úÖ –†–µ–¥–∫–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (—Ä–∞–∑ –≤ –Ω–µ–¥–µ–ª—é)   ‚îÇ
‚îÇ –ì–æ–¥ 2-3:     ‚ö†Ô∏è –ë–î ~100-200 MB, –º–µ–¥–ª–µ–Ω–Ω–µ–µ          ‚îÇ
‚îÇ –ì–æ–¥ 3+:      ‚ö†Ô∏è –°—Ç–æ–∏—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–í–µ—Ä–¥–∏–∫—Ç: SQLite –ü–û–î–•–û–î–ò–¢ ‚úÖ
–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL: –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û (–º–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å)
```

### –°—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å (10-20 –º–∞—Å—Ç–µ—Ä–æ–≤, 50-100 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ          TIMELINE –î–õ–Ø –°–†–ï–î–ù–ï–ì–û –ë–ò–ó–ù–ï–°–ê              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ú–µ—Å—è—Ü 1-3:   ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –Ω–æ—Ä–º–∞–ª—å–Ω–æ                 ‚îÇ
‚îÇ –ú–µ—Å—è—Ü 3-6:   ‚ö†Ô∏è –†–µ–¥–∫–∏–µ "database locked" (1-2/–¥–µ–Ω—å)‚îÇ
‚îÇ –ú–µ—Å—è—Ü 6-12:  ‚ùå –ß–∞—Å—Ç—ã–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ (10-20/–¥–µ–Ω—å)     ‚îÇ
‚îÇ –ì–æ–¥ 1:       ‚ùå –ë–î ~500 MB, –º–µ–¥–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã      ‚îÇ
‚îÇ –ì–æ–¥ 1+:      ‚ùå –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∫–∞–∂–¥—ã–π –¥–µ–Ω—å     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–í–µ—Ä–¥–∏–∫—Ç: SQLite –ù–ï –ü–û–î–•–û–î–ò–¢ ‚ùå
–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL: –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê —á–µ—Ä–µ–∑ 3-6 –º–µ—Å—è—Ü–µ–≤
```

### –ö—Ä—É–ø–Ω—ã–π –±–∏–∑–Ω–µ—Å (30+ –º–∞—Å—Ç–µ—Ä–æ–≤, 200+ –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           TIMELINE –î–õ–Ø –ö–†–£–ü–ù–û–ì–û –ë–ò–ó–ù–ï–°–ê             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ –ù–µ–¥–µ–ª—è 1:    ‚ö†Ô∏è –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –ø–∏–∫–æ–≤—ã–µ —á–∞—Å—ã          ‚îÇ
‚îÇ –ú–µ—Å—è—Ü 1:     ‚ùå –ü–æ—Å—Ç–æ—è–Ω–Ω—ã–µ timeout                 ‚îÇ
‚îÇ –ú–µ—Å—è—Ü 2:     ‚ùå –ë–æ—Ç –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–µ—Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–í–µ—Ä–¥–∏–∫—Ç: SQLite –ö–†–ò–¢–ò–ß–ù–û –ù–ï –ü–û–î–•–û–î–ò–¢ ‚ùå‚ùå
–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ PostgreSQL: –ù–ï–ú–ï–î–õ–ï–ù–ù–û
```

---

## üí° –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –í–ê–®–£ –Ω–∞–≥—Ä—É–∑–∫—É

### –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏:

```bash
# 1. –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–∞—Å—Ç–µ—Ä–æ–≤
sqlite3 bot_database.db "SELECT COUNT(*) FROM masters WHERE is_approved = 1 AND is_active = 1;"

# 2. –ó–∞—è–≤–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü
sqlite3 bot_database.db "SELECT COUNT(*) FROM orders WHERE created_at > datetime('now', '-30 days');"

# 3. –ó–∞—è–≤–æ–∫ –≤ –¥–µ–Ω—å (—Å—Ä–µ–¥–Ω)
sqlite3 bot_database.db "SELECT COUNT(*) / 30.0 FROM orders WHERE created_at > datetime('now', '-30 days');"

# 4. –†–∞–∑–º–µ—Ä –ë–î
ls -lh bot_database.db  # Linux/Mac
dir bot_database.db      # Windows

# 5. –ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã (–∫–æ–≥–¥–∞ –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ –∑–∞—è–≤–æ–∫)
sqlite3 bot_database.db "SELECT strftime('%H', created_at) as hour, COUNT(*) as count FROM orders WHERE created_at > datetime('now', '-7 days') GROUP BY hour ORDER BY count DESC LIMIT 3;"
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –î–õ–Ø –í–ê–°

### –í–∞—Ä–∏–∞–Ω—Ç A: –ú–∞–ª—ã–π/–°—Ä–µ–¥–Ω–∏–π –±–∏–∑–Ω–µ—Å (< 10 –º–∞—Å—Ç–µ—Ä–æ–≤)

**–ú–û–ñ–ù–û –æ—Å—Ç–∞–≤–∏—Ç—å SQLite** —Å —É—Å–ª–æ–≤–∏—è–º–∏:

‚úÖ **–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç—ã:**
```bash
# 1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
crontab -e
0 */6 * * * cd /app && python scripts/backup_db.py

# 2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
# –î–æ–±–∞–≤–∏—Ç—å –≤ scheduler (bot.py):
@scheduler.add_job(interval=timedelta(hours=24))
async def check_db_size():
    size = os.path.getsize('bot_database.db')
    if size > 500 * 1024 * 1024:  # > 500 MB
        # Alert –∞–¥–º–∏–Ω–∞–º: –ø–æ—Ä–∞ –Ω–∞ PostgreSQL
        pass

# 3. –£–≤–µ–ª–∏—á–∏—Ç—å timeout –¥–ª—è SQLite
# –í db.py:
self.connection = await aiosqlite.connect(
    self.db_path,
    timeout=30.0  # –í–º–µ—Å—Ç–æ default 5.0
)
```

‚úÖ **–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ:**
- –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å PostgreSQL setup (docker-compose)
- –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ –∫–æ–ø–∏–∏ –ë–î
- –ö–æ–≥–¥–∞ –ë–î > 100 MB –∏–ª–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ > 5/–¥–µ–Ω—å ‚Üí –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å

**Timeline:** –ú–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å –Ω–∞ **6-12 –º–µ—Å—è—Ü–µ–≤**

---

### –í–∞—Ä–∏–∞–Ω—Ç B: –°—Ä–µ–¥–Ω–∏–π/–ö—Ä—É–ø–Ω—ã–π –±–∏–∑–Ω–µ—Å (> 10 –º–∞—Å—Ç–µ—Ä–æ–≤)

**–ù–£–ñ–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL** –≤ —Ç–µ—á–µ–Ω–∏–µ **1-3 –º–µ—Å—è—Ü–µ–≤**

**–ü—Ä–∏–∑–Ω–∞–∫–∏ —á—Ç–æ –ø–æ—Ä–∞ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –°–ï–ô–ß–ê–°:**
- ‚úÖ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ > 10 –º–∞—Å—Ç–µ—Ä–æ–≤
- ‚úÖ –ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ > 50 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å
- ‚úÖ –ù—É–∂–µ–Ω uptime > 99%
- ‚úÖ –ö—Ä–∏—Ç–∏—á–Ω–æ –Ω–µ —Ç–µ—Ä—è—Ç—å –¥–∞–Ω–Ω—ã–µ (—Ñ–∏–Ω–∞–Ω—Å—ã!)
- ‚úÖ –†–∞—Å—Ç—ë—Ç–µ –±—ã—Å—Ç—Ä–æ (–º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ)

**Timeline:** **1-3 –º–µ—Å—è—Ü–∞** (–ø–æ–∫–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ –ª—É—á—à–µ —Å–¥–µ–ª–∞—Ç—å –∑–∞—Ä–∞–Ω–µ–µ)

---

### –í–∞—Ä–∏–∞–Ω—Ç C: Enterprise

**–ö–†–ò–¢–ò–ß–ù–û –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –ù–ï–ú–ï–î–õ–ï–ù–ù–û** –µ—Å–ª–∏:
- ‚ùå > 20 –º–∞—Å—Ç–µ—Ä–æ–≤
- ‚ùå > 100 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å
- ‚ùå –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–∫—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ)
- ‚ùå SLA 99.9% uptime
- ‚ùå –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç—å

**Timeline:** **–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ** (–±–ª–æ–∫–µ—Ä –¥–ª—è production)

---

## üî¥ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã SQLite

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Database is locked" (—Å–∞–º–∞—è —á–∞—Å—Ç–∞—è)

**–ö–æ–¥ –æ—à–∏–±–∫–∏:**
```python
sqlite3.OperationalError: database is locked
```

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–∏–∫–æ–≤—ã–µ —á–∞—Å—ã (9-11 —É—Ç—Ä–∞, 17-19 –≤–µ—á–µ—Ä–∞)
- 3 –º–∞—Å—Ç–µ—Ä–∞ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∑–∞—è–≤–∫–∏
- –î–∏—Å–ø–µ—Ç—á–µ—Ä —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—É—é –∑–∞—è–≤–∫—É
- APScheduler –ø—Ä–æ–≤–µ—Ä—è–µ—Ç SLA
‚Üí Lock timeout —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
‚Üí –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç: "‚ùå –û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö"

–°—Ü–µ–Ω–∞—Ä–∏–π 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤
- –ê–¥–º–∏–Ω –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–π –æ—Ç—á—ë—Ç (heavy query)
- –ú–∞—Å—Ç–µ—Ä –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–∫—Ä—ã—Ç—å –∑–∞—è–≤–∫—É
‚Üí Lock –Ω–∞ 10-30 —Å–µ–∫—É–Ω–¥
‚Üí Telegram timeout
```

**–ß–∞—Å—Ç–æ—Ç–∞:**
- **< 5 –º–∞—Å—Ç–µ—Ä–æ–≤:** –ü–æ—á—Ç–∏ –Ω–∏–∫–æ–≥–¥–∞ (< 1 —Ä–∞–∑ –≤ –º–µ—Å—è—Ü)
- **10 –º–∞—Å—Ç–µ—Ä–æ–≤:** 1-5 —Ä–∞–∑ –≤ –¥–µ–Ω—å
- **20 –º–∞—Å—Ç–µ—Ä–æ–≤:** 50+ —Ä–∞–∑ –≤ –¥–µ–Ω—å

**–í–∞—à–∞ –∑–∞—â–∏—Ç–∞:**
- ‚úÖ WAL mode –≤–∫–ª—é—á—ë–Ω (—á–∏—Ç–∞—Ç–µ–ª–∏ –Ω–µ –±–ª–æ–∫–∏—Ä—É—é—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞)
- ‚ö†Ô∏è –ù–æ –ø–∏—Å–∞—Ç–µ–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –ù–µ—Ç —Ä–µ–ø–ª–∏–∫–∞—Ü–∏–∏ ‚Üí Single Point of Failure

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
–°–æ–±—ã—Ç–∏–µ: Corrupted database file
–ü—Ä–∏—á–∏–Ω—ã:
- –í–Ω–µ–∑–∞–ø–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ –ø–∏—Ç–∞–Ω–∏—è (VPS crashed)
- –î–∏—Å–∫ —É–º–µ—Ä (hardware failure)
- rm bot_database.db (—á–µ–ª–æ–≤–µ—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞)
- –í–∏—Ä—É—Å/ransomware
```

**–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å:**
- **Cloud VPS (AWS/Azure/GCP):** 0.1% –≤ –≥–æ–¥ (1 —Ä–∞–∑ –≤ 10 –ª–µ—Ç)
- **–î–µ—à—ë–≤—ã–π VPS:** 1-5% –≤ –≥–æ–¥ (1 —Ä–∞–∑ –≤ 1-5 –ª–µ—Ç)
- **–î–æ–º–∞—à–Ω–∏–π —Å–µ—Ä–≤–µ—Ä:** 5-10% –≤ –≥–æ–¥ (1 —Ä–∞–∑ –≤ 1-2 –≥–æ–¥–∞)

**–ü–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è:**
```
–ë–µ–∑ backup:
‚ùå –ü–æ—Ç–µ—Ä—è –í–°–ï–• –¥–∞–Ω–Ω—ã—Ö
‚ùå –ü–æ—Ç–µ—Ä—è –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫
‚ùå –ü–æ—Ç–µ—Ä—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ–π –∏—Å—Ç–æ—Ä–∏–∏
‚ùå –ë–∏–∑–Ω–µ—Å –ø–∞—Ä–∞–ª–∏–∑–æ–≤–∞–Ω

–° backup (1 —Ä–∞–∑ –≤ –¥–µ–Ω—å):
‚ö†Ô∏è –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 0-24 —á–∞—Å–∞
‚ö†Ô∏è Downtime 1-4 —á–∞—Å–∞ (–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ)
```

**PostgreSQL —Ä–µ—à–∞–µ—Ç:**
- ‚úÖ –†–µ–ø–ª–∏–∫–∞—Ü–∏—è (master-slave)
- ‚úÖ Point-in-time recovery
- ‚úÖ –ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö < 1 —Å–µ–∫—É–Ω–¥—ã

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: Performance degradation

**–í—Ä–µ–º–µ–Ω–Ω–∞—è —à–∫–∞–ª–∞:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         –î–ï–ì–†–ê–î–ê–¶–ò–Ø –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–ò              ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ 0-1,000 –∑–∞—è–≤–æ–∫:    Response < 50ms   ‚úÖ –û—Ç–ª–∏—á–Ω–æ   ‚îÇ
‚îÇ 1,000-10,000:      Response < 200ms  ‚úÖ –•–æ—Ä–æ—à–æ    ‚îÇ
‚îÇ 10,000-50,000:     Response 500ms-1s ‚ö†Ô∏è –ú–µ–¥–ª–µ–Ω–Ω–æ  ‚îÇ
‚îÇ 50,000-100,000:    Response 1-3s     ‚ùå –ü–ª–æ—Ö–æ     ‚îÇ
‚îÇ 100,000+:          Response > 5s     ‚ùå –ö—Ä–∏—Ç–∏—á–Ω–æ  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

–ü—Ä–∏ 20 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å ‚Üí 50,000 –∑–∞—è–≤–æ–∫ –∑–∞ ~7 –ª–µ—Ç
–ü—Ä–∏ 100 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å ‚Üí 50,000 –∑–∞—è–≤–æ–∫ –∑–∞ ~1.5 –≥–æ–¥–∞
```

**–ü—Ä–∏–º–µ—Ä:**
```python
# –ü—Ä–∏ 50,000+ –∑–∞—è–≤–∫–∞—Ö
await db.get_all_orders()  # –ë–ï–ó –ª–∏–º–∏—Ç–∞
‚Üí 5-10 —Å–µ–∫—É–Ω–¥ –æ–∂–∏–¥–∞–Ω–∏—è
‚Üí Telegram timeout (10 —Å–µ–∫)
‚Üí ‚ùå –û—à–∏–±–∫–∞ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```

**–í–∞—à–∞ –∑–∞—â–∏—Ç–∞:**
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã —Å–æ–∑–¥–∞–Ω—ã
- ‚ö†Ô∏è –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (P2-8)
- ‚ö†Ô∏è `get_all_orders()` –±–µ–∑ LIMIT

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: WAL —Ñ–∞–π–ª —Ä–∞—Å—Ç—ë—Ç

**–ö–æ–≥–¥–∞ –ø—Ä–æ—è–≤–∏—Ç—Å—è:**
```
WAL mode –≤–∫–ª—é—á—ë–Ω ‚Üí —Å–æ–∑–¥–∞—é—Ç—Å—è —Ñ–∞–π–ª—ã:
- bot_database.db
- bot_database.db-wal (Write-Ahead Log)
- bot_database.db-shm (Shared Memory)

–ü—Ä–æ–±–ª–µ–º–∞: WAL —Ñ–∞–π–ª –º–æ–∂–µ—Ç –≤—ã—Ä–∞—Å—Ç–∏ –¥–æ > 1 GB
```

**–ö–æ–≥–¥–∞:**
- –ú–Ω–æ–≥–æ –∑–∞–ø–∏—Å–µ–π –±–µ–∑ checkpoint
- Long-running transactions
- –ù–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏

**–í–∞—à–∞ —Å–∏—Ç—É–∞—Ü–∏—è:**
```bash
ls -lh bot_database.db*

# –í–µ—Ä–æ—è—Ç–Ω–æ —Å–µ–π—á–∞—Å:
bot_database.db      10 MB
bot_database.db-wal  500 KB  # –ù–æ—Ä–º–∞
bot_database.db-shm  32 KB   # –ù–æ—Ä–º–∞

# –ß–µ—Ä–µ–∑ –≥–æ–¥ –ø—Ä–∏ –∞–∫—Ç–∏–≤–Ω–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏:
bot_database.db      200 MB
bot_database.db-wal  50 MB   ‚ö†Ô∏è –ú–Ω–æ–≥–æ
bot_database.db-shm  32 KB
```

**–†–µ—à–µ–Ω–∏–µ –¥–ª—è SQLite:**
```python
# –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–π checkpoint
async def cleanup_wal():
    await db.connection.execute("PRAGMA wal_checkpoint(TRUNCATE)")
```

---

## üí∞ –§–∏–Ω–∞–Ω—Å–æ–≤—ã–π —Ä–∏—Å–∫

### –°—Ü–µ–Ω–∞—Ä–∏–π –ø–æ—Ç–µ—Ä–∏ –¥–∞–Ω–Ω—ã—Ö

**–ë–µ–∑ PostgreSQL:**
```
–°–æ–±—ã—Ç–∏–µ: Corrupted DB (1 —Ä–∞–∑ –≤ 1-2 –≥–æ–¥–∞)
Backup: –ü–æ—Å–ª–µ–¥–Ω–∏–π 12 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
–ü–æ—Ç–µ—Ä—è: 20 –∑–∞—è–≤–æ–∫ –∑–∞ 12 —á–∞—Å–æ–≤

–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏:
- 20 –∑–∞—è–≤–æ–∫ √ó 5,000‚ÇΩ —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫ = 100,000‚ÇΩ
- –†–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ –ø–æ—Ç–µ—Ä–∏: ~50,000‚ÇΩ
- –í—Ä–µ–º—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è: 4 —á–∞—Å–∞ √ó 2 —á–µ–ª–æ–≤–µ–∫–∞ = 8 —á–∞—Å–æ–≤

–ò–¢–û–ì–û: ~150,000‚ÇΩ —É–±—ã—Ç–∫–æ–≤
```

**–° PostgreSQL + —Ä–µ–ø–ª–∏–∫–∞—Ü–∏—è:**
```
–°–æ–±—ã—Ç–∏–µ: Primary DB crashed
Failover: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞ replica (30 —Å–µ–∫)
–ü–æ—Ç–µ—Ä—è –¥–∞–Ω–Ω—ã—Ö: 0-1 —Å–µ–∫—É–Ω–¥–∞ (WAL streaming)

–§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –ø–æ—Ç–µ—Ä–∏: ~0‚ÇΩ
```

**ROI –∞–Ω–∞–ª–∏–∑:**
```
–°—Ç–æ–∏–º–æ—Å—Ç—å PostgreSQL setup:
- –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞: 3 –¥–Ω—è √ó 10,000‚ÇΩ/–¥–µ–Ω—å = 30,000‚ÇΩ
- VPS (PostgreSQL): +2,000‚ÇΩ/–º–µ—Å—è—Ü
- –ò—Ç–æ–≥–æ –∑–∞ –≥–æ–¥: 30,000‚ÇΩ + 24,000‚ÇΩ = 54,000‚ÇΩ

–≠–∫–æ–Ω–æ–º–∏—è –æ—Ç –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è 1 –∏–Ω—Ü–∏–¥–µ–Ω—Ç–∞: 150,000‚ÇΩ

ROI: 150,000‚ÇΩ / 54,000‚ÇΩ = 2.8x (–æ–∫—É–ø–∞–µ—Ç—Å—è —Å –ø–µ—Ä–≤—ã–º –∏–Ω—Ü–∏–¥–µ–Ω—Ç–æ–º)
```

---

## üéØ –ò–¢–û–ì–û–í–ê–Ø –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–Ø

### –î–ª—è –í–ê–®–ï–ì–û –ø—Ä–æ–µ–∫—Ç–∞:

**–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:**
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã:
sqlite3 bot_database.db "SELECT COUNT(*) FROM masters WHERE is_active = 1;"
sqlite3 bot_database.db "SELECT COUNT(*) FROM orders WHERE created_at > datetime('now', '-30 days');"
ls -lh bot_database.db
```

**–ï—Å–ª–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**

#### ‚úÖ –ú–æ–∂–Ω–æ –û–¢–õ–û–ñ–ò–¢–¨ –º–∏–≥—Ä–∞—Ü–∏—é (6-12 –º–µ—Å—è—Ü–µ–≤):
- –ú–∞—Å—Ç–µ—Ä–æ–≤: < 5
- –ó–∞—è–≤–æ–∫/–º–µ—Å—è—Ü: < 300
- –†–∞–∑–º–µ—Ä –ë–î: < 50 MB
- –†–æ—Å—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–π

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup (–∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤)
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Ä–∞–∑–º–µ—Ä–∞ –ë–î
3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –±—É–¥—É—â–µ–µ
4. **–§–æ–∫—É—Å –Ω–∞ P0-4 (Rate Limiting)** - —ç—Ç–æ –∫—Ä–∏—Ç–∏—á–Ω–µ–µ!

#### ‚ö†Ô∏è –ù—É–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –í –¢–ï–ß–ï–ù–ò–ï 3 –ú–ï–°–Ø–¶–ï–í:
- –ú–∞—Å—Ç–µ—Ä–æ–≤: 5-15
- –ó–∞—è–≤–æ–∫/–º–µ—Å—è—Ü: 300-1500
- –†–∞–∑–º–µ—Ä –ë–î: 50-200 MB
- –ê–∫—Ç–∏–≤–Ω—ã–π —Ä–æ—Å—Ç

**–î–µ–π—Å—Ç–≤–∏—è:**
1. –ó–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π sprint
2. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å PostgreSQL –≤ docker-compose
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ staging
4. –ú–∏–≥—Ä–∞—Ü–∏—è –≤ –≤—ã—Ö–æ–¥–Ω–æ–π –¥–µ–Ω—å

#### ‚ùå –ù—É–∂–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –°–†–û–ß–ù–û (1-2 –Ω–µ–¥–µ–ª–∏):
- –ú–∞—Å—Ç–µ—Ä–æ–≤: > 15
- –ó–∞—è–≤–æ–∫/–º–µ—Å—è—Ü: > 1500
- –†–∞–∑–º–µ—Ä –ë–î: > 200 MB
- –£–∂–µ –µ—Å—Ç—å "database locked" –æ—à–∏–±–∫–∏

**–î–µ–π—Å—Ç–≤–∏—è:**
1. **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç P0!** –í—ã—à–µ —á–µ–º –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏
2. –í—ã–¥–µ–ª–∏—Ç—å —Ä–µ—Å—É—Ä—Å—ã –Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—é
3. –ú–∏–≥—Ä–∞—Ü–∏—è –≤ –±–ª–∏–∂–∞–π—à–∏–µ –≤—ã—Ö–æ–¥–Ω—ã–µ

---

## üìã –ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏–π —á–µ–∫–ª–∏—Å—Ç

### –û—Å—Ç–∞–≤–∏—Ç—å SQLite –ú–û–ñ–ù–û –µ—Å–ª–∏:
- [ ] –ú–∞—Å—Ç–µ—Ä–æ–≤ < 5
- [ ] –ó–∞—è–≤–æ–∫ < 30/–¥–µ–Ω—å
- [ ] –ë–î < 50 MB
- [ ] Downtime 1 —á–∞—Å/–º–µ—Å—è—Ü - –ø—Ä–∏–µ–º–ª–µ–º
- [ ] –ï—Å—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup
- [ ] –ù–µ—Ç —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

**–ï—Å–ª–∏ –í–°–ï –≥–∞–ª–æ—á–∫–∏ ‚úÖ** ‚Üí SQLite –ø–æ–¥—Ö–æ–¥–∏—Ç –Ω–∞ 1-2 –≥–æ–¥–∞

### –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ PostgreSQL –ù–£–ñ–ù–û –µ—Å–ª–∏:
- [ ] –ú–∞—Å—Ç–µ—Ä–æ–≤ > 10
- [ ] –ó–∞—è–≤–æ–∫ > 50/–¥–µ–Ω—å
- [ ] –ü–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] Uptime 99% –∫—Ä–∏—Ç–∏—á–µ–Ω
- [ ] –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –≤–∞–∂–Ω—ã
- [ ] –ï—Å—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ "database locked"

**–ï—Å–ª–∏ 3+ –≥–∞–ª–æ—á–∫–∏ ‚úÖ** ‚Üí –ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞

---

## üí° –ú–æ–π –≤–µ—Ä–¥–∏–∫—Ç

**–î–ª—è –ë–û–õ–¨–®–ò–ù–°–¢–í–ê —Å–ª—É—á–∞–µ–≤:**

SQLite –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –Ω–∞ **–±–ª–∏–∂–∞–π—à–∏–µ 3-6 –º–µ—Å—è—Ü–µ–≤** –µ—Å–ª–∏:
1. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup
2. –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å —Ä–∞–∑–º–µ—Ä –ë–î
3. –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –ø–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏

**–ü–†–ò–û–†–ò–¢–ï–¢:**
```
P0-4: Rate Limiting     > P0-2: PostgreSQL  (–¥–ª—è –º–∞–ª–æ–≥–æ –±–∏–∑–Ω–µ—Å–∞)
P0-1: Secrets           > P0-2: PostgreSQL  (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –≤–∞–∂–Ω–µ–µ)
P0-2: PostgreSQL        > P1 —Ä–∏—Å–∫–∏         (–µ—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã)
```

**–†–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ—Ä—è–¥–æ–∫:**
1. **P0-4: Rate Limiting** (1 –¥–µ–Ω—å) - –∑–∞—â–∏—Ç–∞ –æ—Ç DoS
2. **P0-1: Secrets** (1 –¥–µ–Ω—å) - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–æ–≤
3. **P0-2: PostgreSQL** (3 –¥–Ω—è) - –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ —Ä–æ—Å—Ç
   - **–ò–õ–ò –æ—Ç–ª–æ–∂–∏—Ç—å** –µ—Å–ª–∏ –º–∞–ª—ã–π –±–∏–∑–Ω–µ—Å (< 5 –º–∞—Å—Ç–µ—Ä–æ–≤)

---

## üìû –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –¥–∞–Ω–Ω—ã–º

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ:**
```bash
python -c "
import sqlite3
conn = sqlite3.connect('bot_database.db')
c = conn.cursor()

masters = c.execute('SELECT COUNT(*) FROM masters WHERE is_active=1').fetchone()[0]
orders_30d = c.execute(\"SELECT COUNT(*) FROM orders WHERE created_at > datetime('now', '-30 days')\").fetchone()[0]
orders_per_day = orders_30d / 30.0

print(f'–ê–∫—Ç–∏–≤–Ω—ã—Ö –º–∞—Å—Ç–µ—Ä–æ–≤: {masters}')
print(f'–ó–∞—è–≤–æ–∫ –∑–∞ 30 –¥–Ω–µ–π: {orders_30d}')
print(f'–ó–∞—è–≤–æ–∫ –≤ –¥–µ–Ω—å (—Å—Ä–µ–¥–Ω): {orders_per_day:.1f}')
print()

if masters <= 5 and orders_per_day <= 30:
    print('‚úÖ SQLite –î–û–°–¢–ê–¢–û–ß–ù–û –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–µ 6-12 –º–µ—Å—è—Ü–µ–≤')
    print('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –§–æ–∫—É—Å –Ω–∞ P0-4 (Rate Limiting)')
elif masters <= 15 and orders_per_day <= 100:
    print('‚ö†Ô∏è SQLite —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ —Å—Ç–æ–∏—Ç –º–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤ —Ç–µ—á–µ–Ω–∏–µ 3-6 –º–µ—Å—è—Ü–µ–≤')
    print('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å PostgreSQL, –Ω–æ –Ω–µ —Å—Ä–æ—á–Ω–æ')
else:
    print('‚ùå SQLite –ö–†–ò–¢–ò–ß–ù–û! –ú–∏–≥—Ä–∞—Ü–∏—è –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–ê –≤ —Ç–µ—á–µ–Ω–∏–µ 1 –º–µ—Å—è—Ü–∞')
    print('–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: PostgreSQL - –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç P0')
"
```

---

**–ó–∞–ø—É—Å—Ç–∏—Ç–µ —ç—Ç—É –∫–æ–º–∞–Ω–¥—É –∏ –ø–æ–∫–∞–∂–∏—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç - —è –¥–∞–º —Ç–æ—á–Ω—É—é —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é!** üìä

