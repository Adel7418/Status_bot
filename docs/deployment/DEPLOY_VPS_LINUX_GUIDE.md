# üöÄ –ü–æ—à–∞–≥–æ–≤—ã–π –î–µ–ø–ª–æ–π –Ω–∞ VPS Linux

**–î–∞—Ç–∞:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** 1.2.1  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

---

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS —Å–µ—Ä–≤–µ—Ä–∞](#1-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-vps-—Å–µ—Ä–≤–µ—Ä–∞)
2. [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ü–û](#2-—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ-–ø–æ)
3. [–ü–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä](#3-–ø–µ—Ä–µ–Ω–æ—Å-–ø—Ä–æ–µ–∫—Ç–∞-–Ω–∞-—Å–µ—Ä–≤–µ—Ä)
4. [–ü–µ—Ä–µ–Ω–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](#4-–ø–µ—Ä–µ–Ω–æ—Å-–±–∞–∑—ã-–¥–∞–Ω–Ω—ã—Ö)
5. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#5-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
6. [–ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker](#6-–∑–∞–ø—É—Å–∫-—á–µ—Ä–µ–∑-docker)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞](#7-–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞)
8. [–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞](#8-–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥-–∏-–ø–æ–¥–¥–µ—Ä–∂–∫–∞)
9. [–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ](#9-—Ä–µ–∑–µ—Ä–≤–Ω–æ–µ-–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ)
10. [Troubleshooting](#10-troubleshooting)

---

## 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ VPS —Å–µ—Ä–≤–µ—Ä–∞

### 1.1 –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –û–°: Ubuntu 20.04+ / Debian 11+ / CentOS 8+
- CPU: 1 —è–¥—Ä–æ
- RAM: 1 GB (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 2 GB)
- –î–∏—Å–∫: 10 GB
- –î–æ—Å—Ç—É–ø: SSH root –∏–ª–∏ sudo –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å

**–†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- CPU: 2 —è–¥—Ä–∞
- RAM: 2 GB
- –î–∏—Å–∫: 20 GB
- SSD –¥–∏—Å–∫

### 1.2 –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SSH
ssh root@–≤–∞—à_IP_–∞–¥—Ä–µ—Å

# –ò–ª–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
ssh username@–≤–∞—à_IP_–∞–¥—Ä–µ—Å
```

### 1.3 –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

```bash
# –î–ª—è Ubuntu/Debian
sudo apt update && sudo apt upgrade -y

# –î–ª—è CentOS/RHEL
sudo yum update -y

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∞–∑–æ–≤—ã—Ö —É—Ç–∏–ª–∏—Ç
sudo apt install -y git curl wget nano htop
```

### 1.4 –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –±–æ—Ç–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
sudo useradd -m -s /bin/bash botuser

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –≥—Ä—É–ø–ø—É sudo (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
sudo usermod -aG sudo botuser

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–∞—Ä–æ–ª—è
sudo passwd botuser

# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
su - botuser
```

---

## 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–≥–æ –ü–û

### 2.1 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker

```bash
# –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π Docker (–µ—Å–ª–∏ –±—ã–ª–∏)
sudo apt remove docker docker-engine docker.io containerd runc

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
sudo apt install -y \
    ca-certificates \
    curl \
    gnupg \
    lsb-release

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ GPG –∫–ª—é—á–∞ Docker
sudo mkdir -p /etc/apt/keyrings
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo gpg --dearmor -o /etc/apt/keyrings/docker.gpg

# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è Docker
echo \
  "deb [arch=$(dpkg --print-architecture) signed-by=/etc/apt/keyrings/docker.gpg] https://download.docker.com/linux/ubuntu \
  $(lsb_release -cs) stable" | sudo tee /etc/apt/sources.list.d/docker.list > /dev/null

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Docker
sudo apt update
sudo apt install -y docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏
sudo docker --version
sudo docker compose version
```

### 2.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Docker –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

```bash
# –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –≥—Ä—É–ø–ø—É docker
sudo usermod -aG docker $USER

# –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π (–≤—ã—Ö–æ–¥ –∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—Ö–æ–¥)
newgrp docker

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –±–µ–∑ sudo
docker ps
```

### 2.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Git (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)

```bash
sudo apt install -y git
git --version
```

---

## 3. –ü–µ—Ä–µ–Ω–æ—Å –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ GitHub (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–æ–º–∞—à–Ω—é—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~

# –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
git clone https://github.com/Adel7418/Status_bot.git telegram_repair_bot

# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd telegram_repair_bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ñ–∞–π–ª–æ–≤
ls -la
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–Ω–æ—Å —Ñ–∞–π–ª–æ–≤ —á–µ—Ä–µ–∑ SCP (–µ—Å–ª–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç–µ –ª–æ–∫–∞–ª—å–Ω–æ)

**–ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (Windows PowerShell):**

```powershell
# –ü–µ—Ä–µ–Ω–æ—Å –≤—Å–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞
scp -r C:\Bot_test\telegram_repair_bot root@–≤–∞—à_IP:/home/botuser/

# –ò–ª–∏ —á–µ—Ä–µ–∑ –∞—Ä—Ö–∏–≤ (–±—ã—Å—Ç—Ä–µ–µ –¥–ª—è –±–æ–ª—å—à–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤)
# 1. –°–æ–∑–¥–∞—Ç—å –∞—Ä—Ö–∏–≤ –ª–æ–∫–∞–ª—å–Ω–æ
tar -czf bot_project.tar.gz C:\Bot_test\telegram_repair_bot

# 2. –ü–µ—Ä–µ–Ω–µ—Å—Ç–∏ –∞—Ä—Ö–∏–≤
scp bot_project.tar.gz root@–≤–∞—à_IP:/home/botuser/

# 3. –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∞—Ç—å
ssh root@–≤–∞—à_IP
cd /home/botuser
tar -xzf bot_project.tar.gz
mv telegram_repair_bot telegram_repair_bot
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ rsync (–Ω–∞–∏–±–æ–ª–µ–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ)

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (–∏–∑ WSL –∏–ª–∏ Git Bash)
rsync -avz --progress \
  -e "ssh" \
  /c/Bot_test/telegram_repair_bot/ \
  root@–≤–∞—à_IP:/home/botuser/telegram_repair_bot/
```

---

## 4. –ü–µ—Ä–µ–Ω–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### 4.1 –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ

**–ù–∞ Windows (–≤ PowerShell):**

```powershell
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø—Ä–æ–µ–∫—Ç–∞
cd C:\Bot_test\telegram_repair_bot

# –°–æ–∑–¥–∞–Ω–∏–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏
python backup_db.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–ø–∏–∏
dir backups
```

### 4.2 –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ JSON (–∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥)

–°–æ–∑–¥–∞–π—Ç–µ —Å–∫—Ä–∏–ø—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞:

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ —Å–æ–∑–¥–∞–π—Ç–µ export_db.py
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞ export_db.py:**

```python
import sqlite3
import json
from datetime import datetime

def export_database():
    """–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ SQLite –≤ JSON"""
    
    conn = sqlite3.connect('bot_database.db')
    conn.row_factory = sqlite3.Row
    cursor = conn.cursor()
    
    export_data = {
        'export_date': datetime.now().isoformat(),
        'tables': {}
    }
    
    # –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç–∞–±–ª–∏—Ü
    cursor.execute("SELECT name FROM sqlite_master WHERE type='table';")
    tables = [row[0] for row in cursor.fetchall()]
    
    # –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∫–∞–∂–¥–æ–π —Ç–∞–±–ª–∏—Ü—ã
    for table in tables:
        cursor.execute(f"SELECT * FROM {table}")
        rows = cursor.fetchall()
        export_data['tables'][table] = [dict(row) for row in rows]
    
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ JSON
    filename = f"db_export_{datetime.now().strftime('%Y%m%d_%H%M%S')}.json"
    with open(filename, 'w', encoding='utf-8') as f:
        json.dump(export_data, f, ensure_ascii=False, indent=2, default=str)
    
    conn.close()
    print(f"‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –≤ {filename}")
    print(f"üìä –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ —Ç–∞–±–ª–∏—Ü: {len(tables)}")
    
    return filename

if __name__ == "__main__":
    export_database()
```

**–ó–∞–ø—É—Å–∫ —ç–∫—Å–ø–æ—Ä—Ç–∞:**

```powershell
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ
python export_db.py
```

### 4.3 –ü–µ—Ä–µ–Ω–æ—Å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä

**–ú–µ—Ç–æ–¥ 1: –ü–µ—Ä–µ–Ω–æ—Å —Ñ–∞–π–ª–∞ .db –Ω–∞–ø—Ä—è–º—É—é**

```bash
# –ù–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ (PowerShell)
scp C:\Bot_test\telegram_repair_bot\bot_database.db root@–≤–∞—à_IP:/home/botuser/telegram_repair_bot/

# –ò–ª–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
scp C:\Bot_test\telegram_repair_bot\backups\bot_database_*.db root@–≤–∞—à_IP:/home/botuser/telegram_repair_bot/
```

**–ú–µ—Ç–æ–¥ 2: –ü–µ—Ä–µ–Ω–æ—Å JSON —ç–∫—Å–ø–æ—Ä—Ç–∞**

```bash
# –ü–µ—Ä–µ–Ω–æ—Å JSON —Ñ–∞–π–ª–∞
scp db_export_*.json root@–≤–∞—à_IP:/home/botuser/telegram_repair_bot/
```

### 4.4 –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–ï—Å–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ .db —Ñ–∞–π–ª:**

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd ~/telegram_repair_bot

# –ï—Å–ª–∏ –ø–µ—Ä–µ–Ω–µ—Å–ª–∏ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
mv bot_database_*.db bot_database.db

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø—Ä–∞–≤
chmod 644 bot_database.db
chown botuser:botuser bot_database.db
```

**–ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ JSON (—Å–æ–∑–¥–∞–π—Ç–µ import_db.py):**

```python
import sqlite3
import json
import sys

def import_database(json_file):
    """–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON –≤ SQLite"""
    
    with open(json_file, 'r', encoding='utf-8') as f:
        data = json.load(f)
    
    conn = sqlite3.connect('bot_database.db')
    cursor = conn.cursor()
    
    for table_name, rows in data['tables'].items():
        if not rows:
            continue
            
        # –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–ª–æ–Ω–æ–∫
        columns = list(rows[0].keys())
        placeholders = ','.join(['?' for _ in columns])
        columns_str = ','.join(columns)
        
        # –í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
        for row in rows:
            values = [row[col] for col in columns]
            try:
                cursor.execute(
                    f"INSERT OR REPLACE INTO {table_name} ({columns_str}) VALUES ({placeholders})",
                    values
                )
            except Exception as e:
                print(f"‚ö†Ô∏è  –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—Å—Ç–∞–≤–∫–µ –≤ {table_name}: {e}")
    
    conn.commit()
    conn.close()
    print(f"‚úÖ –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–∞ –∏–∑ {json_file}")

if __name__ == "__main__":
    if len(sys.argv) < 2:
        print("–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ: python import_db.py <json_file>")
        sys.exit(1)
    
    import_database(sys.argv[1])
```

---

## 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### 5.1 –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞

```bash
# –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
cd ~/telegram_repair_bot

# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–º–µ—Ä–∞
cp env.example .env

# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ .env
nano .env
```

### 5.2 –ó–∞–ø–æ–ª–Ω–µ–Ω–∏–µ .env —Ñ–∞–π–ª–∞

**–û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

```bash
# –¢–æ–∫–µ–Ω –±–æ—Ç–∞ (–ø–æ–ª—É—á–∏—Ç–µ —É @BotFather)
BOT_TOKEN=–≤–∞—à_—Ä–µ–∞–ª—å–Ω—ã–π_—Ç–æ–∫–µ–Ω_–æ—Ç_BotFather

# ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤ (—É–∑–Ω–∞–π—Ç–µ —É @userinfobot)
ADMIN_IDS=123456789,987654321

# ID –¥–∏—Å–ø–µ—Ç—á–µ—Ä–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
DISPATCHER_IDS=111222333

# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
DATABASE_PATH=/app/data/bot_database.db

# Redis –¥–ª—è production
REDIS_URL=redis://redis:6379/0

# –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
LOG_LEVEL=INFO

# –û–∫—Ä—É–∂–µ–Ω–∏–µ
ENVIRONMENT=production
```

**–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ñ–∞–π–ª–∞:**
- –í nano: `Ctrl+O` (Enter) ‚Üí `Ctrl+X`
- –í vim: `Esc` ‚Üí `:wq` ‚Üí `Enter`

### 5.3 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

```bash
# –ó–∞—â–∏—Ç–∞ .env —Ñ–∞–π–ª–∞
chmod 600 .env

# –ü—Ä–æ–≤–µ—Ä–∫–∞
ls -la .env
```

---

## 6. –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker

### 6.1 –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ –∑–∞–ø—É—Å–∫—É

```bash
# –ü–µ—Ä–µ—Ö–æ–¥ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é
cd ~/telegram_repair_bot

# –°–æ–∑–¥–∞–Ω–∏–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
mkdir -p data logs backups

# –ü—Ä–æ–≤–µ—Ä–∫–∞ Docker
docker --version
docker compose version
```

### 6.2 –°–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–∞

```bash
# –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
docker compose -f docker/docker-compose.prod.yml build

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞
docker images | grep telegram
```

### 6.3 –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

```bash
# –ó–∞–ø—É—Å–∫ –≤ —Ä–µ–∂–∏–º–µ daemon (—Ñ–æ–Ω–æ–≤—ã–π —Ä–µ–∂–∏–º)
docker compose -f docker/docker-compose.prod.yml up -d

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker/docker-compose.prod.yml ps
```

### 6.4 –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤

```bash
# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –±–æ—Ç–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
docker compose -f docker/docker-compose.prod.yml logs -f bot

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 50 —Å—Ç—Ä–æ–∫
docker compose -f docker/docker-compose.prod.yml logs --tail=50 bot

# –õ–æ–≥–∏ Redis
docker compose -f docker/docker-compose.prod.yml logs redis
```

### 6.5 –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps

# –ü—Ä–æ–≤–µ—Ä–∫–∞ healthcheck
docker inspect telegram_repair_bot_prod | grep -A 10 Health

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats telegram_repair_bot_prod --no-stream
```

**–û–∂–∏–¥–∞–µ–º—ã–π –≤—ã–≤–æ–¥:**
```
CONTAINER ID   NAME                        CPU %     MEM USAGE / LIMIT   
abc123def456   telegram_repair_bot_prod    0.5%      150MiB / 512MiB
```

### 6.6 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞ –≤ Telegram

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram
2. –ù–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ `/start`
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –±–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç

---

## 7. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

### 7.1 –°–æ–∑–¥–∞–Ω–∏–µ systemd —Å–µ—Ä–≤–∏—Å–∞

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ —Å–µ—Ä–≤–∏—Å–∞
sudo nano /etc/systemd/system/telegram-bot.service
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ñ–∞–π–ª–∞:**

```ini
[Unit]
Description=Telegram Repair Bot
Requires=docker.service
After=docker.service network-online.target
Wants=network-online.target

[Service]
Type=oneshot
RemainAfterExit=yes
User=botuser
Group=botuser
WorkingDirectory=/home/botuser/telegram_repair_bot

# –ö–æ–º–∞–Ω–¥—ã –∑–∞–ø—É—Å–∫–∞
ExecStart=/usr/bin/docker compose -f docker/docker-compose.prod.yml up -d
ExecStop=/usr/bin/docker compose -f docker/docker-compose.prod.yml down
ExecReload=/usr/bin/docker compose -f docker/docker-compose.prod.yml restart

# –¢–∞–π–º–∞—É—Ç—ã
TimeoutStartSec=300
TimeoutStopSec=60

# Restart –ø–æ–ª–∏—Ç–∏–∫–∞
Restart=on-failure
RestartSec=10

[Install]
WantedBy=multi-user.target
```

### 7.2 –ê–∫—Ç–∏–≤–∞—Ü–∏—è —Å–µ—Ä–≤–∏—Å–∞

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ systemd
sudo systemctl daemon-reload

# –í–∫–ª—é—á–µ–Ω–∏–µ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞
sudo systemctl enable telegram-bot.service

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl start telegram-bot.service

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo systemctl status telegram-bot.service
```

### 7.3 –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–º

```bash
# –ó–∞–ø—É—Å–∫
sudo systemctl start telegram-bot

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
sudo systemctl stop telegram-bot

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
sudo systemctl restart telegram-bot

# –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ systemd
sudo journalctl -u telegram-bot.service -f

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫
sudo journalctl -u telegram-bot.service -n 100
```

### 7.4 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫–∞

```bash
# –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
sudo reboot

# –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å
sudo systemctl status telegram-bot
docker ps
```

---

## 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞

### 8.1 –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

```bash
# –°—Ç–∞—Ç—É—Å –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker ps -a

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
docker stats

# –õ–æ–≥–∏ –±–æ—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 100 —Å—Ç—Ä–æ–∫)
docker compose -f docker/docker-compose.prod.yml logs --tail=100 bot

# –õ–æ–≥–∏ —Å –ø–æ–∏—Å–∫–æ–º –æ—à–∏–±–æ–∫
docker compose -f docker/docker-compose.prod.yml logs bot | grep -i error

# –õ–æ–≥–∏ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
docker compose -f docker/docker-compose.prod.yml logs --since=1h bot

# –†–∞–∑–º–µ—Ä –ª–æ–≥–æ–≤
docker inspect telegram_repair_bot_prod | grep -i logpath
```

### 8.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
# –í—Ö–æ–¥ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
docker compose -f docker/docker-compose.prod.yml exec bot bash

# –í–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
python check_database.py

# –†–∞–∑–º–µ—Ä –ë–î
ls -lh /app/data/bot_database.db

# –í—ã—Ö–æ–¥ –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
exit
```

### 8.3 –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis

```bash
# –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redis CLI
docker compose -f docker/docker-compose.prod.yml exec redis redis-cli

# –í–Ω—É—Ç—Ä–∏ Redis CLI:
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∫–ª—é—á–µ–π
DBSIZE

# –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –∫–ª—é—á–µ–π
KEYS *

# –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–∞–º—è—Ç–∏
INFO memory

# –í—ã—Ö–æ–¥
exit
```

### 8.4 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç—Ä–∏–∫

**–°–∫—Ä–∏–ø—Ç –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**

```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
nano ~/monitor_bot.sh
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ monitor_bot.sh:**

```bash
#!/bin/bash

echo "ü§ñ Telegram Bot Monitoring Report"
echo "=================================="
echo "üìÖ –î–∞—Ç–∞: $(date)"
echo ""

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
echo "üì¶ –°—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞:"
docker ps --filter "name=telegram_repair_bot_prod" --format "table {{.Names}}\t{{.Status}}\t{{.State}}"
echo ""

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
echo "üíª –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤:"
docker stats telegram_repair_bot_prod --no-stream --format "table {{.Name}}\t{{.CPUPerc}}\t{{.MemUsage}}"
echo ""

# –†–∞–∑–º–µ—Ä –ë–î
echo "üíæ –†–∞–∑–º–µ—Ä –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:"
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml exec -T bot ls -lh /app/data/bot_database.db 2>/dev/null || echo "–ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω–∞"
echo ""

# –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏
echo "‚ö†Ô∏è  –ü–æ—Å–ª–µ–¥–Ω–∏–µ –æ—à–∏–±–∫–∏ (–µ—Å–ª–∏ –µ—Å—Ç—å):"
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml logs --tail=20 bot 2>/dev/null | grep -i error || echo "–û—à–∏–±–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"
echo ""

# Healthcheck
echo "üè• Healthcheck:"
docker inspect telegram_repair_bot_prod | grep -A 5 '"Health"' || echo "Healthcheck –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω"
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

```bash
# –°–¥–µ–ª–∞—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x ~/monitor_bot.sh

# –ó–∞–ø—É—Å–∫
~/monitor_bot.sh
```

---

## 9. –†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ

### 9.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

**–°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–∞ backup:**

```bash
nano ~/backup_bot_db.sh
```

**–°–æ–¥–µ—Ä–∂–∏–º–æ–µ backup_bot_db.sh:**

```bash
#!/bin/bash

# –î–∏—Ä–µ–∫—Ç–æ—Ä–∏—è –¥–ª—è backup
BACKUP_DIR="/home/botuser/telegram_repair_bot/backups"
TIMESTAMP=$(date +"%Y-%m-%d_%H-%M-%S")
DB_FILE="/home/botuser/telegram_repair_bot/data/bot_database.db"
BACKUP_FILE="${BACKUP_DIR}/bot_database_${TIMESTAMP}.db"

# –°–æ–∑–¥–∞–Ω–∏–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
mkdir -p "$BACKUP_DIR"

# Backup –∏–∑ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker compose -f /home/botuser/telegram_repair_bot/docker/docker-compose.prod.yml exec -T bot \
    python backup_db.py

# –ò–ª–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–∞ –Ω–∞–ø—Ä—è–º—É—é
if [ -f "$DB_FILE" ]; then
    cp "$DB_FILE" "$BACKUP_FILE"
    echo "‚úÖ Backup —Å–æ–∑–¥–∞–Ω: $BACKUP_FILE"
    
    # –£–¥–∞–ª–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö backup (—Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π)
    find "$BACKUP_DIR" -name "bot_database_*.db" -mtime +30 -delete
    echo "üóëÔ∏è  –°—Ç–∞—Ä—ã–µ backup —É–¥–∞–ª–µ–Ω—ã"
else
    echo "‚ùå –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: $DB_FILE"
    exit 1
fi
```

**–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º:**

```bash
chmod +x ~/backup_bot_db.sh
```

### 9.2 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CRON –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ backup

```bash
# –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ crontab
crontab -e

# –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â—É—é —Å—Ç—Ä–æ–∫—É –¥–ª—è –µ–∂–µ–¥–Ω–µ–≤–Ω–æ–≥–æ backup –≤ 2:00 –Ω–æ—á–∏
0 2 * * * /home/botuser/backup_bot_db.sh >> /home/botuser/backup.log 2>&1

# –ò–ª–∏ –¥–ª—è backup –∫–∞–∂–¥—ã–µ 6 —á–∞—Å–æ–≤
0 */6 * * * /home/botuser/backup_bot_db.sh >> /home/botuser/backup.log 2>&1

# –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∏ –≤—ã–π–¥–∏—Ç–µ (–≤ nano: Ctrl+O, Enter, Ctrl+X)
```

### 9.3 –†—É—á–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ backup

```bash
# –ó–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –≤—Ä—É—á–Ω—É—é
~/backup_bot_db.sh

# –ò–ª–∏ —á–µ—Ä–µ–∑ Docker
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml exec bot python backup_db.py

# –°–ø–∏—Å–æ–∫ backup
ls -lh ~/telegram_repair_bot/backups/
```

### 9.4 –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ backup

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–æ—Ç–∞
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml stop bot

# –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–∑ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ backup
cp ~/telegram_repair_bot/backups/bot_database_2025-10-13_12-00-00.db \
   ~/telegram_repair_bot/data/bot_database.db

# –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml start bot
```

---

## 10. Troubleshooting

### 10.1 –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–∞–¥–∞–µ—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤
docker compose -f docker/docker-compose.prod.yml logs bot

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .env —Ñ–∞–π–ª–∞
cat .env | grep BOT_TOKEN

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ç–∏
docker network ls
docker network inspect telegram_repair_bot_bot_network

# –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∑–∞–ø—É—Å–∫ –±–µ–∑ daemon —Ä–µ–∂–∏–º–∞
docker compose -f docker/docker-compose.prod.yml up
```

**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å BOT_TOKEN –≤ .env

### 10.2 –ë–æ—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –ë–æ—Ç –∑–∞–ø—É—â–µ–Ω, –Ω–æ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ –∫–æ–º–∞–Ω–¥—ã

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ healthcheck
docker inspect telegram_repair_bot_prod | grep Health -A 10

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –æ—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
docker compose -f docker/docker-compose.prod.yml logs bot | grep -i "connection\|error\|fail"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ Telegram API
docker compose -f docker/docker-compose.prod.yml exec bot ping -c 3 api.telegram.org
```

**–†–µ—à–µ–Ω–∏—è:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ firewall –ø—Ä–∞–≤–∏–ª–∞

### 10.3 –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** SQLite database is locked

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –≤—Å–µ—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
docker compose -f docker/docker-compose.prod.yml down

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ –∏—Å–ø–æ–ª—å–∑—É—é—â–∏—Ö –ë–î
lsof ~/telegram_repair_bot/data/bot_database.db

# –£–¥–∞–ª–µ–Ω–∏–µ lock —Ñ–∞–π–ª–æ–≤
rm -f ~/telegram_repair_bot/data/bot_database.db-journal
rm -f ~/telegram_repair_bot/data/bot_database.db-shm
rm -f ~/telegram_repair_bot/data/bot_database.db-wal

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose -f docker/docker-compose.prod.yml up -d
```

### 10.4 –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –ø–∞–º—è—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞:** OOM (Out of Memory)

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏
docker stats --no-stream

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –≤ docker-compose.prod.yml
cat docker/docker-compose.prod.yml | grep -A 5 resources

# –£–≤–µ–ª–∏—á–µ–Ω–∏–µ swap (–≤—Ä–µ–º–µ–Ω–Ω–æ)
sudo fallocate -l 2G /swapfile
sudo chmod 600 /swapfile
sudo mkswap /swapfile
sudo swapon /swapfile
```

**–†–µ—à–µ–Ω–∏–µ:** –£–≤–µ–ª–∏—á—å—Ç–µ RAM —Å–µ—Ä–≤–µ—Ä–∞ –∏–ª–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä—É–π—Ç–µ –ª–∏–º–∏—Ç—ã –≤ docker-compose

### 10.5 Redis –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–ü—Ä–æ–±–ª–µ–º–∞:** Cannot connect to Redis

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ Redis –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
docker ps | grep redis

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ Redis
docker compose -f docker/docker-compose.prod.yml logs redis

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ Redis
docker compose -f docker/docker-compose.prod.yml restart redis

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏
docker compose -f docker/docker-compose.prod.yml exec bot ping redis
```

### 10.6 –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞

**–ü—Ä–æ–±–ª–µ–º–∞:** Permission denied

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Ñ–∞–π–ª–æ–≤
ls -la ~/telegram_repair_bot/

# –ò–∑–º–µ–Ω–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞
sudo chown -R botuser:botuser ~/telegram_repair_bot/

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏
chmod 755 ~/telegram_repair_bot/data
chmod 755 ~/telegram_repair_bot/logs
chmod 755 ~/telegram_repair_bot/backups

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –Ω–∞ –ë–î
chmod 644 ~/telegram_repair_bot/data/bot_database.db
```

---

## üìä –ß–µ–∫–ª–∏—Å—Ç —É—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

### –ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º:
- [ ] VPS —Å–µ—Ä–≤–µ—Ä –≥–æ—Ç–æ–≤ –∏ –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ SSH
- [ ] Docker –∏ Docker Compose —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] Git —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
- [ ] –°–æ–∑–¥–∞–Ω backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –ª–æ–∫–∞–ª—å–Ω–æ

### –í–æ –≤—Ä–µ–º—è –¥–µ–ø–ª–æ—è:
- [ ] –ü—Ä–æ–µ–∫—Ç –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞
- [ ] .env —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
- [ ] Docker –æ–±—Ä–∞–∑ —Å–æ–±—Ä–∞–Ω —É—Å–ø–µ—à–Ω–æ
- [ ] –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã

### –ü–æ—Å–ª–µ –¥–µ–ø–ª–æ—è:
- [ ] –ë–æ—Ç –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ /start –≤ Telegram
- [ ] –õ–æ–≥–∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫
- [ ] Healthcheck –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "healthy"
- [ ] –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ systemd –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π backup –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (—à–ø–∞—Ä–≥–∞–ª–∫–∞)

```bash
# === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º ===
# –ó–∞–ø—É—Å–∫
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml up -d

# –û—Å—Ç–∞–Ω–æ–≤–∫–∞
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml down

# –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml restart

# –õ–æ–≥–∏
docker compose -f ~/telegram_repair_bot/docker/docker-compose.prod.yml logs -f bot

# === –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ ===
cd ~/telegram_repair_bot
git pull
docker compose -f docker/docker-compose.prod.yml build
docker compose -f docker/docker-compose.prod.yml up -d

# === Backup ===
~/backup_bot_db.sh

# === –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ ===
~/monitor_bot.sh
docker stats
```

---

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: `docker compose -f docker/docker-compose.prod.yml logs bot`
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å: `docker ps`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ healthcheck: `docker inspect telegram_repair_bot_prod | grep Health -A 10`
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Ä–∞–∑–¥–µ–ª—É [Troubleshooting](#10-troubleshooting)

---

**–í–µ—Ä—Å–∏—è:** 1.2.1  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 13 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Production Ready

üöÄ **–£—Å–ø–µ—à–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è!**

