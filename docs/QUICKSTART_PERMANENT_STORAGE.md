# ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞—è–≤–æ–∫

## üéØ –ó–∞ 5 –º–∏–Ω—É—Ç –¥–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (1 –º–∏–Ω)

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
pip install cryptography==43.0.3

# –ò–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
pip install -r requirements.txt
```

### –®–∞–≥ 2: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (1 –º–∏–Ω)

```bash
# –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á
python -c "from cryptography.fernet import Fernet; print(Fernet.generate_key().decode())"

# –†–µ–∑—É–ª—å—Ç–∞—Ç (–ø—Ä–∏–º–µ—Ä):
# gAAAAABl1234567890abcdefghijklmnopqrstuvwxyz==
```

**–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:**
```bash
ENCRYPTION_KEY=gAAAAABl1234567890abcdefghijklmnopqrstuvwxyz==
ENCRYPT_DATA=false  # –°–Ω–∞—á–∞–ª–∞ false –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
```

‚ö†Ô∏è **–í–ê–ñ–ù–û:**
- –ù–ï –ø—É–±–ª–∏–∫—É–π—Ç–µ –∫–ª—é—á –≤ git!
- –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- –ë–µ–∑ –∫–ª—é—á–∞ –≤—ã –ù–ï —Å–º–æ–∂–µ—Ç–µ —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ!

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–µ–∫—É—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è (1 –º–∏–Ω)

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
alembic current

# –î–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑–∞—Ç—å: 008_add_soft_delete (–∏–ª–∏ –Ω–æ–≤–µ–µ)
# –ï—Å–ª–∏ –Ω–µ—Ç, –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
alembic upgrade head
```

### –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (2 –º–∏–Ω)

```python
# test_encryption.py
from app.utils.encryption import encrypt, decrypt

# –¢–µ—Å—Ç
original = "79991234567"
encrypted = encrypt(original)
decrypted = decrypt(encrypted)

print(f"–û—Ä–∏–≥–∏–Ω–∞–ª:     {original}")
print(f"–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ:  {encrypted}")
print(f"–†–∞—Å—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ: {decrypted}")
print(f"‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç: {original == decrypted}")
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å:
```bash
python test_encryption.py
```

---

## ‚úÖ –í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ –£–ñ–ï –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç:

### 1. ‚úÖ Soft Delete (–ú—è–≥–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ)
**–ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ü–æ–ª–µ `deleted_at` –≤–æ –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π

**–ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
```python
# –í–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
await db.connection.execute(
    "UPDATE orders SET deleted_at = ? WHERE id = ?",
    (datetime.now().isoformat(), order_id)
)

# –ü–æ–∏—Å–∫ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã—Ö
SELECT * FROM orders WHERE deleted_at IS NULL

# –ü–æ–∏—Å–∫ –≤—Å–µ—Ö (–≤–∫–ª—é—á–∞—è —É–¥–∞–ª–µ–Ω–Ω—ã–µ)
SELECT * FROM orders
```

### 2. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
**–¢–∞–±–ª–∏—Ü–∞:** `order_status_history`

**–ß—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è:**
- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤ –∑–∞—è–≤–æ–∫
- –ö—Ç–æ –∏–∑–º–µ–Ω–∏–ª
- –ö–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–º–µ—Ç–∫–∏

### 3. ‚úÖ –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–µ–π
**–¢–∞–±–ª–∏—Ü–∞:** `entity_history`

**–ß—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è:**
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –ª—é–±—ã—Ö –ø–æ–ª–µ–π –≤ –ª—é–±—ã—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö
- –°—Ç–∞—Ä–æ–µ –∏ –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ö—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª

### 4. ‚úÖ –ê—É–¥–∏—Ç –¥–µ–π—Å—Ç–≤–∏–π
**–¢–∞–±–ª–∏—Ü–∞:** `audit_log`

**–ß—Ç–æ —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è:**
- –í—Å–µ –≤–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –î–µ—Ç–∞–ª–∏ –≤ JSON —Ñ–æ—Ä–º–∞—Ç–µ
- –í—Ä–µ–º–µ–Ω–Ω—ã–µ –º–µ—Ç–∫–∏

---

## üöÄ –í–Ω–µ–¥—Ä–µ–Ω–∏–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

#### –≠—Ç–∞–ø 1: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

```python
# –í –≤–∞—à–µ–º –∫–æ–¥–µ –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—è —Å—Ç–∞—Ç—É—Å–æ–≤
from app.repositories.order_repository import OrderRepository

order_repo = OrderRepository(db.connection)

# –ü–æ–ª—É—á–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∑–∞—è–≤–∫–∏
history = await order_repo.get_status_history(order_id=123)

for h in history:
    print(f"{h['changed_at']}: {h['old_status']} ‚Üí {h['new_status']}")
```

#### –≠—Ç–∞–ø 2: –î–æ–±–∞–≤–ª—è–µ–º soft delete

```python
# –ó–∞–º–µ–Ω–∏—Ç–µ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –Ω–∞ –º—è–≥–∫–æ–µ
# –ë–´–õ–û:
await db.connection.execute("DELETE FROM orders WHERE id = ?", (order_id,))

# –°–¢–ê–õ–û:
from app.utils.helpers import get_now
await db.connection.execute(
    "UPDATE orders SET deleted_at = ? WHERE id = ?",
    (get_now().isoformat(), order_id)
)
```

#### –≠—Ç–∞–ø 3: –î–æ–±–∞–≤–ª—è–µ–º —Ñ–∏–ª—å—Ç—Ä –≤ –∑–∞–ø—Ä–æ—Å—ã

```python
# –û–±–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞—è–≤–æ–∫
# –ë–´–õ–û:
SELECT * FROM orders WHERE status = 'NEW'

# –°–¢–ê–õ–û:
SELECT * FROM orders WHERE status = 'NEW' AND deleted_at IS NULL
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–æ–ª–Ω–æ–µ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ (–≥–æ—Ç–æ–≤—ã–µ –º–æ–¥—É–ª–∏)

#### –®–∞–≥ 1: –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```python
# –í –≤–∞—à–µ–º –∫–æ–¥–µ
from app.repositories.order_repository_extended import OrderRepositoryExtended

# –ó–∞–º–µ–Ω–∏—Ç–µ
order_repo = OrderRepository(db.connection)

# –ù–∞
order_repo = OrderRepositoryExtended(db.connection)

# –¢–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã:
# - soft_delete()
# - restore()
# - search_orders()
# - get_full_history()
# - get_deleted_orders()
```

#### –®–∞–≥ 2: –î–æ–±–∞–≤–ª—è–µ–º —Å–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞

```python
from app.services.search_service import SearchService

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
search_service = SearchService(order_repo)

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
orders = await search_service.search(
    query="—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫",
    filters={"status": "COMPLETED"}
)
```

---

## üîê –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### –ö–æ–≥–¥–∞ –Ω—É–∂–Ω–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ?

‚úÖ **–ù—É–∂–Ω–æ:**
- –•—Ä–∞–Ω–µ–Ω–∏–µ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤
- –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è GDPR/–∑–∞–∫–æ–Ω–∞ –æ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- Production –æ–∫—Ä—É–∂–µ–Ω–∏–µ

‚ùå **–ù–µ –Ω—É–∂–Ω–æ:**
- Development –æ–∫—Ä—É–∂–µ–Ω–∏–µ
- –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–∞–Ω–Ω—ã–µ (—Å—Ç–∞—Ç—É—Å—ã, ID)
- –î–∞–Ω–Ω—ã–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

### –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö

```bash
# 1. –°–¥–µ–ª–∞–π—Ç–µ –±—ç–∫–∞–ø!
python scripts/backup_db.py

# 2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –±—É–¥–µ—Ç –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–æ (DRY RUN)
python scripts/migrate_encryption.py
# –í—ã–±–µ—Ä–∏—Ç–µ: dry

# 3. –†–µ–∞–ª—å–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è
python scripts/migrate_encryption.py
# –í—ã–±–µ—Ä–∏—Ç–µ: real
# –í–≤–µ–¥–∏—Ç–µ: YES

# 4. –í–∫–ª—é—á–∏—Ç–µ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ –≤ .env
ENCRYPT_DATA=true
```

---

## üìä –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ soft delete

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ –ø–æ–ª—è deleted_at
SELECT name, sql FROM sqlite_master
WHERE type='table' AND name='orders';

-- –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: deleted_at DATETIME
```

### –¢–µ—Å—Ç 2: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é —Å—Ç–∞—Ç—É—Å–æ–≤
SELECT COUNT(*) FROM order_status_history;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –∏–∑–º–µ–Ω–µ–Ω–∏–π
SELECT COUNT(*) FROM entity_history;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞—É–¥–∏—Ç
SELECT COUNT(*) FROM audit_log;
```

### –¢–µ—Å—Ç 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–¥–µ–∫—Å–æ–≤

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã
SELECT name FROM sqlite_master
WHERE type='index' AND tbl_name='orders';

-- –î–æ–ª–∂–Ω—ã –±—ã—Ç—å:
-- idx_orders_deleted_at
-- idx_orders_status
-- idx_orders_assigned_master_id
-- –∏ –¥—Ä.
```

---

## üéì –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—É—é –∑–∞—è–≤–∫—É

```python
from aiogram import Router, F
from aiogram.types import CallbackQuery

@router.callback_query(F.data.startswith("restore:"))
async def restore_order(callback: CallbackQuery):
    order_id = int(callback.data.split(":")[1])

    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
    order_repo = OrderRepositoryExtended(db.connection)

    success = await order_repo.restore(
        order_id=order_id,
        restored_by=callback.from_user.id
    )

    if success:
        await callback.answer("‚úÖ –ó–∞—è–≤–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞!", show_alert=True)
    else:
        await callback.answer("‚ùå –û—à–∏–±–∫–∞", show_alert=True)
```

### –ü—Ä–∏–º–µ—Ä 2: –ü–æ–∏—Å–∫ –≤—Å–µ—Ö –∑–∞—è–≤–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞

```python
@router.message(Command("search_client"))
async def search_client(message: Message):
    # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–ª–µ—Ñ–æ–Ω –∏–∑ –∫–æ–º–∞–Ω–¥—ã
    phone = message.text.split()[-1]

    # –ü–æ–∏—Å–∫
    search_service = SearchService(order_repo)
    orders = await search_service.search_by_client_phone(phone)

    # –†–µ–∑—É–ª—å—Ç–∞—Ç
    if orders:
        text = f"üì± –ù–∞–π–¥–µ–Ω–æ –∑–∞—è–≤–æ–∫ –∫–ª–∏–µ–Ω—Ç–∞ {phone}: {len(orders)}\n\n"
        for order in orders:
            text += f"#{order.id} - {order.status} - {order.equipment_type}\n"
    else:
        text = "üîç –ó–∞—è–≤–æ–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ"

    await message.answer(text)
```

### –ü—Ä–∏–º–µ—Ä 3: –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–ª–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏

```python
@router.callback_query(F.data.startswith("history:"))
async def show_history(callback: CallbackQuery):
    order_id = int(callback.data.split(":")[1])

    # –ü–æ–ª—É—á–∞–µ–º –ø–æ–ª–Ω—É—é –∏—Å—Ç–æ—Ä–∏—é
    search_service = SearchService(order_repo)
    history = await search_service.get_full_order_history(order_id)

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º
    text = f"üìã <b>–ò—Å—Ç–æ—Ä–∏—è –∑–∞—è–≤–∫–∏ #{order_id}</b>\n\n"
    text += f"üìä –ò–∑–º–µ–Ω–µ–Ω–∏–π —Å—Ç–∞—Ç—É—Å–æ–≤: {len(history['status_history'])}\n"
    text += f"üîÑ –ò–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ–ª–µ–π: {len(history['field_history'])}\n"
    text += f"üìù –ó–∞–ø–∏—Å–µ–π –∞—É–¥–∏—Ç–∞: {len(history['audit_logs'])}\n\n"

    # –ü–æ—Å–ª–µ–¥–Ω–∏–µ 3 –∏–∑–º–µ–Ω–µ–Ω–∏—è
    text += "<b>–ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:</b>\n"
    for h in history['status_history'][:3]:
        text += f"‚Ä¢ {h['changed_at']}: {h['old_status']} ‚Üí {h['new_status']}\n"

    await callback.message.answer(text, parse_mode="HTML")
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- üìñ [PERMANENT_STORAGE_GUIDE.md](./PERMANENT_STORAGE_GUIDE.md) - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
- üìù [PERMANENT_STORAGE_EXAMPLES.md](./PERMANENT_STORAGE_EXAMPLES.md) - –ü—Ä–∏–º–µ—Ä—ã –∫–æ–¥–∞
- üîç [DB_AUDIT.md](./DB_AUDIT.md) - –ê—É–¥–∏—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

---

## ‚ùì FAQ

**Q: –ù—É–∂–Ω–æ –ª–∏ –∑–∞–ø—É—Å–∫–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏?**
A: –ï—Å–ª–∏ —É –≤–∞—Å –≤–µ—Ä—Å–∏—è –º–∏–≥—Ä–∞—Ü–∏–π >= 008, —Ç–æ –≤—Å–µ —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ! –ü—Ä–æ–≤–µ—Ä—å—Ç–µ: `alembic current`

**Q: –ö–∞–∫ —É–∑–Ω–∞—Ç—å, –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –ª–∏ –¥–∞–Ω–Ω—ã–µ?**
A: –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤—ã–≥–ª—è–¥—è—Ç –∫–∞–∫ random —Å—Ç—Ä–æ–∫–∏ base64. –ü—Ä–∏–º–µ—Ä: `Z0FBQUFBQm1...`

**Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å –µ—Å–ª–∏ –ø–æ—Ç–µ—Ä—è–ª –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è?**
A: –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –±–µ–∑ –∫–ª—é—á–∞ –¥–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ù–ï–í–û–ó–ú–û–ñ–ù–û. –ü–æ—ç—Ç–æ–º—É:
- –•—Ä–∞–Ω–∏—Ç–µ –∫–ª—é—á –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ–º –º–µ—Å—Ç–µ
- –°–¥–µ–ª–∞–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é –∫–ª—é—á–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ vault –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è (HashiCorp Vault, AWS Secrets Manager –∏ —Ç.–¥.)

**Q: –ú–æ–∂–Ω–æ –ª–∏ –º–µ–Ω—è—Ç—å –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è?**
A: –î–∞, –Ω–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ä—ã–º –∫–ª—é—á–æ–º –∏ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–º.

**Q: –ó–∞–º–µ–¥–ª–∏—Ç –ª–∏ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—É?**
A: –ù–µ–∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ. Cryptography –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä–∞—è. –î–ª—è 1000 –∑–∞—è–≤–æ–∫ ~0.1 —Å–µ–∫—É–Ω–¥—ã.

**Q: –ö–∞–∫ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É–¥–∞–ª–µ–Ω–Ω—É—é –∑–∞—è–≤–∫—É?**
A: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–µ—Ç–æ–¥ `restore()` —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ:
```sql
UPDATE orders SET deleted_at = NULL WHERE id = ?
```

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –≤–Ω–µ–¥—Ä–µ–Ω–∏—è

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ –±–∏–±–ª–∏–æ—Ç–µ–∫–∞ `cryptography`
- [ ] –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∫–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- [ ] –ö–ª—é—á –¥–æ–±–∞–≤–ª–µ–Ω –≤ `.env` (–∏ –ù–ï –≤ git!)
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –º–∏–≥—Ä–∞—Ü–∏–∏ (`alembic current`)
- [ ] –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –û–±–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–ø—Ä–æ—Å—ã —Å —Ñ–∏–ª—å—Ç—Ä–æ–º `deleted_at IS NULL`
- [ ] –°–æ–∑–¥–∞–Ω –±—ç–∫–∞–ø –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í—ã–ø–æ–ª–Ω–µ–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –í–Ω–µ–¥—Ä–µ–Ω —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
- [ ] (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –î–æ–±–∞–≤–ª–µ–Ω —Å–µ—Ä–≤–∏—Å –ø–æ–∏—Å–∫–∞

---

**–ì–æ—Ç–æ–≤–æ!** üéâ

–í–∞—à–∞ —Å–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å:
- ‚úÖ –•—Ä–∞–Ω–∏—Ç –≤—Å–µ –∑–∞—è–≤–∫–∏ –Ω–∞–≤—Å–µ–≥–¥–∞
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø–æ–∏—Å–∫ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
- ‚úÖ (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –®–∏—Ñ—Ä—É–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

**–í–µ—Ä—Å–∏—è:** 1.0
**–î–∞—Ç–∞:** 20.10.2025
**–ê–≤—Ç–æ—Ä:** AI Assistant
