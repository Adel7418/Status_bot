# –ê–Ω–∞–ª–∏–∑ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–æ—Å—Ç–∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ (P1-6)

**–î–∞—Ç–∞:** 19 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–æ–ø—Ä–æ—Å:** –ù—É–∂–µ–Ω –ª–∏ Sentry/Prometheus –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ?

---

## üéØ –ö—Ä–∞—Ç–∫–∏–π –æ—Ç–≤–µ—Ç

**–ù–ï–¢, –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ù–ï –∫—Ä–∏—Ç–∏—á–µ–Ω –Ω–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ.**

**–ú–æ–∂–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å, –µ—Å–ª–∏:**
- ‚úÖ –ü—Ä–æ–µ–∫—Ç —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
- ‚úÖ –ù–∞–≥—Ä—É–∑–∫–∞ –Ω–µ–±–æ–ª—å—à–∞—è/—Å—Ä–µ–¥–Ω—è—è (< 1000 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)
- ‚úÖ –û–¥–∏–Ω –æ–ø–µ—Ä–∞—Ç–æ—Ä/–Ω–µ–±–æ–ª—å—à–∞—è –∫–æ–º–∞–Ω–¥–∞
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–π –±—é–¥–∂–µ—Ç –≤—Ä–µ–º–µ–Ω–∏/–¥–µ–Ω–µ–≥
- ‚úÖ –ù–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –∫ SLA 99.9%

---

## üìä –°—Ä–∞–≤–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ë–ï–ó –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ | –° –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º |
|----------|-----------------|----------------|
| **–û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –æ—à–∏–±–æ–∫** | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ–æ–±—â–∞—Ç | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ alerts |
| **–í—Ä–µ–º—è —Ä–µ–∞–∫—Ü–∏–∏** | –ß–∞—Å—ã/–¥–Ω–∏ | –ú–∏–Ω—É—Ç—ã |
| **–°—Ç–æ–∏–º–æ—Å—Ç—å** | $0 | $0-50/–º–µ—Å—è—Ü (Sentry free tier) |
| **–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è** | 0 —á–∞—Å–æ–≤ | 4-8 —á–∞—Å–æ–≤ |
| **–°–ª–æ–∂–Ω–æ—Å—Ç—å** | –ü—Ä–æ—Å—Ç–∞—è | –°—Ä–µ–¥–Ω—è—è |
| **Production ready** | ‚úÖ –î–∞ | ‚úÖ‚úÖ –î–∞ (–ª—É—á—à–µ) |

---

## ‚ö†Ô∏è –ß—Ç–æ —Ç–µ—Ä—è–µ—Ç–µ –ë–ï–ó –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### 1. **–ù–µ–∑–∞–º–µ—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏**
```
‚ùå –ë–ï–ó Sentry:
   - –û—à–∏–±–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç ‚Üí –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –≤ logs/bot.log
   - –í—ã –Ω–µ –∑–Ω–∞–µ—Ç–µ –æ –Ω–µ–π, –ø–æ–∫–∞ –Ω–µ –ø—Ä–æ–≤–µ—Ä–∏—Ç–µ –ª–æ–≥–∏ –≤—Ä—É—á–Ω—É—é
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –º–æ–ª—á–∞ —É–π—Ç–∏

‚úÖ –° Sentry:
   - –û—à–∏–±–∫–∞ ‚Üí –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π alert –Ω–∞ email/Telegram
   - –í–∏–¥–Ω–æ: stack trace, –∫–æ–Ω—Ç–µ–∫—Å—Ç, —á–∞—Å—Ç–æ—Ç–∞
   - –ú–æ–∂–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å –î–û –º–∞—Å—Å–æ–≤—ã—Ö –∂–∞–ª–æ–±
```

### 2. **–ü—Ä–æ–±–ª–µ–º—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
```
‚ùå –ë–ï–ó Prometheus:
   - –ë–æ—Ç —Ç–æ—Ä–º–æ–∑–∏—Ç ‚Üí –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∂–∞–ª—É—é—Ç—Å—è
   - –ù–µ–ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –∏–º–µ–Ω–Ω–æ –º–µ–¥–ª–µ–Ω–Ω–æ–µ
   - –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

‚úÖ –° Prometheus + Grafana:
   - –ì—Ä–∞—Ñ–∏–∫–∏: –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞, –Ω–∞–≥—Ä—É–∑–∫–∞, –ø–∞–º—è—Ç—å
   - –í–∏–¥–Ω–æ —Ç—Ä–µ–Ω–¥—ã (—Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–µ–µ?)
   - –ú–æ–∂–Ω–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã
```

### 3. **–ü—Ä–æ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å vs –†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**
```
‚ùå –ë–ï–ó –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: "–ë–æ—Ç –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç!"
   - –í—ã: "–°–µ–π—á–∞—Å –ø—Ä–æ–≤–µ—Ä—é –ª–æ–≥–∏..."
   - 30 –º–∏–Ω—É—Ç –Ω–∞ –ø–æ–∏—Å–∫ –ø—Ä–æ–±–ª–µ–º—ã

‚úÖ –° –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–æ–º:
   - Alert: "High error rate in /start handler"
   - –í—ã —É–∂–µ –∑–Ω–∞–µ—Ç–µ, —á—Ç–æ –∏ –≥–¥–µ —Å–ª–æ–º–∞–ª–æ—Å—å
   - 5 –º–∏–Ω—É—Ç –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```

---

## ‚úÖ –ß—Ç–æ –£–ñ–ï —Ä–∞–±–æ—Ç–∞–µ—Ç –ë–ï–ó –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å:

1. **‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ —Ñ–∞–π–ª**
   - `logs/bot.log` - –≤—Å–µ —Å–æ–±—ã—Ç–∏—è –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è
   - –ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å
   - `tail -f logs/bot.log` –¥–ª—è real-time

2. **‚úÖ Error handler**
   - –ì–ª–æ–±–∞–ª—å–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—à–∏–±–æ–∫
   - –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç –≤ –ª–æ–≥–∏
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø–æ–Ω—è—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ

3. **‚úÖ –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤**
   - –°—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ –Ω–µ –ø–µ—Ä–µ–ø–æ–ª–Ω—è—Ç –¥–∏—Å–∫
   - Docker: max 10MB x 3 —Ñ–∞–π–ª–∞

4. **‚úÖ Retry –º–µ—Ö–∞–Ω–∏–∑–º**
   - –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Å–±–æ–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - Exponential backoff

**–ò–¢–û–ì–û:** –î–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞ —ç—Ç–æ–≥–æ **–î–û–°–¢–ê–¢–û–ß–ù–û**!

---

## üéØ –ö–æ–≥–¥–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ù–ï–û–ë–•–û–î–ò–ú

### –í–Ω–µ–¥—Ä—è–π—Ç–µ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥, –µ—Å–ª–∏:

1. **‚ùó –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π –ø—Ä–æ–µ–∫—Ç**
   - SLA —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è (99.9% uptime)
   - –®—Ç—Ä–∞—Ñ—ã –∑–∞ downtime
   - –ú–Ω–æ–≥–æ –ø–ª–∞—Ç–Ω—ã—Ö –∫–ª–∏–µ–Ω—Ç–æ–≤

2. **‚ùó –í—ã—Å–æ–∫–∞—è –Ω–∞–≥—Ä—É–∑–∫–∞**
   - > 1000 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å
   - > 100 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - –ü–∏–∫–æ–≤—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏

3. **‚ùó –ë–æ–ª—å—à–∞—è –∫–æ–º–∞–Ω–¥–∞**
   - –ù–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
   - DevOps –∏–Ω–∂–µ–Ω–µ—Ä
   - –ù—É–∂–Ω–∞ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è

4. **‚ùó –ö—Ä–∏—Ç–∏—á–Ω—ã–π —Å–µ—Ä–≤–∏—Å**
   - –ù–µ–ª—å–∑—è —É–ø—É—Å—Ç–∏—Ç—å –æ—à–∏–±–∫–∏
   - –†–µ–ø—É—Ç–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏
   - –§–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

5. **‚ùó –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è —Ä–µ–≥—É–ª—è—Ç–æ—Ä–æ–≤**
   - ISO 27001 compliance
   - Audit trail
   - –î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–æ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

---

## üí° –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç (–µ—Å–ª–∏ –æ—á–µ–Ω—å —Ö–æ—á–µ—Ç—Å—è)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –¢–æ–ª—å–∫–æ Sentry (1 —á–∞—Å —Ä–∞–±–æ—Ç—ã)

**–ë–µ—Å–ø–ª–∞—Ç–Ω–æ:** 5000 —Å–æ–±—ã—Ç–∏–π/–º–µ—Å—è—Ü –Ω–∞ free tier

```python
# bot.py - –¥–æ–±–∞–≤–∏—Ç—å 3 —Å—Ç—Ä–æ–∫–∏
import sentry_sdk

sentry_sdk.init(
    dsn="https://...@sentry.io/...",  # –ë–µ—Å–ø–ª–∞—Ç–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç
    traces_sample_rate=0.1,  # 10% —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
)

# –í—Å—ë! –¢–µ–ø–µ—Ä—å –≤—Å–µ –æ—à–∏–±–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ Sentry
```

**–ü–ª—é—Å—ã:**
- ‚úÖ Alerts –Ω–∞ email –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ Stack traces —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –æ—à–∏–±–æ–∫
- ‚úÖ 1 —á–∞—Å –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- ‚ùå –ù–µ—Ç –≥—Ä–∞—Ñ–∏–∫–æ–≤ –Ω–∞–≥—Ä—É–∑–∫–∏

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: Telegram alerts (30 –º–∏–Ω—É—Ç)

**–°–æ–≤—Å–µ–º –±–µ—Å–ø–ª–∞—Ç–Ω–æ, —Å–≤–æ–π –±–æ—Ç**

```python
# app/utils/alerts.py
async def send_alert(message: str):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å alert –≤ Telegram"""
    await bot.send_message(
        chat_id=ADMIN_ID,
        text=f"üö® ALERT:\n{message}"
    )

# –í error handler
async def global_error_handler(update, exception):
    logger.error(f"Error: {exception}")
    await send_alert(f"Error in bot: {exception}")
```

**–ü–ª—é—Å—ã:**
- ‚úÖ –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- ‚úÖ –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚úÖ 30 –º–∏–Ω—É—Ç –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫—É

**–ú–∏–Ω—É—Å—ã:**
- ‚ùå –ù–µ—Ç stack traces
- ‚ùå –ù–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏
- ‚ùå –ú–æ–∂–µ—Ç —Å–ø–∞–º–∏—Ç—å

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞–º

### –¢–µ–∫—É—â–∏–π —ç—Ç–∞–ø (–ø—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç):

```
–ü–†–ò–û–†–ò–¢–ï–¢ 1 (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
‚úÖ P1-5 –ó–∞—â–∏—Ç–∞ PII - –°–î–ï–õ–ê–ù–û
‚ö†Ô∏è P0-1 Docker secrets –¥–ª—è BOT_TOKEN - –µ—Å–ª–∏ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∫–æ–¥

–ü–†–ò–û–†–ò–¢–ï–¢ 2 (–∂–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
- –ë–∞–∑–æ–≤—ã–π Telegram alert –ø—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö (30 –º–∏–Ω—É—Ç)
- –ò–ª–∏ Sentry free tier (1 —á–∞—Å)

–ü–†–ò–û–†–ò–¢–ï–¢ 3 (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):
- –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Prometheus + Grafana (8 —á–∞—Å–æ–≤)
- CI/CD pipeline
- –ê–≤—Ç–æ—Ç–µ—Å—Ç—ã > 80%

–ü–†–ò–û–†–ò–¢–ï–¢ 4 (–µ—Å–ª–∏ –±—É–¥–µ—Ç –≤—Ä–µ–º—è):
- PostgreSQL –≤–º–µ—Å—Ç–æ SQLite
- –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
```

---

## üéØ –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –≤–∞—à–µ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —Å–µ—Ä–≤–∏—Å (1-3 –º–∞—Å—Ç–µ—Ä–∞)
```
‚úÖ –î–û–°–¢–ê–¢–û–ß–ù–û:
   - –¢–µ–∫—É—â–∏–µ –ª–æ–≥–∏ –≤ —Ñ–∞–π–ª
   - –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤
   - –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ 1 —Ä–∞–∑/–¥–µ–Ω—å

‚ùå –ù–ï –ù–£–ñ–ù–û:
   - Prometheus/Grafana
   - –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π Sentry

üí° –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û:
   - –ü—Ä–æ—Å—Ç–æ–π Telegram alert (30 –º–∏–Ω—É—Ç)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ú–∞–ª—ã–π –±–∏–∑–Ω–µ—Å (5-10 –º–∞—Å—Ç–µ—Ä–æ–≤, 20-50 –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)
```
‚úÖ –†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø:
   - Sentry free tier (1 —á–∞—Å)
   - Email alerts

‚ö†Ô∏è –û–ü–¶–ò–û–ù–ê–õ–¨–ù–û:
   - Prometheus (–µ—Å–ª–∏ –µ—Å—Ç—å DevOps)

‚ùå –ù–ï –ö–†–ò–¢–ò–ß–ù–û:
   - Grafana dashboards
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –ö–æ–º–º–µ—Ä—á–µ—Å–∫–∏–π (20+ –º–∞—Å—Ç–µ—Ä–æ–≤, 100+ –∑–∞—è–≤–æ–∫/–¥–µ–Ω—å)
```
‚úÖ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û:
   - Sentry (–ø–ª–∞—Ç–Ω—ã–π –ø–ª–∞–Ω $26/–º–µ—Å—è—Ü)
   - Prometheus + Grafana
   - Uptime monitoring (UptimeRobot)

‚úÖ –ñ–ï–õ–ê–¢–ï–õ–¨–ù–û:
   - PagerDuty –¥–ª—è on-call
   - Status page –¥–ª—è –∫–ª–∏–µ–Ω—Ç–æ–≤
```

---

## üí∞ –°—Ç–æ–∏–º–æ—Å—Ç—å/–í—ã–≥–æ–¥–∞

| –†–µ—à–µ–Ω–∏–µ | –í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è | –°—Ç–æ–∏–º–æ—Å—Ç—å | –í—ã–≥–æ–¥–∞ |
|---------|----------------|-----------|--------|
| **–ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞—Ç—å** | 0 —á–∞—Å–æ–≤ | $0 | –†–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –µ—Å—Ç—å |
| **Telegram alerts** | 30 –º–∏–Ω—É—Ç | $0 | –ë–∞–∑–æ–≤—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è |
| **Sentry free** | 1 —á–∞—Å | $0 | –û—Ç–ª–æ–≤ –æ—à–∏–±–æ–∫ |
| **Sentry paid** | 1 —á–∞—Å | $26/–º–µ—Å | + –±–æ–ª—å—à–µ —Å–æ–±—ã—Ç–∏–π |
| **Prometheus + Grafana** | 8 —á–∞—Å–æ–≤ | $0 (self-hosted) | –ü–æ–ª–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ |
| **Full stack** | 16 —á–∞—Å–æ–≤ | $50-100/–º–µ—Å | Enterprise-—É—Ä–æ–≤–µ–Ω—å |

---

## ‚úÖ –ò—Ç–æ–≥–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### –î–õ–Ø –í–ê–®–ï–ì–û –°–õ–£–ß–ê–Ø:

**–†–ï–ö–û–ú–ï–ù–î–£–Æ:**

1. **‚úÖ –°–ï–ô–ß–ê–° (10 –º–∏–Ω—É—Ç):** –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å—Ç–æ–π Telegram alert
   ```python
   # –ü—Ä–∏ –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ—à–∏–±–∫–∞—Ö –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≤–∞–º –≤ Telegram
   ```

2. **‚è∞ –ß–ï–†–ï–ó 1-2 –ù–ï–î–ï–õ–ò (1 —á–∞—Å):** Sentry free tier
   ```
   - –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –∞–∫—Ç–∏–≤–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
   - –ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ –≤–∏–¥–µ—Ç—å –≤—Å–µ –æ—à–∏–±–∫–∏
   ```

3. **‚è∞ –ß–ï–†–ï–ó 1-2 –ú–ï–°–Ø–¶–ê (8 —á–∞—Å–æ–≤):** Prometheus + Grafana
   ```
   - –ï—Å–ª–∏ –Ω–∞–≥—Ä—É–∑–∫–∞ –≤—ã—Ä–æ—Å–ª–∞
   - –ï—Å–ª–∏ –Ω—É–∂–Ω—ã –≥—Ä–∞—Ñ–∏–∫–∏
   - –ï—Å–ª–∏ –µ—Å—Ç—å –≤—Ä–µ–º—è
   ```

**–ù–ï –†–ï–ö–û–ú–ï–ù–î–£–Æ –°–ï–ô–ß–ê–°:**
- ‚ùå –¢—Ä–∞—Ç–∏—Ç—å 8 —á–∞—Å–æ–≤ –Ω–∞ Prometheus - **—Ä–∞–Ω–æ**
- ‚ùå –ü–ª–∞—Ç–Ω—ã–π Sentry - **–Ω–µ –Ω—É–∂–Ω–æ –ø–æ–∫–∞**
- ‚ùå –°–ª–æ–∂–Ω—ã–µ dashboards - **overkill**

---

## üéì –í—ã–≤–æ–¥

### –ù–∞ –¥–∞–Ω–Ω–æ–º —ç—Ç–∞–ø–µ:

‚úÖ **–ü—Ä–æ–µ–∫—Ç –ì–û–¢–û–í –∫ —Ä–∞–±–æ—Ç–µ –ë–ï–ó –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞**
‚úÖ **–õ–æ–≥–∏ –≤ —Ñ–∞–π–ª –î–û–°–¢–ê–¢–û–ß–ù–û –¥–ª—è MVP**
‚úÖ **–ú–æ–∂–µ—Ç–µ —Å–ø–æ–∫–æ–π–Ω–æ –æ—Ç–ª–æ–∂–∏—Ç—å P1-6**

### –ù–æ –µ—Å–ª–∏ –µ—Å—Ç—å 30 –º–∏–Ω—É—Ç:
üí° **–î–æ–±–∞–≤—å—Ç–µ Telegram alerts** - —ç—Ç–æ —Ä–µ–∞–ª—å–Ω–æ –ø–æ–ª–µ–∑–Ω–æ –∏ –±—ã—Å—Ç—Ä–æ

### –ï—Å–ª–∏ –ø—Ä–æ–µ–∫—Ç –≤—ã—Ä–∞—Å—Ç–µ—Ç:
üìà **–í–µ—Ä–Ω–∏—Ç–µ—Å—å –∫ Sentry/Prometheus** —á–µ—Ä–µ–∑ 1-2 –º–µ—Å—è—Ü–∞

---

## üìù –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è Telegram alerts (–µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ)

```python
# app/utils/telegram_alerts.py
from app.config import Config

async def send_critical_alert(bot, message: str):
    """–û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫—Ä–∏—Ç–∏—á–Ω—ã–π alert –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É"""
    try:
        for admin_id in Config.get_admin_ids():
            await bot.send_message(
                chat_id=admin_id,
                text=f"üö® CRITICAL ALERT\n\n{message}"
            )
    except Exception as e:
        logger.error(f"Failed to send alert: {e}")

# –í app/middlewares/error_handler.py
async def global_error_handler(update, exception):
    logger.error(f"Unhandled error: {exception}", exc_info=True)
    
    # –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ - alert
    if isinstance(exception, (DatabaseError, CriticalError)):
        await send_critical_alert(
            bot,
            f"Error: {type(exception).__name__}\n{str(exception)[:200]}"
        )
```

---

**–ò–¢–û–ì–û:** –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - —ç—Ç–æ **P1** (–≤–∞–∂–Ω–æ), –Ω–æ **–ù–ï P0** (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ).  
–ü—Ä–æ–µ–∫—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –Ω–µ–≥–æ. –ú–æ–∂–µ—Ç–µ –æ—Ç–ª–æ–∂–∏—Ç—å –¥–æ —Ä–æ—Å—Ç–∞ –Ω–∞–≥—Ä—É–∑–∫–∏.

‚úÖ **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ—Å—Ç–æ–π Telegram alert (30 –º–∏–Ω—É—Ç), –æ—Å—Ç–∞–ª—å–Ω–æ–µ - –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏.

