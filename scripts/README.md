# üìú –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –ø–æ–ª–µ–∑–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–æ—Ç–æ–º.

---

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### update_bot.sh
**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ**

```bash
bash scripts/update_bot.sh
```

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –°–æ–∑–¥–∞—ë—Ç backup –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–∑ Git
- –ü–µ—Ä–µ—Å–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑
- –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –±–æ—Ç–∞
- –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ª–æ–≥–∏ –∏ —Å—Ç–∞—Ç—É—Å

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –∫–æ–¥
- –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –î–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

---

### diagnose_update.sh
**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º**

```bash
bash scripts/diagnose_update.sh
```

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:**
- –°–æ—Å—Ç–æ—è–Ω–∏–µ Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- Docker –æ–±—Ä–∞–∑—ã –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é .env
- –õ–æ–≥–∏ –Ω–∞ –æ—à–∏–±–∫–∏
- Redis –∏ –ë–î
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤
- Systemd —Å–µ—Ä–≤–∏—Å

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ë–æ—Ç –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è
- –ü–æ—è–≤–∏–ª–∏—Å—å –Ω–µ–ø–æ–Ω—è—Ç–Ω—ã–µ –æ—à–∏–±–∫–∏
- –ù—É–∂–Ω–æ –ø–æ–Ω—è—Ç—å —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### backup_db.py
**–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

```bash
python scripts/backup_db.py
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `backups/`
- –ò–º—è —Ñ–∞–π–ª–∞ —Å timestamp
- –°–∂–∞—Ç–∏–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (SQLite —É–∂–µ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–µ–Ω)

**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:**
```bash
# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup –≤ 2:00
crontab -e
# –î–æ–±–∞–≤—å—Ç–µ:
0 2 * * * cd ~/telegram_repair_bot && python scripts/backup_db.py
```

---

### export_db.py
**–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –≤ JSON**

```bash
python scripts/export_db.py
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞ –¥—Ä—É–≥–æ–π —Å–µ—Ä–≤–µ—Ä
- –°–æ–∑–¥–∞–Ω–∏–µ —á–∏—Ç–∞–µ–º–æ–≥–æ –¥–∞–º–ø–∞
- –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö

---

### import_db.py
**–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –∏–∑ JSON**

```bash
python scripts/import_db.py db_export_20251015.json
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `INSERT OR REPLACE` (–æ–±–Ω–æ–≤–ª—è–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∑–∞–ø–∏—Å–∏)
- –°–æ–∑–¥–∞—ë—Ç backup –ø–µ—Ä–µ–¥ –∏–º–ø–æ—Ä—Ç–æ–º (—Ñ–ª–∞–≥ `--backup`)

---

### check_database.py
**–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**

```bash
python scripts/check_database.py
```

**–ß—Ç–æ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –°–ø–∏—Å–æ–∫ —Ç–∞–±–ª–∏—Ü
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π
- –°—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü
- –ü—Ä–æ–±–ª–µ–º—ã (–µ—Å–ª–∏ –µ—Å—Ç—å)

---

## üöÄ –î–µ–ø–ª–æ–π

### deploy_to_vps.sh
**–î–µ–ø–ª–æ–π –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ VPS —Å–µ—Ä–≤–µ—Ä**

```bash
bash scripts/deploy_to_vps.sh 192.168.1.100 root
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `IP` - IP –∞–¥—Ä–µ—Å —Å–µ—Ä–≤–µ—Ä–∞
- `user` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH (–æ–±—ã—á–Ω–æ root)

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
- –°–æ–∑–¥–∞—ë—Ç backup
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã (rsync)
- –ü–µ—Ä–µ–¥–∞—ë—Ç .env –∏ –ë–î
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

---

### deploy_prod.sh
**Production –¥–µ–ø–ª–æ–π (–ª–æ–∫–∞–ª—å–Ω–æ)**

```bash
bash scripts/deploy_prod.sh
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
- –ù–∞ —Å–∞–º–æ–º —Å–µ—Ä–≤–µ—Ä–µ (–Ω–µ –ª–æ–∫–∞–ª—å–Ω–æ)
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –°–æ–±–∏—Ä–∞–µ—Ç –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã

---

### setup_vps.sh
**–ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ VPS**

```bash
bash scripts/setup_vps.sh
```

**–ß—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç:**
- Docker –∏ Docker Compose
- Git
- –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —É—Ç–∏–ª–∏—Ç—ã
- –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ –Ω–æ–≤–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- –ü–æ—Å–ª–µ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∏ –û–°

---

## üìä –û—Ç—á—ë—Ç—ã

### orders_report.py
**–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –∑–∞–∫–∞–∑–∞–º**

```bash
python scripts/orders_report.py --period daily
python scripts/orders_report.py --period weekly
python scripts/orders_report.py --period monthly
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `--period` - –ø–µ—Ä–∏–æ–¥ –æ—Ç—á—ë—Ç–∞ (daily/weekly/monthly)
- `--format` - —Ñ–æ—Ä–º–∞—Ç (txt/xlsx)
- `--output` - –ø—É—Ç—å –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è

---

### view_order_reports.py
**–ü—Ä–æ—Å–º–æ—Ç—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –æ—Ç—á—ë—Ç–æ–≤**

```bash
python scripts/view_order_reports.py
```

**–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç:**
- –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –æ—Ç—á—ë—Ç–æ–≤
- –ö—Ä–∞—Ç–∫—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
- –î–æ—Å—Ç—É–ø–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã

---

## üîß –£—Ç–∏–ª–∏—Ç—ã

### sync_roles_from_env.py
**–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ä–æ–ª–µ–π –∏–∑ .env –≤ –ë–î**

```bash
python scripts/sync_roles_from_env.py
```

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è ADMIN_IDS/DISPATCHER_IDS –≤ .env
- –î–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ —Ä–æ–ª–µ–π
- –ü—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üìù –ú–∏–≥—Ä–∞—Ü–∏–∏

### migrate.sh
**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π Alembic**

```bash
bash scripts/migrate.sh
```

**–ö–æ–º–∞–Ω–¥—ã:**
- `migrate.sh upgrade` - –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- `migrate.sh downgrade` - –û—Ç–∫–∞—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
- `migrate.sh history` - –ò—Å—Ç–æ—Ä–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
- `migrate.sh current` - –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è

---

## üîê –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞

–í—Å–µ `.sh` —Å–∫—Ä–∏–ø—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏:

```bash
# –°–¥–µ–ª–∞—Ç—å –≤—Å–µ —Å–∫—Ä–∏–ø—Ç—ã –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º–∏
chmod +x scripts/*.sh

# –ò–ª–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω–æ—Å—Ç–∏
chmod +x scripts/update_bot.sh
chmod +x scripts/diagnose_update.sh
```

---

## üêç Python —Å–∫—Ä–∏–ø—Ç—ã

Python —Å–∫—Ä–∏–ø—Ç—ã –ù–ï —Ç—Ä–µ–±—É—é—Ç `chmod +x`, –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è —á–µ—Ä–µ–∑:

```bash
python scripts/script_name.py
```

–ò–ª–∏ –≤ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ:

```bash
docker compose -f docker/docker-compose.prod.yml exec bot python scripts/script_name.py
```

---

## üìã –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ production

### –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞—á–∏

```bash
# –£—Ç—Ä–µ–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞
bash scripts/diagnose_update.sh

# Backup –ë–î
docker compose -f docker/docker-compose.prod.yml exec bot python scripts/backup_db.py

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ë–î
docker compose -f docker/docker-compose.prod.yml exec bot python scripts/check_database.py
```

### –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

```bash
# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
bash scripts/update_bot.sh

# –ò–ª–∏ –≤—Ä—É—á–Ω—É—é
git pull origin main
docker compose -f docker/docker-compose.prod.yml build --no-cache
docker compose -f docker/docker-compose.prod.yml up -d
```

### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

```bash
# –°–æ–∑–¥–∞–π—Ç–µ cron –∑–∞–¥–∞—á–∏
crontab -e

# –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π backup –≤ 2:00
0 2 * * * cd ~/telegram_repair_bot && docker compose -f docker/docker-compose.prod.yml exec -T bot python scripts/backup_db.py

# –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –æ—Ç—á—ë—Ç –≤ –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫ 9:00
0 9 * * 1 cd ~/telegram_repair_bot && docker compose -f docker/docker-compose.prod.yml exec -T bot python scripts/orders_report.py --period weekly

# –ï–∂–µ–º–µ—Å—è—á–Ω—ã–π –æ—Ç—á—ë—Ç 1-–≥–æ —á–∏—Å–ª–∞ –≤ 10:00
0 10 1 * * cd ~/telegram_repair_bot && docker compose -f docker/docker-compose.prod.yml exec -T bot python scripts/orders_report.py --period monthly
```

---

## üÜò Troubleshooting

### –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞
ls -la scripts/*.sh

# –°–¥–µ–ª–∞–π—Ç–µ –∏—Å–ø–æ–ª–Ω—è–µ–º—ã–º
chmod +x scripts/your_script.sh

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è —Å—Ç—Ä–æ–∫ (Windows vs Linux)
dos2unix scripts/your_script.sh  # –ï—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω dos2unix
```

### Python –º–æ–¥—É–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
# –í Docker:
docker compose -f docker/docker-compose.prod.yml exec bot python scripts/your_script.py

# –õ–æ–∫–∞–ª—å–Ω–æ (–≤ venv):
source venv/bin/activate
python scripts/your_script.py
```

### Permission denied –¥–ª—è –ë–î

```bash
# –ò—Å–ø—Ä–∞–≤—å—Ç–µ –ø—Ä–∞–≤–∞
chmod 644 data/bot_database.db
chown $USER:$USER data/bot_database.db
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—é](../docs/troubleshooting/BOT_UPDATE_ISSUES.md)
- [Troubleshooting](../docs/troubleshooting/)
- [Deployment](../docs/deployment/)

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 15 –æ–∫—Ç—è–±—Ä—è 2025
**–í–µ—Ä—Å–∏—è:** 1.0
